# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2019-12-26 07:36
from __future__ import unicode_literals

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import juloserver.julo.models
from juloserver.julo.management.commands import load_workflow, update_status_lookups, load_status_change_reasons
from juloserver.julo.statuses import ApplicationStatusCodes


class Migration(migrations.Migration):

    def create_new_status_path_147(apps, schema_editor):
        opts = {'workflow_name': ('cash_loan',)}
        load_workflow.Command().handle(**opts)
        update_status_lookups.Command().handle()
        load_status_change_reasons.Command().handle()

        status_code = ApplicationStatusCodes.DIGISIGN_FACE_FAILED
        StatusLookup = apps.get_model("julo", "StatusLookup")
        status_147 = StatusLookup.objects.filter(status_code=status_code).first()
        if status_147:
            status_147.handler = "Status147Handler"
            status_147.save()

    dependencies = [
        ('julo', '0628_add_feature_face_recognition'),
    ]

    operations = [
        migrations.RunPython(create_new_status_path_147)
    ]
