{% extends "common/theme1/list/list_footable_theme1.html" %}
{% load template %}
{% load unit %}
{% load model %}

{% load static from staticfiles %}

{% block breadcrumb_title %}{% endblock %}
{% block breadcrumb_path %}
{% endblock %}
{% block custom_css %}
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Nunito" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    <link href="{% static 'default/css/helper.css' %}" rel="stylesheet" />
    <style type="text/css">
        .flex {
            display: flex;
            margin-bottom: 10px;
        }
        .flex-only {
            display: flex !important;
        }
        .color-sample {
            width:20px;
            height:20px;
            border:1px solid black;
            margin-right:5px;
        }
        .m-r-10 {
            margin-right: 10px;
        }
        .sticky-container {
            position: sticky;
            top: 0;
            background: white !important;
            border-bottom: 1px solid #C2C2C2;
            z-index: 1000;
            width: auto;
        }
        .canvas {
            display: flex;
            justify-content:center;
            align-items:center;
            width: 1000px;
            height: 400px;
            border: 2px solid #C2C2C2;
            margin: auto;
            background-color: #E6E7E8;

        }
        .widget-base {
            display: inline-block;
            width: 328px;
            height: 84px;
            color: #404040;
            transform: scale(2);
        }
        .widget-top {
            display: flex;
            width: 100%;
            height: 58%;
            background: #ffffff;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }
        .widget-bot {
            display: flex;
            width: 100%;
            height: 42%;
            background: #00ACF0;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
        }
        .widget-icon-content {
            margin-left: 8px;
            margin-top: auto;
            margin-bottom: auto;
        }
        .widget-total-tagihan {
            margin-top:8.5px;
            margin-left: 4px;
            font-family: 'Nunito';
            font-size: 10px;
            font-weight: 400;
            line-height: 15px;
        }
        .widget-total-tagihan-num {
            margin-left: 4px;
            font-family: 'Nunito';
            font-size: 10px;
            font-weight: 700;
            line-height: 17px;
        }
        .widget-separator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 8px;
        }
        .widget-jatuh-tempo {
            margin-top:8.5px;
            margin-left: 8px;
            font-family: 'Nunito';
            font-size: 10px;
            font-weight: 400;
            line-height: 15px;
        }
        .widget-jatuh-tempo-date {
            margin-left: 8px;
            font-family: 'Nunito';
            font-size: 10px;
            font-weight: 400;
            line-height: 15px;
        }
        .widget-jatuh-tempo-days-left {
            font-family: 'Nunito';
            font-size: 12px;
            font-weight: 700;
            line-height: 17px;
        }
        .widget-bayar-button {
            margin-right: 8px;
            margin-top: auto;
            margin-bottom: auto;
            margin-left: auto;
            background: #00ACF0;
            font-family: 'Nunito';
            font-size: 12px;
            font-weight: 700;
            line-height: 17px;
            height: 33px;
            width: 57px;
            color: #FFFFFF;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
        }
        .widget-icon-description {
            display: flex;
            margin-left: 12px;
            margin-top: 11.5px;
            margin-bottom: 11.5px;
        }
        .widget-description {
            margin-left: 8px;
            font-family: 'Nunito';
            font-size: 12px;
            font-weight: 400;
            line-height: 17px;
            margin-top: auto;
            margin-bottom: auto;
            color: #ffffff;
        }
        .highlight {
            cursor: pointer;
            filter: brightness(125%);
            box-shadow: 0 0 0 4px #808080;
        }
        .clickable-card-text-color {
            margin-top: auto;
            margin-bottom: auto;
        }

        .switch-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
        }

        .mb10 {
            margin-bottom: 10px;
        }

        .ml5 {
            margin-left: 5px;
        }

        .w100 {
            width: 100px;
        }

        .w60 {
            width: 60px;
        }

        .grid {
            display: grid;
        }

        textarea {
            resize: vertical;
        }

        .lb-result {
            font-size: larger;
        }

        .center {
            align-items: center;
        }

        .no-border {
            border-top: 0;
            border-right: 0;
            border-left: 0;
            -webkit-box-shadow: none;
            box-shadow: none;
            font-weight:bold;
            color: #67717F;
        }
        .dot-false {
          height: 15px;
          width: 15px;
          background-color: #bbb;
          border-radius: 50%;
          display: inline-block;
        }
        .dot-true {
          height: 15px;
          width: 15px;
          background-color: #5AD3A6;
          border-radius: 50%;
          display: inline-block;
        }
        .txt-align {
            padding: 10px;
        }
        .pb-5 {
            padding: 5px;
        }
        .txt-blue {
            color: blue;
        }
        .modal-body {
            height: 500px;
            overflow-y: auto;
        }
        .error-msg {
            border: 1px solid red;
        }
        .switch {
          position: relative;
          display: inline-block;
          width: 60px;
          height: 34px;
        }

        .switch input {
          opacity: 0;
          width: 0;
          height: 0;
        }

        .slider {
          position: absolute;
          cursor: pointer;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: #ccc;
          -webkit-transition: .4s;
          transition: .4s;
        }

        .slider:before {
          position: absolute;
          content: "";
          height: 26px;
          width: 26px;
          left: 4px;
          bottom: 4px;
          background-color: white;
          -webkit-transition: .4s;
          transition: .4s;
        }

        input:checked + .slider {
          background-color: #2196F3;
        }

        input:focus + .slider {
          box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
          -webkit-transform: translateX(26px);
          -ms-transform: translateX(26px);
          transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
          border-radius: 34px;
        }

        .slider.round:before {
          border-radius: 50%;
        }
        .container {
            width : 90% !important;
        }
        table {
            width: 100%;
        }
        .modal-preview {
            width:750px;
        }

        /* Toggle */
        .onoffswitch {
            position: relative; width: 90px;
            -webkit-user-select:none; -moz-user-select:none; -ms-user-select: none;
            display: inline-block;
        }
        .onoffswitch-checkbox {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }
        .onoffswitch-label {
            display: block; overflow: hidden; cursor: pointer;
            border: 2px solid #999999; border-radius: 20px;
        }
        .onoffswitch-inner {
            display: block; width: 200%; margin-left: -100%;
            transition: margin 0.3s ease-in 0s;
        }
        .onoffswitch-inner:before, .onoffswitch-inner:after {
            display: block; float: left; width: 50%; height: 30px; padding: 0; line-height: 30px;
            font-size: 14px; color: white; font-family: Trebuchet, Arial, sans-serif; font-weight: bold;
            box-sizing: border-box;
        }
        .onoffswitch-inner:before {
            content: "ON";
            padding-left: 10px;
            background-color: rgb(52, 193, 59); color: #FFFFFF;
        }
        .onoffswitch-inner:after {
            content: "OFF";
            padding-right: 10px;
            background-color: #EEEEEE; color: #999999;
            text-align: right;
        }
        .onoffswitch-switch {
            display: block; width: 20px; height: 20px; margin: 6px;
            background: #FFFFFF;
            position: absolute;
            right: 56px;
            border: 2px solid #999999; border-radius: 20px;
            transition: all 0.3s ease-in 0s;
        }
        .onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-inner {
            margin-left: 0;
        }
        .onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-switch {
            right: 0px;
        }


    .info_card_content_type_1{
        font-family:Montserrat;
        width:50%;
        padding-top:4%;
        float: right;
        font-size: medium;
    }
    .info_card_content_type_2{
        font-family:Montserrat;
        color:white;
        width:100%;
        padding-top:4%;
        padding-left:7%;
    }

    .info_card_content_type_3{
        font-family:Montserrat;
        color:white;
        width:100%;
        padding-top:1%;
        padding-left:20%;
    }
    .info_card_button_type_3{
        font-family:Montserrat;
        width:100%;
        margin-top:10%;
        margin-left:5%;
    }
    .info_card_type_3_l_button{
        height: 10vw;
        margin-top:10%;
        line-height: 55px;
        text-align: center;

    }
    .expiry_unit{
        max-width:146px;
    }

    .d-flex {
        display: flex;
    }
    .align-self-center {
        align-items: center;
    }
    .py-4 {
        padding:4px;
    }
    .px-24 {
        padding-left:24px;
        padding-right:24px;
    }
    .text {
        font-family: Nunito;
    }
    .text-bold {
        font-weight: bold;
    }
    .modal-body {
        height: 60vh !important;
    }
    #info-card-preview .modal-dialog {
        width: 750px !important;
    }
    .responsive-iframe {
        position: relative;
        padding-bottom: 56.25%;
        /*16:9*/
        height: 0;
        overflow: hidden;
    }
    .responsive-iframe iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }

    .iframe-card {
        box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        overflow: hidden;
        word-break: break-all;
    }
    .iframe-card #preview-type-9-title{
        font-style: normal;
        font-weight: 700;
        font-size: 18px;
        line-height: 22px;
        text-align: left;
        padding: 12px 16px;
    }
    </style>
{% endblock %}

{% block list_title %}
    <div class="hidden">
        <h3 class="box-title m-b-0 bold">Streamlined Communications</h3>
    </div>

{% endblock %}
{% block list_subtitle %}{% endblock %}


{% block content-list %}
    <div class="row d-flex" style="gap: 16px;">
        <div class="col-lg-6">
        <h3 class="mt-16 font-14 bold mb-8">Data Pengguna</h3>
        <hr class="mt-0" style="border: 1px solid #181818;">
        <div class="d-inline-block p-16 bg-neutrals-20 radius-8 mb-32 col-lg-12">
            <div class="flex mb-0" style="justify-content: space-between;">
                <div class="flex center mb-0">
                    <img src="{% static 'images/icons/user.svg' %}" class="pr-8">
                    <h3 class="font-14 bold mb-8 mr-32 pr-32 ">Data Pengguna</h3>
                </div>
                <a class="btn radius-8 bg-primary-base py-12 px-32 font-white d-flex" href="https://new-crm.julo.co.id/dashboard/communication/list/?csrftoken={{ csrf_token }}" target="_blank" style="width: 220px;font-weight: bold;align-items: center;justify-content: center;">Lihat <img src="{% static 'images/icons/ic-chevron-right.svg' %}" class="pl-8"></a>
            </div>
        </div>
        </div>
        <div class="col-lg-6">
        <h3 class="mt-16 font-14 bold mb-8">Daftar Campaign</h3>
        <hr class="mt-0" style="border: 1px solid #181818;">
        <div class="d-inline-block p-16 bg-neutrals-20 radius-8 mb-32 col-lg-12">
            <div class="flex mb-0" style="justify-content: space-between;">
                <div class="flex center mb-0">
                    <h3 class="font-14 bold mb-8 mr-32 pr-32 ">Daftar Campaign</h3>
                </div>
                <a class="btn radius-8 bg-primary-base py-12 px-32 font-white d-flex" href="https://new-crm.julo.co.id/dashboard/campaign/?csrftoken={{ csrf_token }}" target="_blank" style="width: 220px;font-weight: bold;align-items: center;justify-content: center;">Lihat <img src="{% static 'images/icons/ic-chevron-right.svg' %}" class="pl-8"></a>
            </div>
        </div>
        </div>
    </div>
    <h3 class="mt-16 font-14 bold mb-8">STANDAR KOMUNIKASI</h3>
    <hr class="mt-0" style="border: 1px solid #181818;">
    <form method="get" id="form-status">
        <input type="hidden" name="default_active_tab_filter" id="default_active_tab_filter" value="{{ default_active_tab }}">
        <div class="row">
            <div class="col-md-2">
                <div class="center flex">
                    <label class="w100">Status Code:</label>
                    <div style="width: 200px;">
                        <select class="form-control submit_trigger" id="status_code" name="application_status">
                            <option value="" {% if selected_status_code == None %}selected="selected"{% endif %}>Status Code
                            </option>
                            {% for status in statusCodes %}
                                <option value="{{ status.code }}" {% if selected_status_code == status.code %}
                                        selected="selected"{% endif %}>{{ status.code }} - {{ status.desc }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="center flex">
                    <label class="w100">DPD:</label>
                    <div style="width: 200px;">
                        <select class="form-control submit_trigger" id="status_dpd" name="status_dpd">
                            <option value="" {% if selected_dpd == None %}selected="selected"{% endif %}>Dpd
                            {% for dpd in dpdOption %}
                                <option value="{{ dpd }}" {% if selected_dpd == dpd %}
                                        selected="selected"{% endif %}>{{ dpd }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="center flex">
                    <label class="w60">DPD Range:</label>
                    <div style="width: 70px;">
                        <select class="form-control submit_trigger" id="status_dpd_lower" name="status_dpd_lower">
                            <option value="" {% if selected_dpd_lower == None %}selected="selected"{% endif %}>Dpd
                            {% for dpd_lower in dpdOptionLower %}
                                <option value="{{ dpd_lower }}" {% if selected_dpd_lower == dpd_lower %}
                                        selected="selected"{% endif %}>{{ dpd_lower }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="center" style="padding-left: 5px;">
                        <p> to </p>
                    </div>
                    <div style="width: 80px;padding-left: 5px;">
                        <select class="form-control submit_trigger" id="status_dpd_upper" name="status_dpd_upper" style="max-width:90%"
                                {% if until_paid %}disabled="true"{% endif %}>
                            <option value="" {% if selected_dpd_upper == None %}selected="selected"{% endif %}>Dpd
                            {% for dpd_upper in dpdOptionUpper %}
                                <option value="{{ dpd_upper }}" {% if selected_dpd_upper == dpd_upper %}
                                        selected="selected"{% endif %}>{{ dpd_upper }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div style="width: 100px;padding-left: 5px;">
                        <form method="get" >
                            <input class="submit_trigger" type="checkbox" id="until_paid" name="until_paid" {% if until_paid %} checked value="until_paid"{% endif %}>
                            <label for="until_paid"> Until Paid</label>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="center flex">
                    <label class="w100">PTP:</label>
                    <div style="width: 200px;">
                        <select class="form-control submit_trigger" id="status_ptp" name="status_ptp">
                            <option value="" {% if selected_ptp == None %}selected="selected"{% endif %}>Ptp</option>
                            {% for ptp in ptpOption %}
                                <option value="{{ ptp }}" {% if selected_ptp == ptp %}
                                        selected="selected"{% endif %}>{{ ptp }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-3" id="extra_condition_div">
                <div class="center flex">
                    <label class="w100">Extra Condition:</label>
                    <div style="width: 200px;">
                        <select class="form-control submit_trigger" id="extra_condition" name="extra_condition">
                            <option value="" {% if selected_extra_condition == None %}selected="selected"{% endif %}>Extra Condition
                            {% for extra_condition_value, extra_condition_text in extra_condition_option %}
                                <option value="{{ extra_condition_value }}" {% if selected_extra_condition == extra_condition_value %}
                                        selected="selected"{% endif %}>{{ extra_condition_text }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-3" id="email_pn_category_div">
                <div class="center flex">
                    <label class="w100">Category:</label>
                    <div style="width: 200px;">
                        <select class="form-control submit_trigger" id="selected_category" name="selected_category">
                        <option value="" {% if selected_category == None %}selected="selected"{% endif %}>Category
                        </option>
                        <option value="normal" {% if selected_category == 'normal' %}
                                selected="selected" {% endif %}>Normal
                        </option>
                        <option value="backup" {% if selected_category == 'backup' %}
                                selected="selected" {% endif %}>Backup
                        </option>
                    </select>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <div id="after_submit" {% if selected_status_code == None and selected_dpd == None and selected_ptp == None and selected_dpd_upper == None and selected_dpd_lower == None and selected_extra_condition == None %} style="display: none;"{% endif %}>
        <ul class="nav nav-tabs">
            <li class="{% if default_active_tab == 'info_card' %}active{% endif %} {% if selected_ptp == 'real-time' %}hide{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabInfoCard" tab="INFO_CARD">Info Card</a>
            </li>
            <li class="{% if default_active_tab == 'email' %}active{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabEmail" tab="EMAIL">Email</a>
            </li>
            <li class="{% if default_active_tab == 'sms' %}active{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabSMS" tab="SMS">SMS</a>
            </li>
            <li class="{% if selected_ptp == 'real-time' %}hide{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabIAN" tab="IAN">In Application Notif</a>
            </li>
            <li class="{% if default_active_tab == 'pn' %}active{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabPN" tab="PN">Push Notification</a>
            </li>
            <li class=" {% if selected_ptp == 'real-time' %}hide{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabWA" tab="WA">Whatsapp</a>
            </li>
            <li class="{% if default_active_tab == 'robocall' %}active{% endif %}  {% if selected_ptp == 'real-time' %}hide{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabRobocall" tab="ROBOCALL">Robocall</a>
            </li>
            <li class="{% if default_active_tab == 'parameterlist' %}active{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabParameterList" tab="parameterlist">Parameter List</a>
            </li>
            <li class="{% if default_active_tab == 'functionlist' %}active{% endif %}  {% if selected_ptp == 'real-time' %}hide{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabFunctionList" tab="functionlist">Function List</a>
            </li>
            <li class="{% if default_active_tab == 'widgetduedate' %}active{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabWidgetDueDate" tab="widgetduedate">Widget Due Date</a>
            </li>
            <li class="{% if default_active_tab == 'sliknotification' %}active{% endif %}">
                <a data-toggle="tab" class="btnTab" href="#tabSlikNotification" tab="sliknotification">Tagihan banner</a>
            </li>
        </ul>
        <div class="row">
            <div class="col-md-12 text-right" style="margin-top: 5px;">
                <input type="hidden" id="activeTab" value="{{ default_active_tab }}">
                <div class="btn-group" role="group" aria-label="Basic example">
                    <button type="button" class="btn btn-success" id="btnAdd" data-target="#add-edit-sms">Add</button>
                    <button type="button" class="btn btn-primary" id="btnSave">Save</button>
                </div>
            </div>
        </div>
        <div class="tab-content" style="margin-top: 20px;">
            <div id="tabInfoCard" class="tab-pane fade {% if default_active_tab == 'info_card' %} in active{% endif %}">
                <form method="post" id="info-card-order-form">
                <input type="hidden" name="updated_info_card_ids" id="updated_info_card_ids">
                {% for item in listInfoCard %}
                <div class="row" id="list-{{ item.id }}">
                    <div class="col-md-1">
                        <div class="form-group">
                            <label for="info-card-type-{{ item.id }}">For Customer</label>
                            <textarea class="form-control check-for-update" name="info-card-type-{{ item.id }}"
                                        id="infoCardType-{{ item.id }}"  system-id="{{ item.id }}" readonly>{{ item.customer_data }}</textarea>
                        </div>
                    </div>
                    <div class="col-md-1">
                        <div class="form-group">
                            <label for="info-card-type-{{ item.id }}">Type</label>
                            <textarea class="form-control check-for-update" name="info-card-type-{{ item.id }}"
                                        id="infoCardType-{{ item.id }}"  system-id="{{ item.id }}" readonly>{{ item.card_type }}</textarea>
                        </div>
                    </div>
                    <div class="col-md-1">
                        <div class="form-group">
                            <label for="info-card-title-{{ item.id }}">Title</label>
                            <textarea class="form-control check-for-update" name="info-card-title-{{ item.id }}"
                                        id="infoCardTitle-{{ item.id }}"  system-id="{{ item.id }}" readonly>{{ item.title }}</textarea>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="info-card-content-{{ item.id }}">Content</label>
                            <textarea class="form-control check-for-update" name="info-card-content-{{ item.id }}" style="overflow:scroll;"
                                        id="infoCardContent-{{ item.id }}"  system-id="{{ item.id }}" readonly>{{ item.content }}</textarea>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="info-card-parameter-{{ item.id }}">Expiration Option</label>
                            <textarea class="form-control check-for-update" name="info-card-expiration-{{ item.id }}"
                                    id="infoCardExpirationOption-{{ item.id }}" style="overflow:scroll;"
                                    system-id="{{ item.id }}" readonly>{{ item.expiration_option_data }}
                            </textarea>
                        </div>
                    </div>
                    <div class="col-md-1">
                        <div class="form-group">
                            <label for="info-card-template-code-{{ item.id }}">Template Code</label>
                            <textarea class="form-control check-for-update" name="info-card-template-code-{{ item.id }}"
                                        id="infoCardTemplateCode-{{ item.id }}"  system-id="{{ item.id }}" readonly>{{ item.template_code }}</textarea>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label for="info-card-buttons-{{ item.id }}">Buttons</label>
                            <textarea class="form-control check-for-update" name="info-card-buttons-{{ item.id }}"
                                    id="infoCardButtons-{{ item.id }}" style="overflow:scroll;"
                                    system-id="{{ item.id }}" readonly>{{ item.buttons}}</textarea>
                        </div>
                    </div>
                    <div class="col-md-1">
                        <button type="button" class="btn btn-success btnEditInfoCard" system-id="{{ item.id }}" style="margin-top: 20px">
                            <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                        </button>
                        <br>
                        <button type="button" class="btn btn-danger btnDeleteInfoCard" system-id="{{ item.id }}">
                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                        </button><br>
                        <button type="button" class="btn btn-primary btnPreviewInfoCard" system-id="{{ item.id }}">
                            <span class="glyphicon glyphicon-picture" aria-hidden="true"></span>
                        </button>
                    </div>
                    <div class="col-md-1">
                        <div class="onoffswitch">
                            <input type="checkbox" class="onoffswitch-checkbox info_card_is_active" name="is_active-{{ item.id }}" id="is_active-{{ item.id }}" tabindex="0"
                                   {% if item.is_active == True %}checked{% endif %} system-id="{{ item.id }}">
                            <label class="onoffswitch-label" for="is_active-{{ item.id }}" value="{{ item.is_active }}">
                                <span class="onoffswitch-inner"></span>
                                <span class="onoffswitch-switch"></span>
                            </label>
                        </div>
                        <label for="usr">Order</label>
                        <select class="form-control infoCardOrder" id="infoCardOrder-{{ item.id }}" name="infoCardOrder-{{ item.id }}" system_id="{{ item.id }}">
                            {% for i in max_order_info_card %}
                                <option value="{{ i }}" {% if item.card_order_number == i %} selected {% endif %}>{{ i }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                {% empty %}
                <div class="alert alert-info empty-info">
                    <strong>Info!</strong> Tidak ada Data.
                </div>
                {% endfor %}
                </form>
            </div>
            <div id="tabEmail" class="tab-pane fade
            {% if default_active_tab == 'email' %} in active{% endif %}">
                <form id="form-email" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="updated_message_id_email" id="updated_message_id_email">
                    <input type="hidden" name="new_message_id_email" id="new_message_id_email">
                    <input type="hidden" name="deleted_message_id_email" id="deleted_message_id_email">
                    <input type="hidden" name="delete_msg_id_email" id="delete_msg_id_email">
                    <input type="hidden" name="update_msg_id_automated_email" id="update_msg_id_automated_email">
                    {% for item in listEmail %}
                        <div style="border-bottom: 1px solid;">
                            <div class="row" id="lists-{{ item.id }}">
                                <div class="col-md-12">
                                    <div class="form-group" id="email_type-{{ item.id }}"
                                        em_product="{{ item.product }}"
                                        em_type="{{ item.type }}"
                                        em_category="{% if item.extra_conditions == 'unsent moengage' %}backup{% else %}normal{% endif %}">
                                        <label for="description" id="email_product-{{ item.id }}" class="txt-blue">
                                            {{ email_products|key_value:item.product }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Subject</label>
                                        <textarea class="form-control check-for-update" name="subject-{{ item.id }}"
                                                    id="email_subject-{{ item.id }}"
                                                    system-id="{{ item.id }}" readonly>{{ item.subject }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Pre Header</label>
                                        <textarea class="form-control check-for-update" name="pre_header-{{ item.id }}"
                                                    id="email_pre_header-{{ item.id }}"
                                                    system-id="{{ item.id }}" readonly>{{ item.pre_header }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Content</label>
                                        <button type="button" class="btn btn-success previewshow" id="btnPreview" system-id="{{ item.id }}" data-target="#content-preview">Preview</button>
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                    system-id="{{ item.id }}" style="overflow:scroll;"
                                                    id="email_message-{{ item.id }}" readonly>{{ item.message__message_content }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Called Parameter</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                id="email_parameter-{{ item.id }}"
                                                system-id="{{ item.id }}" readonly>{ {{ item.message__parameter|join:", " }} }</textarea>
                                    </div>
                                </div>

                                <div class="col-md-2" hidden>
                                    <div class="form-group">
                                        <label for="description">Partners Selection</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                id="selected_partners_email-{{ item.id }}"
                                                system-id="{{ item.id }}" readonly>{{ item.partner_selection_list|join:", " }}</textarea>
                                    </div>
                                </div>

                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Template Code</label>
                                        <textarea class="form-control check-for-update" name="template_code-{{ item.id }}"
                                                    id="email_template_code-{{ item.id }}"
                                                    system-id="{{ item.id }}" readonly>{{ item.template_code }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Moengage Code</label>
                                        <textarea class="form-control check-for-update" name="template_code-{{ item.id }}"
                                                  id="moengage_template_code-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  readonly>{{ item.moengage_template_code }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Time Sent</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                    id="email_time_sent-{{ item.id }}"
                                                    system-id="{{ item.id }}" readonly>{{ item.time_sent }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="description-{{ item.id }}"
                                                system-id="{{ item.id }}"
                                                id="email_description-{{ item.id }}" readonly>{{ item.description }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Julo Gold Status</label>
                                        <textarea class="form-control check-for-update" name="julo_gold_status-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="email_julo_gold_status-{{ item.id }}" readonly>{{ item.julo_gold_status }}</textarea>
                                    </div>
                                </div>
                                <div class="onoffswitch">
                                    {% if item.is_automated == True %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0" checked>
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="True">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% else %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0">
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="False">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% endif %}
                                </div>
                                <div class="col-md-1">
                                    <button type="button" class="btn btn-success btnEditEmail" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                    </button>
                                    <br>
                                    <button type="button" class="btn btn-danger btnDeleteMsg" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    {% empty %}
                        <div class="alert alert-info empty-info">
                            <strong>Info!</strong> Tidak ada Data.
                        </div>
                    {% endfor %}
                </form>
            </div>
            <div id="tabSMS" class="tab-pane fade
            {% if default_active_tab == 'sms' %} in active{% endif %}">
                <div class="container list-sms">
                    <form id="form-sms" method="post">
                        <input type="hidden" name="default_active_tab" value="{{ default_active_tab }}">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_sms" id="updated_message_id_sms">
                        <input type="hidden" name="new_message_id_sms" id="new_message_id_sms">
                        <input type="hidden" name="deleted_message_id_sms" id="deleted_message_id_sms">
                        <input type="hidden" name="delete_msg_id_sms" id="delete_msg_id_sms">
                        <input type="hidden" name="update_msg_id_automated_sms" id="update_msg_id_automated_sms">
                        {% for item in listSMS %}
                            <div class="row" id="lists-{{ item.id }}">
                                <div class="col-md-12">
                                    <div class="form-group" id="sms_type-{{ item.id }}"
                                         sm_product="{{ item.product }}"
                                         sm_type="{{ item.type }}">
                                        <label for="description" id="sms_product-{{ item.id }}" class="txt-blue">
                                            {{ sms_products|key_value:item.product }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Content</label>
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="sms_message-{{ item.id }}" readonly>{{ item.message__message_content }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                     <div class="form-group">
                                        <label for="description">Called Parameter</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  id="sms_parameter-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{ {{ item.message__parameter|join:", " }} }</textarea>
                                    </div>
                                </div>

                                <div class="col-md-2" hidden>
                                    <div class="form-group">
                                        <label for="description">Partners Selection</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                id="selected_partners_sms-{{ item.id }}"
                                                system-id="{{ item.id }}" readonly>{{ item.partner_selection_list|join:", " }}</textarea>
                                    </div>
                                </div>

                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Template Code</label>
                                        <textarea class="form-control check-for-update" name="template_code-{{ item.id }}"
                                                  id="sms_template_code-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{ item.template_code }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Time Sent</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  id="sms_time_sent-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{ item.time_sent }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="description-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="sms_description-{{ item.id }}" readonly>{{ item.description }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Julo Gold Status</label>
                                        <textarea class="form-control check-for-update" name="julo_gold_status-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="sms_julo_gold_status-{{ item.id }}" readonly>{{ item.julo_gold_status }}</textarea>
                                    </div>
                                </div>
                                <div class="onoffswitch">
                                    {% if item.is_automated == True %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0" checked>
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="True">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% else %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0">
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="False">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% endif %}
                                </div>
                                <div class="col-md-1">
                                    <br/>
                                    <button type="button" class="btn btn-success btnEditSMS" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                    </button>
                                    <button type="button" class="btn btn-danger btnDeleteMsg" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </button>

                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
            <div id="tabIAN" class="tab-pane fade">
                <div class="container">
                    <form id="form-ian" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_ian" id="updated_message_id_ian">
                        <input type="hidden" name="new_message_id_ian" id="new_message_id_ian">
                        <input type="hidden" name="deleted_message_id_ian" id="deleted_message_id_ian">
                        {% for item in listIAN %}
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <input type="text" class="form-control input-sm no-border check-for-update" name="status-{{ item.id }}"
                                               value="{{ item.status }}" placeholder="Status" system-id="{{ item.id }}">
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  placeholder="message"
                                                  system-id="{{ item.id }}">{{ item.message__message_content }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="description">Called Parameter</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  placeholder="parameter"
                                                  system-id="{{ item.id }}" readonly>{ {{ item.message__parameter|join:", " }} }</textarea>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="description-{{ item.id }}"
                                                  placeholder="description"
                                                  system-id="{{ item.id }}">{{ item.description }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Status</label><br/>
                                        {% if item.is_automated == True %}
                                        <span class="dot-true"></span> Active
                                        {% else %}
                                        <span class="dot-false"></span> Deactive
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <br/>
                                    <button type="button" class="btn btn-danger btnDelete" system-id="{{ item.id }}">-
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
            <div id="tabPN" class="tab-pane fade {% if default_active_tab == 'pn' %} in active{% endif %}">
                <div class="container list-pn">
                    <form id="form-pn" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_pn" id="updated_message_id_pn">
                        <input type="hidden" name="new_message_id_pn" id="new_message_id_pn">
                        <input type="hidden" name="deleted_message_id_pn" id="deleted_message_id_pn">
                        <input type="hidden" name="delete_msg_id_pn" id="delete_msg_id_pn">
                        <input type="hidden" name="update_msg_id_automated_pn" id="update_msg_id_automated_pn">
                        {% for item in listPN %}
                            <div class="row" id="lists-{{ item.id }}">
                                <div class="col-md-12">
                                    <div class="form-group" id="pn_type-{{ item.id }}"
                                         pn_product="{{ item.product }}"
                                         pn_type="{{ item.type }}"
                                         pn_category="{% if item.extra_conditions == 'unsent moengage' %}backup{% else %}normal{% endif %}">
                                        <label for="description" id="pn_product-{{ item.id }}" class="txt-blue">
                                            {{ pn_products|key_value:item.product|upper }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="heading">Title</label>
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  placeholder="None"
                                                  system-id="{{ item.id }}"
                                                  id="pn_subject-{{ item.id }}" readonly>{{ item.subject }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="heading">Heading</label>
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  placeholder="message"
                                                  system-id="{{ item.id }}"
                                                  id="pn_heading-{{ item.id }}" readonly>{{ item.heading_title }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="heading">Content</label>
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  placeholder="message"
                                                  system-id="{{ item.id }}"
                                                  id="pn_message-{{ item.id }}" readonly>{{ item.message__message_content }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Called Parameter</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  placeholder="parameter"
                                                  system-id="{{ item.id }}"
                                                  id="pn_parameter-{{ item.id }}" readonly>{ {{ item.message__parameter|join:", " }} }</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Template Code</label>
                                        <textarea class="form-control check-for-update" name="template_code-{{ item.id }}"
                                                  id="pn_template_code-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{ item.template_code }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Moengage Code</label>
                                        <textarea class="form-control check-for-update" name="template_code-{{ item.id }}"
                                                  id="moengage_template_code-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  readonly>{{ item.moengage_template_code }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Time Sent</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  id="pn_time_sent-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{ item.time_sent }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="description-{{ item.id }}"
                                                  placeholder="description"
                                                  system-id="{{ item.id }}"
                                                  id="pn_description-{{ item.id }}" readonly>{{ item.description }}</textarea>
                                    </div>
                                </div>
                                <div><input type="hidden" name="pn_image" id="pn_image-{{ item.id }}" value="{{item.id|get_pn_image_url}}"></div>
                                <div class="onoffswitch">
                                    {% if item.is_automated == True %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0" checked>
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="True">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% else %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0">
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="False">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% endif %}
                                </div>
                                <div class="col-md-1">
                                    <br/>
                                    <button type="button" class="btn btn-success btnEditPN" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                    </button>
                                    <button type="button" class="btn btn-danger btnDeleteMsg" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
            <div id="tabWA" class="tab-pane fade">
                <div class="container">
                    <form id="form-wa" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_wa" id="updated_message_id_wa">
                        <input type="hidden" name="new_message_id_wa" id="new_message_id_wa">
                        <input type="hidden" name="deleted_message_id_wa" id="deleted_message_id_wa">
                        {% for item in listWhatsapp %}
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <input type="text" class="form-control input-sm no-border check-for-update" name="status-{{ item.id }}"
                                               value="{{ item.status }}" placeholder="Status" system-id="{{ item.id }}">
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  placeholder="message" readonly
                                                  system-id="{{ item.id }}">{{ item.message__message_content }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="description">Called Parameter</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  placeholder="parameter"
                                                  system-id="{{ item.id }}" readonly>{ {{ item.message__parameter|join:", " }} }</textarea>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="description-{{ item.id }}"
                                                  placeholder="description" readonly
                                                  system-id="{{ item.id }}">{{ item.description }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Status</label><br/>
                                        {% if item.is_automated == True %}
                                        <span class="dot-true"></span> Active
                                        {% else %}
                                        <span class="dot-false"></span> Deactive
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <br/>
                                    <button type="button" class="btn btn-danger btnDelete" system-id="{{ item.id }}">-
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
             <div id="tabRobocall" class="tab-pane fade
            {% if default_active_tab == 'robocall' %} in active{% endif %}">
                <div class="container">
                    <form id="form-robocall" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_robocall" id="updated_message_id_robocall">
                        <input type="hidden" name="new_message_id_robocall" id="new_message_id_robocall">
                        <input type="hidden" name="deleted_message_id_robocall" id="deleted_message_id_robocall">
                        <input type="hidden" name="delete_msg_id_robocall" id="delete_msg_id_robocall">
                        <input type="hidden" name="update_msg_id_automated_robocall" id="update_msg_id_automated_robocall">
                        {% for item in listRobocall %}
                            <div class="row" id="lists-{{ item.id }}">
                                <div class="col-md-12">
                                    <div class="form-group" id="robocall_type-{{ item.id }}"
                                         rb_product="{{ item.product }}"
                                         rb_type="{{ item.type }}">
                                        <label for="description" id="robocall_product-{{ item.id }}" class="txt-blue">
                                            {{ robocall_products|key_value:item.product }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-2">
                                    <div class="form-group">
                                       <label for="description">Content</label>
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="robocall_message-{{ item.id }}" readonly>{{ item.message__message_content }}</textarea>
                                    </div>
                                </div>
                                 <div class="col-md-2">
                                     <div class="form-group">
                                        <label for="description">Called Parameter</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  id="robocall_parameter-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{ {{ item.message__parameter|join:", " }} }</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2" hidden>
                                    <div class="form-group">
                                        <label for="description">Partners Selection</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                id="selected_partners_robocall-{{ item.id }}"
                                                system-id="{{ item.id }}" readonly>{{ item.partner_selection_list|join:", " }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Function</label>
                                        <textarea class="form-control check-for-update"
                                                  name="robocall_function-{{ item.id }}"
                                                  id="robocall_function-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  fun_name="{{ item.function_name|join:',' }}"
                                                  readonly>{{ item.function_name|join:", " }}</textarea>

                                    </div>
                                </div>
                                 <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">TempCode</label>
                                        <textarea class="form-control check-for-update" name="template_code-{{ item.id }}"
                                                  id="robocall_template_code-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{ item.template_code }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Segment</label>
                                        {% if item.criteria == null %}
                                        <textarea class="form-control check-for-update" name="robocall_segment-{{ item.id }}"
                                                  id="robocall_segment-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly> None </textarea>
                                        {% else %}
                                        <textarea class="form-control check-for-update" name="robocall_segment-{{ item.id }}"
                                                  id="robocall_segment-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{item.criteria.segment}}</textarea>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Attempts</label>
                                        <textarea class="form-control check-for-update" name="robocall_attempts-{{ item.id }}"
                                                  id="robocall_attempts-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{ item.attempts }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Call Hour</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  id="robocall_call_hr-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  call_hrs="{{ item.call_hours|join:',' }}"
                                                  readonly>{{ item.call_hours|join:", " }}</textarea>

                                    </div>
                                </div>
                                <div class="col-md-1" style="display: none;">
                                    <div class="form-group">
                                        <label for="description">Time Out Duration</label>
                                        <textarea class="form-control check-for-update" name="robocall_time_out_duration-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="robocall_time_out_duration-{{ item.id }}" readonly>{{ item.time_out_duration }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="description-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="robocall_description-{{ item.id }}" readonly>{{ item.description }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">
                                        <label for="description">Julo Gold Status</label>
                                        <textarea class="form-control check-for-update" name="julo_gold_status-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="robocall_julo_gold_status-{{ item.id }}" readonly>{{ item.julo_gold_status }}</textarea>
                                    </div>
                                </div>
                                <div class="onoffswitch">
                                    {% if item.is_automated == True %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0" checked>
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="True">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% else %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0">
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="False">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% endif %}
                                </div>
                                <div class="col-md-7" style="display: none;">
                                    <div class="form-group">
                                        <label for="description">Exclude Risky Customer</label><br/>
                                        <label class="switch">
                                        {% if item.exclude_risky_customer == True %}
                                            <input type="checkbox"
                                                        checked id="robocall_exclude_risky-{{ item.id }}">
                                            {% else %}
                                                <input type="checkbox"
                                                       id="robocall_exclude_risky-{{ item.id }}">
                                            {% endif %}
                                          <span class="slider round"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <br/>
                                    <button type="button" class="btn btn-success btnEditRobocall" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                    </button>
                                    <button type="button" class="btn btn-danger btnDeleteMsg" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
            <div id="tabParameterList" class="tab-pane fade
            {% if default_active_tab == 'parameterlist' %} in active{% endif %}">
                <div class="container">
                    <form method="get" id="form-platform">
                        <input type="hidden" name="platform_id" id="platform_id">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="center flex">
                                    <label class="w100">Filter by Platform <span class="filter-icon"><i class="fa fa-filter"></i></span>
                                    </label>
                                    <div style="width: 200px;">
                                        <select class="form-control" id="platform" name="platform">
                                            <option value="" {% if selected_platform == None %}selected="selected"{% endif %}>Choose One
                                            </option>
                                            {% for key, value in communicationPlatforms %}
                                                {% if key == item.communication_platform %}
                                                    <option value="{{ key }}" selected>{{ value }}</option>
                                                {% else %}
                                                    <option value="{{ key }}">{{ value }}</option>
                                                {% endif %}
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <form id="form-parameterlist" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_parameterlist" id="updated_message_id_parameterlist">
                        <input type="hidden" name="new_message_id_parameterlist" id="new_message_id_parameterlist">
                        <input type="hidden" name="deleted_message_id_parameterlist" id="deleted_message_id_parameterlist">
                        <input type="hidden" name="delete_msg_id_parameterlist" id="delete_msg_id_parameterlist">
                        {% for item in listParameterAll %}
                            <div class="row platform_type_all platform_type_{{ item.platform }}" id="list-{{ item.id }}">
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Parameter</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                placeholder="message" rows="5"
                                                system-id="{{ item.id }}"
                                                id="parameterlist_parameter-{{ item.id }}" readonly>{{ item.parameter_name }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Platform</label>
                                        <textarea class="form-control check-for-update" name="platform-parameter-{{ item.id }}"
                                                placeholder="platform" rows="5"
                                                system-id="{{ item.id }}"
                                                id="parameterlist_platform-{{ item.id }}" readonly>{{ item.platform }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Example</label>
                                        <textarea class="form-control check-for-update" name="example-parameter-{{ item.id }}"
                                                placeholder="example" rows="5"
                                                system-id="{{ item.id }}"
                                                id="parameterlist_example-{{ item.id }}" readonly>{{ item.example }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="description-parameter-{{ item.id }}"
                                                placeholder="description" rows="5"
                                                system-id="{{ item.id }}"
                                                id="parameterlist_description-{{ item.id }}" readonly>{{ item.description }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <div class="form-group">

                                        <div class="form-group">
                                            <label for="Is PTP">Is PTP</label><br/>
                                            {% if item.is_ptp == True %}
                                            <span class="dot-true"></span> Yes
                                            {% else %}
                                            <span class="dot-false"></span> No
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <br/>
                                    <button type="button" class="btn btn-success btnEditParameterlist" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                    </button>
                                    <button type="button" class="btn btn-danger btnDeleteMsg" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
            <div id="tabFunctionList" class="tab-pane fade
            {% if default_active_tab == 'functionlist' %} in active{% endif %}">
                <div class="container">
                    <form id="form-functionlist" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_functionlist" id="updated_message_id_functionlist">
                        <input type="hidden" name="new_message_id_functionlist" id="new_message_id_functionlist">
                        <input type="hidden" name="deleted_message_id_functionlist" id="deleted_message_id_functionlist">
                        {% for item in listFunction %}
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="description">Function</label>
                                        <input type="text" class="form-control check-for-update" name="function-{{ item.id }}"
                                                  placeholder="message" maxlength="250"
                                                  system-id="{{ item.id }}" value="{{ item.function_name }}">
                                    </div>
                                </div>
                                 <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="description">Platform</label>
                                        <select class="form-control check-for-update" system-id="{{ item.id }}"
                                                name="platform-function-{{ item.id }}">
                                            <option value="" selected="selected">Choose One</option>
                                            {% for key, value in communicationPlatforms %}
                                                {% if key == item.communication_platform %}
                                                    <option value="{{ key }}" selected>{{ value }}</option>
                                                {% else %}
                                                    <option value="{{ key }}">{{ value }}</option>
                                                {% endif %}
                                            {% endfor %}
                                         </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="description-function-{{ item.id }}"
                                                  placeholder="description"
                                                  system-id="{{ item.id }}">{{ item.description }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <br/>
                                    <button type="button" class="btn btn-danger btnDelete" system-id="{{ item.id }}">-
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
            <div id="tabWidgetDueDate" class="tab-pane fade
            {% if default_active_tab == 'widgetduedate' %} in active{% endif %}">
                <div class="container">
                    <form id="form-widgetduedate" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_widgetduedate" id="updated_message_id_widgetduedate">
                        <input type="hidden" name="new_message_id_widgetduedate" id="new_message_id_widgetduedate">
                        <input type="hidden" name="deleted_message_id_widgetduedate" id="deleted_message_id_widgetduedate">
                        <input type="hidden" name="delete_msg_id_widgetduedate" id="delete_msg_id_widgetduedate">
                        <input type="hidden" name="update_msg_id_automated_widgetduedate" id="update_msg_id_automated_widgetduedate">

                        {% for item in listPaymentWidget %}
                        <input type="hidden" name="widget-type" id="widget-type-{{ item.id }}" value="{{ item.payment_widget_properties.type }}">
                        <input type="hidden" name="widget-icon-content-img-url" id="widget-icon-content-img-url-{{ item.id }}" value="{{ item.payment_widget_properties.info_imcard_image }}">
                        <input type="hidden" name="widget-icon-desc-img-url" id="widget-icon-desc-img-url-{{ item.id }}" value="{{ item.payment_widget_properties.info_image }}">
                            <div class="row" id="lists-{{ item.id }}">
                                <div class="col-md-12">
                                    <div class="form-group" id="widgetduedate_product-{{ item.id }}"
                                         widget-product="{{ item.product }}"
                                         widget-type="{{ item.payment_widget_properties.type }}">
                                        <label for="description" id="widget-product-{{ item.id }}" class="txt-blue">
                                            {{item.product}}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-2">
                                    <div class="form-group">
                                       <label for="description">Template Code</label>
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="widget-template-code-{{ item.id }}" readonly>{{ item.template_code }}</textarea>
                                    </div>
                                </div>
                                 <div class="col-md-2">
                                     <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  id="widget-desc-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{ item.payment_widget_properties.info_text }}</textarea>
                                    </div>
                                </div> 
                                <div class="col-md-3">
                                    <div class="form-group" style="margin: 0;">
                                        <label for="widget-color" style="display:block;">Widget Color</label>
                                        <div style="display:grid;grid-template-columns: auto auto;">
                                            <div style="margin: 5px 0;">
                                                <div>Card Color</div>
                                                <div class="flex-only" id="widget-card-color-{{ item.id }}">
                                                    <div class="color-sample" style="background:{{item.payment_widget_properties.card_colour}};"></div>
                                                    {{item.payment_widget_properties.card_colour}}
                                                </div>
                                            </div>
                                            <div style="margin: 5px 0;">
                                                <div>Info Color</div>
                                                <div class="flex-only" id="widget-info-color-{{ item.id }}">
                                                    <div class="color-sample" style="background:{{item.payment_widget_properties.info_colour}};"></div>
                                                    {{item.payment_widget_properties.info_colour}}
                                                </div>
                                            </div>
                                            <div style="margin: 5px 0;">
                                                <div>Card Text Color</div>
                                                <div class="flex-only" id="widget-card-text-color-{{ item.id }}">
                                                    <div class="color-sample" style="background:{{item.payment_widget_properties.card_text_colour}};"></div>
                                                    {{item.payment_widget_properties.card_text_colour}}
                                                </div>
                                            </div>
                                            <div style="margin: 5px 0;">
                                                <div>Info Text Color</div>
                                                <div class="flex-only" id="widget-info-text-color-{{ item.id }}">
                                                    <div class="color-sample" style="background:{{item.payment_widget_properties.info_text_colour}};"></div>
                                                    {{item.payment_widget_properties.info_text_colour}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="icon-content">Icon Content</label><br/>
                                        <img src="{{item.payment_widget_properties.info_imcard_image}}"
                                        alt="image-icon-content-{{item.id}}" height="56px"
                                        style="margin-left:20px;display:block;"
                                        >
                                    </div>
                                </div>
                                 <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="description">Icon Description</label>
                                        <img src="{{item.payment_widget_properties.info_image}}"
                                                  alt="image-icon-desc-{{item.id}}" height="56px"
                                                  style="margin-left:20px;display:block;"
                                                  >
                                    </div>
                                </div>
                                <div class="onoffswitch">
                                    {% if item.is_active == True %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0" checked>
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="True">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% else %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0">
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="False">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% endif %}
                                </div>
                                <div class="col-md-1">
                                    <br/>
                                    <button type="button" class="btn btn-success btnEditWidgetduedate" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                    </button>
                                    <button type="button" class="btn btn-danger btnDeleteMsg" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
            <div id="tabSlikNotification" class="tab-pane fade
            {% if default_active_tab == 'sliknotification' %} in active{% endif %}">
                <div class="container">
                    <form id="form-sliknotification" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="updated_message_id_sliknotification" id="updated_message_id_sliknotification">
                        <input type="hidden" name="new_message_id_sliknotification" id="new_message_id_sliknotification">
                        <input type="hidden" name="deleted_message_id_sliknotification" id="deleted_message_id_sliknotification">
                        <input type="hidden" name="delete_msg_id_sliknotification" id="delete_msg_id_sliknotification">
                        <input type="hidden" name="update_msg_id_automated_sliknotification" id="update_msg_id_automated_sliknotification">

                        {% for item in listSlikNotification %}
                        <input type="hidden" name="slik-type" id="slik-type-{{ item.id }}" value="{{ item.slik_notification_properties.type }}">
                        <input type="hidden" name="slik-icon-content-img-url" id="slik-icon-content-img-url-{{ item.id }}" value="{{ item.slik_notification_properties.info_imcard_image }}">
                            <div class="row" id="lists-{{ item.id }}">
                                <div class="col-md-12">
                                    <div class="form-group" id="sliknotification_product-{{ item.id }}"
                                        slik-product="{{ item.product }}"
                                        slik-type="{{ item.slik_notification_properties.type }}">
                                        <label for="description" id="slik-product-{{ item.id }}" class="txt-blue">
                                            {{item.product}}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="list-{{ item.id }}">
                                <div class="col-md-2">
                                    <div class="form-group">
                                       <label for="description">Template Code</label>
                                        <textarea class="form-control check-for-update" name="message-{{ item.id }}"
                                                  system-id="{{ item.id }}"
                                                  id="slik-template-code-{{ item.id }}" readonly>{{ item.template_code }}</textarea>
                                    </div>
                                </div>
                                 <div class="col-md-2">
                                     <div class="form-group">
                                        <label for="description">Description</label>
                                        <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                  id="slik-desc-{{ item.id }}"
                                                  system-id="{{ item.id }}" readonly>{{ item.slik_notification_properties.info_text }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                       <label for="link">Redirect URL*</label>
                                       <textarea class="form-control check-for-update" name="parameter-{{ item.id }}"
                                                 id="slik-url-{{ item.id }}"
                                                 system-id="{{ item.id }}" readonly>{{ item.slik_notification_properties.redirect_url }}</textarea>
                                   </div>
                               </div> 
                                <div class="col-md-3">
                                    <div class="form-group" style="margin: 0;">
                                        <label for="slik-color" style="display:block;">Widget Color</label>
                                        <div style="display:grid;grid-template-columns: auto auto;">
                                            <div style="margin: 5px 0;">
                                                <div>Card Color</div>
                                                <div class="flex-only" id="slik-card-color-{{ item.id }}">
                                                    <div class="color-sample" style="background:{{item.slik_notification_properties.card_colour}};"></div>
                                                    {{item.slik_notification_properties.card_colour}}
                                                </div>
                                            </div>
                                            <div style="margin: 5px 0;">
                                                <div>Info Text Color</div>
                                                <div class="flex-only" id="slik-info-text-color-{{ item.id }}">
                                                    <div class="color-sample" style="background:{{item.slik_notification_properties.info_text_colour}};"></div>
                                                    {{item.slik_notification_properties.info_text_colour}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label for="icon-content">Icon Content</label><br/>
                                        <img src="{{item.slik_notification_properties.info_imcard_image}}"
                                        alt="image-icon-content-{{item.id}}" height="56px"
                                        style="margin-left:20px;display:block;"
                                        >
                                    </div>
                                </div>
                                <div class="onoffswitch">
                                    {% if item.is_active == True %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0" checked>
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="True">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% else %}
                                        <input type="checkbox" class="onoffswitch-checkbox" id="msg_active_and_automated-{{ item.id }}"
                                        name="msg_active_and_automated-{{ item.id }}" system-id="{{ item.id }}" tabindex="0">
                                        <label class="onoffswitch-label" for="msg_active_and_automated-{{ item.id }}" value="False">
                                        <span class="onoffswitch-inner"></span>
                                        <span class="onoffswitch-switch"></span>
                                        </label>
                                    {% endif %}
                                </div>
                                <div class="col-md-1">
                                    <br/>
                                    <button type="button" class="btn btn-success btnEditSlikNotification" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                    </button>
                                    <button type="button" class="btn btn-danger btnDeleteMsg" system-id="{{ item.id }}">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </button>
                                </div>
                            </div>
                        {% empty %}
                            <div class="alert alert-info empty-info">
                                <strong>Info!</strong> Tidak ada Data.
                            </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!--########################### modal email add/edit ###############################################-->
    <div id="add-edit-email" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header label-warning">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title email_form_title">Add New Auto Email</h4>
                </div>
                <div class="modal-body" >
                    <form id="add-edit-email_form" method="post">
                    <input type="hidden" name="default_active_tab" value="email">
                    <input type="hidden" name="email_msg_id" id="email_msg_id" value="">
                    {% csrf_token %}
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                            <label for="email_category">Category:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <select class="form-control" id="email_category" name="email_category">
                                <option value="normal" selected="selected">Normal Email</option>
                                <option value="backup">Backup Email</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                            <label for="description">Product:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                        <select class="form-control product_selector" id="email_product" name="email_product">
                            <option value="" selected="selected">Choose One</option>
                            {% for key, value in email_products.items %}
                                <option value="{{ key }}">{{ value }}</option>
                            {% endfor %}
                        </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Type:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                        <select class="form-control" id="email_type" name="email_type">
                            <option value="" selected="selected">Choose One</option>
                            <option value="Payment Reminder" >Payment Reminder</option>
                            <option value="Information">Information</option>
                        </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row partners_selection_div" hidden>
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description" class='partner_selection_div_label'>Exclude Partner(s)</label>
                        <button type="button" class= "select-all-partner" value='select'>select all</button>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align params_div">
                            <select class="form-control partners_selection" id="partners_selection_email" name="partners_selection_email" multiple="multiple">
                            {% for partner in partners %}
                                <option value="{{ partner.id }}" id="partner_ele_em{{ partner.id }}">{{ partner.name }}</option>
                            {% endfor %}
                            </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Time Sent:</label>
                        </div>
                        <div class="col-md-3 col-sm-12 txt-align">
                        <select class="form-control" id="email_hour" name="email_hour">
                            <option value="" selected="selected">Choose Hour</option>
                            {% for i in hrOption %}
                                <option value="{{ i }}">{{ i }}</option>
                            {% endfor %}
                        </select>
                        </div>
                        <div class="col-md-3 col-sm-12 txt-align">
                        <select class="form-control" id="email_minute">
                            <option value="" selected="selected" >Choose Min</option>
                            {% for i in minOption %}
                                <option value="{{ i }}">{{ i }}</option>
                            {% endfor %}
                        </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Template Code:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="email_template_code" placeholder="Template Code"
                                name="email_template_code" maxlength="50" type="text">
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row email_moengage_template_code_div" hidden>
                        <div class="col-md-4 col-sm-12 txt-align">
                            <label for="email_moengage_template_code">MoEngage Template Code:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <input class="form-control" id="email_moengage_template_code" placeholder="MoEngage Template Code"
                                   name="email_moengage_template_code" maxlength="50" type="text">
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Called Parameter:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align params_div">
                            <select class="form-control" id="email_parameters" name="email_parameters" multiple="multiple">
                            {% for item in listParamsEmail %}
                                <option value="{{ item.replace_symbols }}">{{ item.parameter_name }}</option>
                            {% endfor %}
                            </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Subject:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <textarea class="form-control" name="email_subject" id="email_subject"
                                                    placeholder="Subject" rows="2" required></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Pre Header:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <textarea class="form-control" name="email_pre_header" id="email_pre_header"
                                                    placeholder="Pre Header" rows="2" required></textarea>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Content:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <textarea class="form-control" name="email_content" id="email_content"
                                                    placeholder="Content" rows="5" style="overflow:scroll;"></textarea>

                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-12 text-right" style="margin-right: 3px;">
                            <div class="btn-group" role="group" aria-label="Basic example"></div>
                                <button type="button" class="btn btn-success" id="btnView" onclick="preview()" data-target="#content-preview">Preview</button>
                            </div>
                        </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Description:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <textarea class="form-control" name="email_description" id="email_description"
                                                    placeholder="Description" rows="5" required></textarea>
                        </div>
                    </div>
                    <!-- end row -->

                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                           <label for="description">Julo Gold Status </label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                             <label class="radio-inline pb-5">
                                <input type="radio" name="email_julo_gold" id="email_julo_gold_status_execute"
                                       value="execute" label="julo-gold-option-label">Execute
                            </label>
                            <label class="radio-inline pb-5">
                                <input type="radio" name="email_julo_gold" id="email_julo_gold_status_exclude"
                                       value="exclude" label="julo-gold-option-label" checked>Exclude
                            </label>
                            <label class="radio-inline pb-5">
                                <input type="radio" name="email_julo_gold" id="email_julo_gold_status_None"
                                       value=null label="julo-gold-option-label">None
                            </label>
                        </div>
                    </div>
                <!-- end row -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect" id="close_email_form" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" id="save_email_template">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!--########################### modal sms add/edit ###############################################-->
    <div id="modalTestSMS" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header label-warning">
                    <h4 class="modal-title">Test Chars Amount</h4>
                </div>
                <div class="modal-body">
                    <form id="test-sms-form" method="post">
                        {% csrf_token %}
                        <div class="row" style="margin-bottom: 10px">
                            <div class="col-md-3"><label>Customer Id</label></div>
                            <div class="col-md-4">
                                <input type="text" name="test_sms_customer_id"
                                       id="test_sms_customer_id" class="form-control">
                            </div>
                            <div class="col-md-2">
                                <button type="button" class="btn btn-info" id="btnTestSMS">Test</button>
                            </div>
                        </div>
                        <div class="row" style="margin-bottom: 10px">
                            <div class="col-md-3"><label>Preview</label></div>
                            <div class="col-md-6">
                                <textarea class="form-control" name="sms_preview" id="sms_preview"
                                          placeholder="Content" rows="5" style="overflow:scroll;" readonly></textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3"><label>Characters</label></div>
                            <div class="col-md-6">
                                <input type="text" name="test_sms_length"
                                       id="test_sms_length" class="form-control" value="0/160" readonly>
                            </div>
                        </div>

                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect" id="btnCloseTestSMS" data-dismiss="modal">Back</button>
                </div>
            </div>
        </div>
    </div>
    <div id="add-edit-sms" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header label-warning">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title sms_form_title">Add New Auto SMS</h4> </div>
                <div class="modal-body" >
                    <form id="add-edit-sms_form" method="post">
                    <input type="hidden" name="default_active_tab" value="sms">
                    <input type="hidden" name="sms_msg_id" id="sms_msg_id" value="">
                    {% csrf_token %}
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                            <label for="description">Product:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                        <select class="form-control product_selector" id="sms_product" name="sms_product">
                            <option value="" selected="selected">Choose One</option>
                            {% for sms_value, sms_product in sms_products.items %}
                                <option value="{{ sms_value }}">{{ sms_product }}</option>
                            {% endfor %}
                        </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Type:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                        <select class="form-control" id="sms_type" name="sms_type">
                            <option value="" selected="selected">Choose One</option>
                            <option value="Payment Reminder" >Payment Reminder</option>
                            <option value="Information">Information</option>
                        </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row partners_selection_div" hidden>
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description" class='partner_selection_div_label'>Exclude Partner(s)</label>
                        <button type="button" class= "select-all-partner" value='select'>select all</button>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align params_div">
                            <select class="form-control partners_selection" id="partners_selection_sms" name="partners_selection_sms" multiple="multiple">
                            {% for partner in partners %}
                                <option value="{{ partner.id }}" id="partner_ele_sms{{ partner.id }}">{{ partner.name }}</option>
                            {% endfor %}
                            </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Time Sent:</label>
                        </div>
                        <div class="col-md-3 col-sm-12 txt-align">
                        <select class="form-control" id="sms_hour" name="sms_hour">
                            <option value="" selected="selected">Choose Hour</option>
                            {% for i in hrOption %}
                                <option value="{{ i }}">{{ i }}</option>
                            {% endfor %}
                        </select>
                        </div>
                        <div class="col-md-3 col-sm-12 txt-align">
                        <select class="form-control" id="sms_minute">
                            <option value="" selected="selected" >Choose Min</option>
                            {% for i in minOption %}
                                <option value="{{ i }}">{{ i }}</option>
                            {% endfor %}
                        </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Template Code:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="sms_template_code" placeholder="Template Code"
                                name="sms_template_code" maxlength="50" type="text">
                        </div>
                    </div>
                    <!-- end row -->
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Called Parameter:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align params_div">
                            <select class="form-control" id="sms_parameters" name="sms_parameters" multiple="multiple">
                            {% for item in listParamsSMS %}
                                <option value="{{ item.replace_symbols }}">{{ item.parameter_name }}</option>
                            {% endfor %}
                            </select>
                        </div>
                    </div>
                    <!-- end row -->
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Content:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <textarea class="form-control" name="sms_content" id="sms_content"
                                                    placeholder="Content" rows="5"></textarea>

                        </div>
                    </div>
                    <!-- end row -->
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Description:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <textarea class="form-control" name="sms_description" id="sms_description"
                                                    placeholder="Description" rows="5" required></textarea>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-4 col-sm-12 txt-align">
                           <label for="description">Julo Gold Status </label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                             <label class="radio-inline pb-5">
                                <input type="radio" name="sms_julo_gold_status" id="sms_julo_gold_status_execute"
                                       value="execute" label="julo-gold-option-label" >Execute
                            </label>
                            <label class="radio-inline pb-5">
                                <input type="radio" name="sms_julo_gold_status" id="sms_julo_gold_status_exclude"
                                       value="exclude" label="julo-gold-option-label" >Exclude
                            </label>
                            <label class="radio-inline pb-5">
                                <input type="radio" name="sms_julo_gold_status" id="sms_julo_gold_status_None"
                                       value=null label="julo-gold-option-label" >None
                            </label>
                        </div>
                    </div>
                <!-- end row -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect" id="close_sms_form" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-info" id="btn_sms_preview" data-target="modalTestSMS">Test char amount</button>
                    <button type="button" class="btn btn-success" id="save_sms_template">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!--########################### modal robocall add/edit ###############################################-->
    <div id="add-edit-robocall" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title robocall_form_title">Add New Auto Robocall</h4> </div>
            <div class="modal-body" >
                <form id="add-edit-robocall_form" method="post">
                <input type="hidden" name="default_active_tab" value="robocall">
                <input type="hidden" name="robocall_msg_id" id="robocall_msg_id" value="">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Product:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control product_selector" id="robocall_product" name="robocall_product" onchange="filter_function_list('', '.robocall-function-list')">
                        <option value="" selected="selected">Choose One</option>
                        <option value="nexmo_mtl" >Nexmo MTL</option>
                        <option value="nexmo_stl" >Nexmo STL</option>
                        <option value="nexmo_j1" >Nexmo J1</option>
                        <option value="nexmo_pedemtl" >Nexmo Pede MTL</option>
                        <option value="nexmo_pedestl" >Nexmo Pede STL</option>
                        <option value="nexmo_grab" >Nexmo Grab</option>
                        <option value="nexmo_dana" >Nexmo Dana</option>
                        <option value="nexmo_turbo" >Nexmo JTurbo</option>
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Type:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control" id="robocall_type" name="robocall_type">
                        <option value="" selected="selected">Choose One</option>
                        <option value="Payment Reminder" >Payment Reminder</option>
                        <option value="Information">Information</option>
                      </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Segment:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control" id="robocall_segment" name="robocall_segment">
                          <option value="None">Choose One</option>
                          <option value="elephant">elephant</option>
                          <option value="hamster">hamster</option>
                          <option value="bull">bull</option>
                          <option value="scorpion">scorpion</option>
                       </select>
                    </div>
                </div>
                <div class="row partners_selection_div" hidden>
                    <div class="col-md-4 col-sm-12 txt-align">
                    <label for="description" class='partner_selection_div_label'>Exclude Partner(s)</label>
                    <button type="button" class= "select-all-partner" value='select'>select all</button>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align params_div">
                        <select class="form-control partners_selection" id="partners_selection_robocall" name="partners_selection_robocall" multiple="multiple">
                        {% for partner in partners %}
                            <option value="{{ partner.id }}" id="partner_ele_robocall{{ partner.id }}">{{ partner.name }}</option>
                        {% endfor %}
                        </select>
                    </div>
                </div>
                <!-- end row -->
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Attempts:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <input class="form-control" id="robocall_attempts" placeholder="Attempts"
                              name="robocall_attempts" maxlength="1" type="text"
                              onkeyup="if (/\D/g.test(this.value)) this.value = this.value.replace(/\D/g,'')">

                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Call Hour:</label><br>(once set time it will automatically execute postalcodes WIT = hour-2,WITA = hour-1 and WIB =hour)
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align params_div">
                        <div class="row more_params">
                            <div class="col-md-2 col-sm-12">
                                Add
                            </div>
                            <div class="col-md-1 col-sm-12">
                                <button type="button" class="btn btn-success" id="add_parameters">+
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end row -->                                    <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Time Out Duration:</label>
                    </div>
                    <div class="col-md-2 col-sm-12 txt-align">
                       <input class="form-control" id="robocall_time_out_duration" placeholder="3"
                              name="robocall_time_out_duration" maxlength="10" value=30 type="number">
                    </div>
                    <div class="col-md-3 col-sm-12 txt-align">
                        <span style="margin-left:0px; vertical-align: text-bottom;">seconds</span>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Template Code:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <input class="form-control" id="robocall_template_code" placeholder="Template Code"
                              name="robocall_template_code" maxlength="50" type="text">
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Called Parameter:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align params_div">
                        <select class="form-control" id="robocall_parameters" name="robocall_parameters"
                                multiple="multiple">
                        {% for item in listParameter %}
                            <option value="{{ item.replace_symbols }}">{{ item.parameter_name }}</option>
                        {% endfor %}
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Voice Message:</label>
                        <br>(once you done click Generate Content button, copy the value to Content field)
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align params_div">
                        <select class="form-control" id="voice_message">
                            <option value="">Choose Voice Message</option>
                            {% for item in listVoiceMessages %}
                                <option value="{{ item.audio_file_url }}">{{ item.title }}</option>
                            {% endfor %}
                        </select>
                        <div class="voice_message_wrapper hide">
                            <audio src="" controls="" class="audio_player">Your browser does not support the audio element.</audio>
                            <button type="button" class="btn btn-primary" id="generate_voice_content">Generate Content</button>
                            <textarea class="voice_content form-control" id="voice_content" readonly style="height: 135px;"></textarea>
                        </div>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Content:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="robocall_content" id="robocall_content"
                                                  placeholder="Content" rows="5"></textarea>

                    </div>
                </div>
                 <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Description:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="robocall_description" id="robocall_description"
                                                  placeholder="Description" rows="5" required></textarea>
                    </div>
                </div>
                 <!-- end row -->

                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Exclude isrisky dpd-?</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <label class="switch">
                            <input type="checkbox" checked="" id="robocall_exclude_risky" name="robocall_exclude_risky"class="check_status" value="True">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>
                <!-- end row -->

                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Julo Gold Status </label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                         <label class="radio-inline pb-5">
                            <input type="radio" name="robocall_julo_gold_status" id="robocall_julo_gold_status_execute"
                                   value="execute"
                                   label="julo-gold-option-label" >Execute
                        </label>
                        <label class="radio-inline pb-5">
                            <input type="radio" name="robocall_julo_gold_status" id="robocall_julo_gold_status_exclude"
                                   value="exclude"
                                   label="julo-gold-option-label" >Exclude
                        </label>
                        <label class="radio-inline pb-5">
                            <input type="radio" name="robocall_julo_gold_status" id="robocall_julo_gold_status_None"
                                   value=null
                                   label="julo-gold-option-label" >None
                        </label>
                    </div>
                </div>
                <!-- end row -->

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default waves-effect" id="close_robocall_form" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="test_robocall_template">Test Robocall</button>
                <button type="button" class="btn btn-success" id="save_robocall_template">Save</button>
            </div>
        </div>
    </div>
    </div>

<!--########################### modal pn add/edit ###############################################-->
<div id="add-edit-pn" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title pn_form_title">Add New Auto PN</h4> </div>
            <div class="modal-body" >
                <form id="add-edit-pn_form" method="post" enctype="multipart/form-data">
                <input type="hidden" name="default_active_tab" value="pn">
                <input type="hidden" name="pn_msg_id" id="pn_msg_id" value="">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="pn_category">Category:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <select class="form-control" id="pn_category" name="pn_category">
                            <option value="normal" selected="selected">Normal PN</option>
                            <option value="backup">Backup PN</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Product:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control" id="pn_product" name="pn_product">
                        <option value="" selected="selected">Choose One</option>
                        <option value="j1" >J1</option>
                        <option value="jturbo" >JTURBO</option>
                        <option value="mtl" >MTL</option>
                        <option value="stl" >STL</option>
                        <option value="pedemtl" >Pede MTL</option>
                        <option value="pedestl">Pede STL</option>
                        <option value="laku6">LAKU6</option>
                        <option value="bukalapak">Bukalapak Bayarnanti</option>
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Type:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control" id="pn_type" name="pn_type">
                        <option value="" selected="selected">Choose One</option>
                        <option value="Payment Reminder" >Payment Reminder</option>
                        <option value="Information">Information</option>
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Time Sent:</label>
                    </div>
                    <div class="col-md-3 col-sm-12 txt-align">
                       <select class="form-control" id="pn_hour" name="pn_hour">
                        <option value="" selected="selected">Choose Hour</option>
                        {% for i in hrOption %}
                            <option value="{{ i }}">{{ i }}</option>
                        {% endfor %}
                      </select>
                    </div>
                    <div class="col-md-3 col-sm-12 txt-align">
                       <select class="form-control" id="pn_minute">
                        <option value="" selected="selected" >Choose Min</option>
                        {% for i in minOption %}
                            <option value="{{ i }}">{{ i }}</option>
                        {% endfor %}
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Template Code:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <input class="form-control" id="pn_template_code" placeholder="Template Code"
                              name="pn_template_code" maxlength="50" type="text">
                    </div>
                </div>
                <!-- end row -->
                <div class="row pn_moengage_template_code_div" hidden>
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="pn_moengage_template_code">MoEngage Template Code:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="pn_moengage_template_code" placeholder="MoEngage Template Code"
                               name="pn_moengage_template_code" maxlength="50" type="text">
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Called Parameter:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align params_div">
                        <select class="form-control" id="pn_parameters" name="pn_parameters" multiple="multiple">
                        {% for item in listParamsPN %}
                            <option value="{{ item.replace_symbols }}">{{ item.parameter_name }}</option>
                        {% endfor %}
                        </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Heading:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="pn_heading" id="pn_heading"
                                                  placeholder="Heading" rows="5"></textarea>

                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Title:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="pn_subject" placeholder="Title"
                               name="pn_subject" type="text">
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Content:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="pn_content" id="pn_content"
                                                  placeholder="Content" rows="5"></textarea>

                    </div>
                </div>
                <!-- end row -->
                 <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Description:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="pn_description" id="pn_description"
                                                  placeholder="Description" rows="5" required></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Image:</label>
                    </div>
                    <div  type="hidden" id="pn_image_status" name="pn_image_status"></div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="pn_image"
                              name="pn_image" type="file"/>
                        <input type="hidden" name="is_pn_image_changes" id="is_pn_image_changes" value="false">
                        <div id="pn_image_preview_div" class="ffset-2"  style="display: none">
                            <a href="#" class="btn btn-primary edit-section" id="btn_image_link_pn_image">
                                <span class="glyphicon glyphicon-picture" aria-hidden="true"></span>
                            </a>
                        <button type="submit" class="close" >
                            <span>&times;</span>
                        </button>
                        </div>
                    </div>
                </div>
                <!-- end row -->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default waves-effect" id="close_pn_form" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" id="save_pn_template">Save</button>
            </div>
        </div>
    </div>
</div>

<!--########################### modal parameter list add/edit ###############################################-->
<div id="add-edit-parameterlist" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title parameterlist_form_title">Add New Auto Parameter List</h4> </div>
            <div class="modal-body" >
                <form id="add-edit-parameterlist_form" method="post">
                <input type="hidden" name="default_active_tab" value="parameterlist">
                <input type="hidden" name="parameterlist_msg_id" id="parameterlist_msg_id" value="">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                    <label for="description">Parameter</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="parameterlist_parameter" id="parameterlist_parameter"
                                                placeholder="Parameter" rows="5"></textarea>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                    <label for="description">Platform</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <select class="form-control" id="parameterlist_platform" name="parameterlist_platform">
                            <option value="" selected="selected">Choose One</option>
                            {% for value, text in communicationPlatforms %}
                                <option value="{{ value }}" >{{ text }}</option>
                            {% endfor %}
                          </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                    <label for="description">Example</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="parameterlist_example" id="parameterlist_example"
                                                placeholder="Example" rows="5"></textarea>

                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                    <label for="description">Description</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="parameterlist_description" id="parameterlist_description"
                                                placeholder="Description" rows="5" required></textarea>
                    </div>
                </div>
                <!-- end row -->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default waves-effect" id="close_parameter_form" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" id="save_parameterlist_template">Save</button>
            </div>
        </div>
    </div>
</div>

<!--########################### modal info card add/edit ###############################################-->
<div id="add-edit-info-card" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title info_card_form_title">Add New Info Card</h4> </div>
            <div class="modal-body" >
                <form id="info-card-form" method="post" action="{%url 'streamlined:create_new_info_card' %}" enctype="multipart/form-data">
                <input type="hidden" name="default_active_tab" value="info_card">
                <input type="hidden" name="info_card_msg_id" id="info_card_msg_id" value="">
                <input type="hidden" name="info_card_id" id="info_card_id" value="">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Template Code:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <input class="form-control" id="info_card_template_code" placeholder="Template Code"
                              name="info_card_template_code" maxlength="50" type="text" required>
                    </div>
                </div>
                    <!-- end row -->
                {% if infocard_expiry_feature == True %}

                <div class="row" >
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Expiration Option:</label>
                    </div>
                     <div class="col-md-8 col-sm-12 txt-align expiration-option-input">
                        <div class="row txt-align">
                            <div class="col-md-12 col-sm-12">
                                <label class="radio-inline pb-5">
                                    <input type="radio" name="expiration_option" class="expiration-destination"
                                           value="Triggered by - Customer Entered Status & Condition" show="expiration-period-input-section"
                                           label="expiration-option-label" >Triggered by - Customer Entered Status & Condition
                                </label>
                            </div>
                             <div class="col-md-12 col-sm-12">
                                <label class="radio-inline pb-5">
                                    <input type="radio" name="expiration_option" class="expiration-destination"
                                           value="Triggered by - Campaign Creation Date" show="expiration-period-input-section"
                                            label="expiration-option-label" >Triggered by - Campaign Creation Date
                                </label>
                             </div>
                             <div class="col-md-12 col-sm-12">
                                 <label class="radio-inline pb-5">
                                    <input type="radio" name="expiration_option" class="expiration-destination"
                                           value="No Expiration Time"
                                           hide="expiration-period-input-section" label="expiration-option-label" checked>No Expiration Time
                                </label>
                             </div>
                        </div>
                     </div>
                    <div class="col-md-8 col-sm-12 hide txt-align expiration-option-readonly">
                        <textarea class="form-control" name="info-card-expiration-option-data"  readonly></textarea>
                    </div>
                </div>
                 <!-- end row -->
                 <div class="row expiration-option-input expiration-period-input-section">
                    <div class="col-md-4 col-sm-12 txt-align card-destination-label label-destination">
                       <label for="description">Expiry period:</label>
                    </div>

                    <div class="col-md-6 col-sm-12 txt-align expiry-input">
                        <div class="row form-inline">
                            <div class="form-group col-xs-1 mb-2">
                                <input type="radio" name="expiry_period_unit" class="expiration-destination"
                                           value="days"  label="expiry_period_unit-label" >
                             </div>
                          <div class="form-group col-xs-11 mx-sm-3 mb-2">
                            <label class="form-check-label" for="expiry_period_unit" >
                                <input class="form-control expiry_unit"  placeholder="Expiry in Days"
                                  name="expiry_period_days" type="number" > Days</label>
                          </div>
                    </div>
                    <div class="row form-inline">
                            <div class="form-group col-xs-1 mb-2">
                                <input type="radio" name="expiry_period_unit" class="expiration-destination"
                                           value="hours"
                                            label="expiry_period_unit-label" >
                             </div>
                          <div class="form-group col-xs-11 mx-sm-3 mb-2">
                            <label class="form-check-label" for="expiry_period_unit" >
                                <input class="form-control expiry_unit"  placeholder="Expiry in Hours"
                                  name="expiry_period_hours" type="number" > Hours</label>
                          </div>

                        </div>

                    </div>
                </div>
                <!-- end row -->
                {% endif %}
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Type:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control" id="info_card_type" name="info_card_type">
                        <option value="" selected="selected">Choose One</option>
                        {% for value, text in info_card_type_choices %}
                        <option value="{{ value }}" >{{ text }}</option>
                       {% endfor %}
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row exclude-section-type9" style="border-bottom: solid 1px;">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="description">Product:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control" id="info_card_product" name="info_card_product">
                        <option value="" selected="selected">Choose One</option>
                        {% for value, text in info_card_product %}
                        <option value="{{ value }}" >{{ text }}</option>
                       {% endfor %}
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row" id="feature_checkbox_for_info_card" style="display: none;">
                    <div class="col-md-6 col-md-offset-4 col-sm-12 txt-align">
                       <div class="type-1 type-2 type-3 checked_type">
                          <label><input type="checkbox" name="clickable_card" id="clickable_card" value="clickable_section" class="feature_info_card" style="margin-right:10px;">Clickable Card</label>
                        </div>
                        <div class="type-3 checked_type">
                          <label><input type="checkbox" name="is_have_l_button" id="is_have_l_button" value="l_button_section" class="feature_info_card" style="margin-right:10px;">L/M Button</label>
                        </div>
                        <div class="type-1 type-3 checked_type">
                          <label><input type="checkbox" name="is_have_r_button" id="is_have_r_button" value="r_button_section" class="feature_info_card" style="margin-right:10px;">R Button</label>
                        </div>
                        <div class="type-2 checked_type">
                          <label><input type="checkbox" name="is_have_m_button" id="is_have_m_button" value="m_button_section" class="feature_info_card" style="margin-right:10px;">M Button</label>
                        </div>
                    </div>
                </div>
                <!-- end row -->
                <div class="row clickable_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Card Action:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <label class="radio-inline">
                            <input type="radio" name="card_action" class="destination"
                                   value="app_deeplink" show="card-destination-app_deeplink-section"
                                   hide="card-destination-webpage-section"
                                   hide1="card-destination-redirect-section"
                                   label="card-destination-label" checked>App Deeplink</label>
                        <label class="radio-inline">
                            <input type="radio" name="card_action" class="destination"
                                   value="webpage" show="card-destination-webpage-section"
                                   hide="card-destination-app_deeplink-section"
                                   hide1="card-destination-redirect-section"
                                   label="card-destination-label">Webpage</label>
                        <label class="radio-inline">
                            <input type="radio" name="card_action" class="destination"
                                   value="redirect" show="card-destination-redirect-section"
                                   hide="card-destination-app_deeplink-section"
                                   hide1="card-destination-webpage-section"
                                   label="card-destination-label">Redirect</label>
                    </div>
                </div>
                <div class="row clickable_section">
                    <div class="col-md-4 col-sm-12 txt-align card-destination-label label-destination">
                       <label for="description">Card Destination:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align card-destination-webpage-section destination-input" style="display:none;">
                       <input class="form-control" id="info_card_destination_web" placeholder="Card Destination"
                              name="info_card_destination_webpage" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align card-destination-redirect-section destination-input" style="display:none;">
                       <input class="form-control" id="info_card_destination_redirect" placeholder="Card Destination"
                              name="info_card_destination_redirect" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align card-destination-app_deeplink-section destination-input">
                       <select class="form-control" id="info_card_destination_deep_link" name="info_card_destination_app_deeplink">
                        <option value="" selected="selected">Choose One</option>
                        {% for value, text in app_deeplink_list %}
                        <option value="{{ value }}" >{{ text }}</option>
                       {% endfor %}
                      </select>
                    </div>
                </div>
                <!--  L button -->
                <div class="row l_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">L Button Text:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="l_button_text" placeholder="Button Text"
                              name="l_button_text" type="text">
                    </div>
                </div>
                <div class="row l_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">L Button Text Color:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                          <div class="input-group">
                            <span class="input-group-addon" id="color-preview-l-button"></span>
                            <input id="l_button_text_color" type="text" class="form-control button_text_color" name="l_button_text_color"
                                   placeholder="#Color" maxlength="7" preview="color-preview-l-button" value="#ffffff">
                          </div>
                    </div>
                </div>
                <div class="row l_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">L Button Image:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="l_button_image"
                              name="l_button_image" type="file">
                        <button type="button" class="btn btn-danger edit-section" id="btn_delete_image_l_button" style="display: none"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                        <a href="#" class="btn btn-primary edit-section" id="btn_image_link_l_button" style="display: none" target="_blank"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span></a>
                        <input type="hidden" id="is_button_l_background_changes" name="is_button_l_background_changes" value="false">
                    </div>
                </div>
                <div class="row l_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">L Button Text Action:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <label class="radio-inline">
                            <input type="radio" name="l_button_action" class="destination"
                                   value="app_deeplink" show="l-button-destination-app_deeplink-section"
                                   hide="l-button-destination-webpage-section"
                                   hide1="l-button-destination-redirect-section"
                                   label="label-button-l-destination" checked>App Deeplink</label>
                        <label class="radio-inline">
                            <input type="radio" name="l_button_action" class="destination"
                                   value="webpage" show="l-button-destination-webpage-section"
                                   hide="l-button-destination-app_deeplink-section"
                                   hide1="l-button-destination-redirect-section"
                                   label="label-button-l-destination">Webpage</label>
                        <label class="radio-inline">
                            <input type="radio" name="l_button_action" class="destination"
                                   value="redirect" show="l-button-destination-redirect-section"
                                   hide="l-button-destination-app_deeplink-section"
                                   hide1="l-button-destination-webpage-section"
                                   label="label-button-l-destination">Redirect</label>
                    </div>
                </div>
                <div class="row l_button_section" style="display:none; border-bottom: solid 1px;">
                    <div class="col-md-4 col-sm-12 txt-align label-button-l-destination label-destination">
                       <label for="description">L Button Destination:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align l-button-destination-webpage-section destination-input" style="display:none;">
                       <input class="form-control" id="l_button_destination_web" placeholder="L Button Destination URL"
                              name="l_button_destination_webpage" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align l-button-destination-redirect-section destination-input" style="display:none;">
                       <input class="form-control" id="l_button_destination_redirect" placeholder="L Button Redirect URL"
                              name="l_button_destination_redirect" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align l-button-destination-app_deeplink-section destination-input">
                       <select class="form-control" id="l_button_destination_deep_link" name="l_button_destination_app_deeplink">
                        <option value="" selected="selected">Choose One</option>
                        {% for value, text in app_deeplink_list %}
                        <option value="{{ value }}" >{{ text }}</option>
                       {% endfor %}
                      </select>
                    </div>
                </div>
                <div class="row l_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">L Button Color:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                          <div class="input-group">
                            <span class="input-group-addon" id="color-preview-l-button1"></span>
                            <input id="l_button_color" type="text" class="form-control button_text_color" name="l_button_color"
                                   placeholder="#Color" maxlength="7" preview="color-preview-l-button1" value="#ffffff">
                          </div>
                    </div>
                </div>
                <!--  R button -->
                <div class="row r_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">R Button Text:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="r_button_text" placeholder="Button Text"
                              name="r_button_text" type="text">
                    </div>
                </div>
                <div class="row r_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">R Button Text Color:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                          <div class="input-group">
                            <span class="input-group-addon" id="color-preview-r-button"></span>
                            <input id="r_button_text_color" type="text" class="form-control button_text_color" name="r_button_text_color"
                                   placeholder="#Color" maxlength="7" preview="color-preview-r-button" value="#ffffff">
                          </div>
                    </div>
                </div>
                <div class="row r_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">R Button Image:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="r_button_image"
                              name="r_button_image" type="file">
                        <button type="button" class="btn btn-danger edit-section" id="btn_delete_image_r_button" style="display: none"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                        <a href="#" class="btn btn-primary edit-section" id="btn_image_link_r_button" target="_blank" style="display: none"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span></a>
                        <input type="hidden" id="is_button_r_background_changes" name="is_button_r_background_changes" value="false">
                    </div>
                </div>
                <div class="row r_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">R Button Text Action:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <label class="radio-inline">
                            <input type="radio" name="r_button_action" class="destination"
                                   value="app_deeplink" show="r-button-destination-app_deeplink-section"
                                   hide="r-button-destination-webpage-section"
                                   hide1="r-button-destination-redirect-section"
                                   label="label-button-r-destination" checked>App Deeplink</label>
                        <label class="radio-inline">
                            <input type="radio" name="r_button_action" class="destination"
                                   value="webpage" show="r-button-destination-webpage-section"
                                   hide="r-button-destination-app_deeplink-section"
                                   hide1="r-button-destination-redirect-section"
                                   label="label-button-r-destination">Webpage</label>
                        <label class="radio-inline">
                            <input type="radio" name="r_button_action" class="destination"
                                   value="redirect" show="r-button-destination-redirect-section"
                                   hide="r-button-destination-app_deeplink-section"
                                   hide1="r-button-destination-webpage-section"
                                   label="label-button-r-destination">Redirect</label>
                    </div>
                </div>
                <div class="row r_button_section" style="display:none; border-bottom: solid 1px;">
                    <div class="col-md-4 col-sm-12 txt-align label-button-r-destination label-destination">
                       <label for="description">R Button Destination:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align r-button-destination-webpage-section destination-input" style="display:none;">
                       <input class="form-control" id="r_button_destination_web" placeholder="R Button Destination URL"
                              name="r_button_destination_webpage" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align r-button-destination-redirect-section destination-input" style="display:none;">
                       <input class="form-control" id="r_button_destination_redirect" placeholder="R Button Redirect URL"
                              name="r_button_destination_redirect" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align r-button-destination-app_deeplink-section destination-input">
                       <select class="form-control" id="r_button_destination_deep_link" name="r_button_destination_app_deeplink">
                        <option value="" selected="selected">Choose One</option>
                        {% for value, text in app_deeplink_list %}
                        <option value="{{ value }}" >{{ text }}</option>
                       {% endfor %}
                      </select>
                    </div>
                </div>
                <div class="row r_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">R Button Color:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                          <div class="input-group">
                            <span class="input-group-addon" id="color-preview-r-button1"></span>
                            <input id="r_button_color" type="text" class="form-control button_text_color" name="r_button_color"
                                   placeholder="#Color" maxlength="7" preview="color-preview-r-button1" value="#ffffff">
                          </div>
                    </div>
                </div>
                <!--  M button -->
                <div class="row m_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">M Button Text:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="m_button_text" placeholder="Button Text"
                              name="m_button_text" type="text">
                    </div>
                </div>
                <div class="row m_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">M Button Text Color:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                          <div class="input-group">
                            <span class="input-group-addon" id="color-preview-m-button"></span>
                            <input id="m_button_text_color" type="text" class="form-control button_text_color" name="m_button_text_color"
                                   placeholder="#Color" maxlength="7" preview="color-preview-m-button" value="#ffffff">
                          </div>
                    </div>
                </div>
                <div class="row m_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">M Button Image:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="m_button_image"
                              name="m_button_image" type="file">
                        <button type="button" class="btn btn-danger edit-section" id="btn_delete_image_m_button" style="display: none"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                        <a href="#" class="btn btn-primary edit-section" id="btn_image_link_m_button" target="_blank" style="display: none"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span></a>
                        <input type="hidden" id="is_button_m_background_changes" name="is_button_m_background_changes" value="false">
                    </div>
                </div>
                <div class="row m_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">M Button Text Action:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <label class="radio-inline">
                            <input type="radio" name="m_button_action" class="destination"
                                   value="app_deeplink" show="m-button-destination-app_deeplink-section"
                                   hide="m-button-destination-webpage-section"
                                   hide1="m-button-destination-redirect-section"
                                   hide2="m-button-destination-reload-section"
                                   label="label-button-m-destination" checked>App Deeplink</label>
                        <label class="radio-inline">
                            <input type="radio" name="m_button_action" class="destination"
                                   value="webpage" show="m-button-destination-webpage-section"
                                   hide="m-button-destination-app_deeplink-section"
                                   hide1="m-button-destination-redirect-section"
                                   hide2="m-button-destination-reload-section"
                                   label="label-button-m-destination">Webpage</label>
                        <label class="radio-inline">
                            <input type="radio" name="m_button_action" class="destination"
                                   value="redirect" show="m-button-destination-redirect-section"
                                   hide="m-button-destination-app_deeplink-section"
                                   hide1="m-button-destination-webpage-section"
                                   hide2="m-button-destination-reload-section"
                                   label="label-button-m-destination">Redirect</label>
                        <label class="radio-inline">
                            <input type="radio" name="m_button_action" class="destination"
                                   value="reload" show="m-button-destination-reload-section"
                                   hide="m-button-destination-app_deeplink-section"
                                   hide1="m-button-destination-webpage-section"
                                   hide2="m-button-destination-redirect-section"
                                   label="label-button-m-destination">Reload</label>
                    </div>
                </div>
                <div class="row m_button_section" style="display:none; border-bottom: solid 1px;">
                    <div class="col-md-4 col-sm-12 txt-align label-button-m-destination label-destination">
                       <label for="description">M Button Destination:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align m-button-destination-webpage-section destination-input" style="display:none;">
                       <input class="form-control" id="m_button_destination_web" placeholder="M Button Destination URL"
                              name="m_button_destination_webpage" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align m-button-destination-redirect-section destination-input" style="display:none;">
                       <input class="form-control" id="m_button_destination_redirect" placeholder="M Button Redirect URL"
                              name="m_button_destination_redirect" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align m-button-destination-reload-section destination-input" style="display:none;">
                       <input class="form-control" id="m_button_destination_reload" placeholder="M Button Reload URL"
                              name="m_button_destination_reload" type="text">
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align m-button-destination-app_deeplink-section destination-input">
                       <select class="form-control" id="m_button_destination_deep_link" name="m_button_destination_app_deeplink">
                        <option value="" selected="selected">Choose One</option>
                        {% for value, text in app_deeplink_list %}
                        <option value="{{ value }}" >{{ text }}</option>
                       {% endfor %}
                      </select>
                    </div>
                </div>
                <div class="row m_button_section" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">M Button Color:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                          <div class="input-group">
                            <span class="input-group-addon" id="color-preview-m-button1"></span>
                            <input id="m_button_color" type="text" class="form-control button_text_color" name="m_button_color"
                                   placeholder="#Color" maxlength="7" preview="color-preview-m-button1" value="#ffffff">
                          </div>
                    </div>
                </div>
                <!-- end row -->
                <div class="row exclude-section-type9">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Background:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="background_card_image"
                              name="background_card_image" type="file"/>
                        <input type="hidden" name="is_background_changes" id="is_background_changes" value="false">
                        <a href="#" class="btn btn-primary edit-section" id="btn_image_link_card_background" target="_blank" style="display: none"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span></a>
                    </div>
                </div>
                <!-- end row -->
                <!--begin row-->
                <div class="row type-9" style="display:none;">
                    <div class="col-md-4 col-sm-12 txt-align" id="youtube-link-type-4">
                    <label for="youtube-video-id">Youtube Video ID:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <input class="form-control" id="youtube_video_id" placeholder="Youtube Video ID"
                                 name="youtube_video_id" maxlength="50" type="text" required>
                    </div>
                </div>
                <!--end row-->
                <div class="row type-1 type-3" style="display: none;">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Image:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control" id="optional_image"
                              name="optional_image" type="file"/>
                        <input type="hidden" name="is_optional_image_changes" id="is_optional_image_changes" value="false">
                        <a href="#" class="btn btn-primary edit-section" id="btn_image_link_card_optional_image" target="_blank" style="display: none"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span></a>
                    </div>
                </div>
                <div class="row exclude-section-type9">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Called Parameter:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align params_div">
                        <select class="form-control" id="info_card_parameters" name="info_card_parameters" multiple="multiple">
                        {% for item in listParameterInfoCard %}
                            <option value="{{ item.replace_symbols }}">{{ item.parameter_name }}</option>
                        {% endfor %}
                        </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Title:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="info_card_title" id="info_card_title"
                                                  placeholder="Info Card Title" rows="2"></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Title Text Color:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                          <div class="input-group">
                            <span class="input-group-addon" id="color-preview-card-title"></span>
                            <input id="title_text_color" type="text" class="form-control button_text_color" name="title_text_color"
                                   placeholder="#Color" maxlength="7" preview="color-preview-card-title" value="#ffffff">
                          </div>
                    </div>
                </div>
                <div class="row exclude-section-type9">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Body:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <textarea class="form-control" name="info_card_content" id="info_card_content"
                                                  placeholder="Content" rows="5"></textarea>

                    </div>
                </div>
                <div class="row exclude-section-type9">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Body Text Color:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                          <div class="input-group">
                            <span class="input-group-addon" id="color-preview-card-body"></span>
                            <input id="body_text_color" type="text" class="form-control button_text_color" name="body_text_color"
                                   placeholder="#Color" maxlength="7" preview="color-preview-card-body" value="#ffffff">
                          </div>
                    </div>
                </div>
                <div class="row ">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Bottom Sheet Destination:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                            <input class="form-control" id="bottom_sheet_destination" placeholder="Bottom Sheet Destination"
                                name="bottom_sheet_destination" maxlength="250" type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label><input type="checkbox" name="is_shown_in_android" id="is_shown_in_android" value="shown_in_app_section"
                                     class="feature_info_card" style="margin-right:10px;">Shown in Android</label>
                    </div>
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label><input type="checkbox" name="is_shown_in_webview" id="is_shown_in_webview" value="shown_in_webview_section"
                                     class="feature_info_card" style="margin-right:10px;">Shown in Webview</label>
                    </div>
                </div>
                <!-- end row -->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default waves-effect" id="btnPreviewForm">Preview</button>
                <button type="button" class="btn btn-success" id="save_info_card_template">Save</button>
            </div>
        </div>
    </div>
</div>
    <!--########################### modal box to confirm the called parameter selected in dropdown to add in to the content textbox ###############################################-->
    <div id="confirm_call_parameter" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header label-warning">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title">Do you want to add this to Content?</h4> </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect" id="close_confirm_call" data-dismiss="modal">No</button>
                    <button type="button" class="btn btn-danger waves-effect waves-light" id="add_call_parameter">Yes</button>
                </div>
            </div>
        </div>
    </div>

    <!--########################### modal box to confirm the msg to be deleted or not ###############################################-->
    <div id="confirm_delete_msg" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header label-warning">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title">Do you want to delete this message?</h4>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect" id="close_confirm_delete" data-dismiss="modal">No</button>
                    <button type="button" class="btn btn-danger waves-effect waves-light" id="btnDeleteMsgConfirmed">Yes</button>
                </div>
            </div>
        </div>
    </div>
    <div id="confirmation-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <input type="hidden" id="change_status">
                <input type="hidden" id="streamlined_comm_id">
                <input type="hidden" name="changed_value" id="changed_value" value="">
                <div class="modal-header label-warning">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="message-confirmation-modal"></h4>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect" id="close_confirmation" data-dismiss="modal">No</button>
                    <button type="button" class="btn btn-danger waves-effect waves-light" id="btnConfirmationModel">Yes</button>
                </div>
            </div>
        </div>
    </div>
    <!--########################### modal box to confirm the PN image to be deleted or not ###############################################-->

    <div id="confirmation-pn-image-delete" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <input type="hidden" id="pn_streamlined_comm_id">
                <div class="modal-header label-warning">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title">Are you sure want to delete this PN image ?</h4>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect" id="close_pn_image_confirm" data-dismiss="modal">No</button>
                    <button type="button" class="btn btn-danger waves-effect waves-light" id="btnPNConfirmationModel">Yes</button>
                </div>
            </div>
        </div>
    </div>
<!--########################### modal content preview ###############################################-->
<div id="content-preview" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content modal-preview">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Content HTML Preview</h4>
            </div>
            <div class="modal-body" style="overflow:scroll;">
                <div class="row" id="preview_div">
                </div>
            </div>
        </div>
    </div>
</div>
<!--########################### modal content preview ###############################################-->
<div id="info-card-preview" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content modal-preview">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" id="infoCardPreviewCloseButton">×</button>
                <h4 class="modal-title">Info Card Preview</h4>
            </div>
            <div class="modal-body" style="overflow:scroll;">
                <div class="row" id="info_card_preview_content">
                    <div class="col-md-12" id="background-type-1" style="display: none;" >
                        <div class="row d-flex align-self-center" style="height: 410px;">

                            <div id="maskot-img" class="col-md-6 col-xs-6 text-center">
                            </div>
                            <div class="col-md-6 col-md-offset-0 col-xs-6 col-xs-offset-0" style="margin-top: 30px;">
                                <h2 id="preview-type-1-title" class="text text-bold"></h2>
                                <p id="preview-type-1-content" class="text"></p>
                                <div id="button-type-1-background">
                                   <h3 id="preview-type-1-button-text" class="text text-bold py-4"></h3>
                                </div>
                            </div>
                        </div>
                </div>
                    <div class="col-md-12" id="background-type-2" style="display: none;" >
                        <div class="row">
                            <div class="col-md-12 col-md-offset-0 px-24 d-flex" style="margin-top: 30px;flex-direction: column; min-height: 410px; justify-content: space-between;">
                                <div>
                                    <h2 id="preview-type-2-title" class="text text-bold"></h2>
                                    <h4 id="preview-type-2-content" class="text"></h4>
                                </div>
                                <div id="button-type-2-background" style="margin-bottom: 30px;">
                                    <h3 id="preview-type-2-button-text" class="text text-bold py-4"></h3>
                                 </div>
                            </div>
                        </div>
                </div>
                    <div class="col-md-12" id="background-type-3" style="display: none;padding-bottom: 4px;" >
                        <div class="row">
                            <div class="col-md-1 col-xs-1" id="icn-img" style="margin-top: 50px;">
                            </div>
                            <div class="col-md-8 col-md-offset-0 col-xs-8 col-xs-offset-0" style="margin-top: 30px;">
                                <table border="0">
                                    <tr>
                                        <td>
                                            <h2 id="preview-type-3-title" class="text text-bold" style="margin-top: 20px;margin-left:20px;max-width: 24ch">
                                            </h2>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h3 id="preview-type-3-content" class="text" style="margin-left:20px;max-width: 35ch">
                                            </h3>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row" style="margin: 30px 0;">
                            <table border="0" style="margin-left: 15px;">
                                <tr>
                                    <td class="col-md-6" id="button-l-type-3-background" valign="middle" style="display: none;text-align: center;">
                                         <h3 id="preview-type-3-button-l-text" class="text text-bold">
                                         </h3>
                                    </td>
                                    <td class="col-md-6" id="button-r-type-3-background" valign="middle" style="display: none;text-align: center;">
                                         <h3 id="preview-type-3-button-r-text" class="text text-bold">
                                         </h3>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" class="col-md-12" id="button-m-type-3-background" valign="middle" style="display: none;text-align: center;">
                                        <h3 id="preview-type-3-button-m-text" class="text text-bold"></h3>
                                    </td>
                                </tr>
                                <tr>
                                    <br>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-12" id="background-type-9" style="display: none;" >
                            <div class="col-md-12 col-md-offset-0 col-xs-12 col-xs-offset-0" style="margin-top: 30px;">
                                <div class="iframe-card">
                                    <div class="responsive-iframe" id="preview-type-9-content">
                                    </div>
                                    <h4 id="preview-type-9-title" class="text text-bold text-center"></h4>
                                </div>
                                <div id="button-type-9-background">
                                   <h3 id="preview-type-9-button-text" class="text text-bold py-4"></h3>
                                </div>
                            </div>
                        </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--########################### modal test robocall ###############################################-->
    <div id="robocall_test_playground" class="modal fade" tabindex="-1"
         role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header label-warning">
                    <button type="button" class="close" data-dismiss="modal"
                            aria-hidden="true">×</button>
                    <h4 class="modal-title">Robocall Test Playground</h4>
                </div>
                <div class="modal-body" >
                    <form id="test_robocall_form" method="post">
                    {% csrf_token %}
                    <div class="row">
                        <div class="col-md-12 col-sm-12 txt-align">
                            <label for="description">Formatted JSON Data:</label>
                        </div>
                        <div class="col-md-12 col-sm-12 txt-align">
                            <pre id="json-display" style="background:#ffffff; color: #000000;"
                                 spellcheck="false"></pre>
                            <span style="font-size:10px" id="json-display_error">
                            </span>
                        </div>
                    </div>
                    <!-- end row -->
                    <div class="row">
                        <div class="col-md-3 col-sm-12 txt-align">
                            <label id="robocall_test_payment_id" for="description">Payment ID:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <input class="form-control allownumeric"
                                id="robocall_test_payment" placeholder="Payment ID"
                                name="robocall_test_payment" maxlength="12" type="text">
                             <span style="font-size:10px">
                                we use real data from customer based on their loan_id
                            </span>
                            <span style="font-size:10px" id="payment_error">
                            </span>
                        </div>
                    </div>
                    <!-- end row -->
                     <!-- end row -->
                    <div class="row">
                        <div class="col-md-3 col-sm-12 txt-align">
                            <label for="description">Call To:</label>
                        </div>
                        <div class="col-md-6 col-sm-12 txt-align">
                            <input class="form-control allownumeric"
                                id="robocall_test_phone" placeholder="Call To"
                                name="robocall_test_phone" maxlength="14" type="text" value="62">
                            <span style="font-size:10px">
                                Phone number format start with 62 (without '+')
                            </span>
                             <span style="font-size:10px" id="test_phone_error">
                            </span>
                        </div>
                    </div>
                    <!-- end row -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect"
                            id="close_test_robocall" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-default" disabled id="save_test_robocall_data">Save</button>
                    <button type="button" class="btn btn-default" disabled id="call_test_robocall">Call Test</button>
                </div>
            </div>
        </div>
    </div>

    <!--########################### modal box to confirm the settings to be deleted or not ###############################################-->
<div id="confirm_delete_widgetduedate" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Do you want to delete this widget due date settings?</h4>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default waves-effect" id="close_confirm_delete" data-dismiss="modal">No</button>
                <button type="button" class="btn btn-danger waves-effect waves-light" id="btnDeleteWidgetduedateConfirmed">Yes</button>
            </div>
        </div>
    </div>
</div>

<!--########################### modal widget due date add/edit ###############################################-->
<div id="add-edit-widgetduedate" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:80vw;height:80vh;">
        <div class="modal-content">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title widgetduedate_form_title">Add New Widget Due Date Settings</h4> </div>
            <div class="modal-body" style="height:80vh !important; position: relative;">
                <div class="sticky-container">
                    <div class="canvas">
                        <div class="widget-base">
                            <div class="widget-top clickable clickable-card-color">
                                <div class="widget-icon-content clickable clickable-inside clickable-icon">
                                    <img src="https://www.julo.co.id/sites/default/files/users/user20/crm-asset/Promo%20-%20promo%20anti%20telat.png" id="widget-icon-content-img" width="28px" height="28px">
                                </div>
                                <div class="clickable clickable-inside flex-only clickable-card-text-color">
                                    <div class="widget-total-tagihan">
                                        <div>Total Tagihan</div>
                                        <div class="widget-total-tagihan-num">Rp2.500.000</div>
                                    </div>
                                    <div class="widget-separator">
                                        <svg width="1" height="32" viewBoiinfo-textnfo-imcardiinfo-textnfo-imcardx="0 0 1 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <line x1="0.5" y1="0.5" x2="0.499999" y2="32.5" stroke="#E0E0E0" stroke-dasharray="2 2"/>
                                            </svg>                                    
                                    </div>
                                    <div class="widget-jatuh-tempo">
                                        <div>Jatuh Tempo <span class="widget-jatuh-tempo-date">25/09/23</span></div>
                                        <div class="widget-jatuh-tempo-days-left">1 hari lagi</div>
                                    </div>    
                                </div>
                                <div class="widget-bayar-button">
                                    Bayar
                                </div>
                            </div>
                            <div class="widget-bot clickable clickable-info-color">
                                <div class="widget-icon-description clickable clickable-inside clickable-icon-desc">
                                    <img src="https://www.julo.co.id/sites/default/files/users/user20/crm-asset/ic-sand-Clock.png" id="widget-icon-desc-img" width="12px" height="12px">
                                </div>
                                <div class="widget-description clickable clickable-inside clickable-info-text-color">
                                    Bayar lebih cepat akan makin untung loh!
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>**Actual in-app display may differ from this preview</div>
                </div>
                <form id="add-edit-widgetduedate_form" method="post" enctype="multipart/form-data">
                <input type="hidden" name="default_active_tab" value="widgetduedate">
                <input type="hidden" name="widgetduedate_id" id="widgetduedate_id" value="">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="widgetduedate_template_code">Template Code:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input type="text" class="form-control" id="widgetduedate_template_code" name="widgetduedate_template_code" placeholder="Template Code">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="widgetduedate_product">Product:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control" id="widgetduedate_product" name="widgetduedate_product">
                        <option value="" selected="selected">Choose One</option>
                        <option value="j1" >J1</option>
                        <option value="jturbo" >JTURBO</option>
                        <option value="mtl" >MTL</option>
                        <option value="stl" >STL</option>
                        <option value="pedemtl" >Pede MTL</option>
                        <option value="pedestl">Pede STL</option>
                        <option value="laku6">LAKU6</option>
                        <option value="bukalapak">Bukalapak Bayarnanti</option>
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="widgetduedate_description">Description*:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input type="text" class="form-control form-control-optional" id="widgetduedate_description" name="widgetduedate_description" placeholder="Description">
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Widget Colors</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align" style="align-items: center;">
                        <div class="flex-only" style="justify-content: space-around;">
                            <div>Card Color</div>
                            <div>Info Color*</div>
                            <div>Card Text Color</div>
                            <div>Info Text Color*</div>
                        </div>
                        <div class="flex-only">
                            <input type="color" class="color-picker" id="widgetduedate-card-color-input" style="width: 130px;">
                            <input type="text" class="form-control m-r-10 color-picker-text" id="widgetduedate-card-color" name="widgetduedate-card-color" placeholder="Card Color">
                            <input type="color" class="color-picker" id="widgetduedate-info-color-input" style="width: 130px;">
                            <input type="text" class="form-control form-control-optional m-r-10 color-picker-text" id="widgetduedate-info-color" name="widgetduedate-info-color" placeholder="Info Color">
                            <input type="color" class="color-picker" id="widgetduedate-card-text-color-input" style="width: 130px;">
                            <input type="text" class="form-control m-r-10 color-picker-text" id="widgetduedate-card-text-color" name="widgetduedate-card-text-color" placeholder="Card Text Color">
                            <input type="color" class="color-picker" id="widgetduedate-info-text-color-input" style="width: 130px;">
                            <input type="text" class="form-control form-control-optional m-r-10 color-picker-text" id="widgetduedate-info-text-color" name="widgetduedate-info-text-color" placeholder="Info Text Color">
                        </div>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="icon-content">Icon Content:</label>
                    </div>
                    <div type="hidden" id="widgetduedate_image_status" name="widgetduedate_image_status"></div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control-image" id="widgetduedate_image"
                              name="widgetduedate_image" type="file"/>
                        <input type="hidden" name="is_widgetduedate_image_changes" id="is_widgetduedate_image_changes" value="false">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="icon-description">Icon Description*:</label>
                    </div>
                    <div type="hidden" id="widgetduedate_image_desc_status" name="widgetduedate_image_desc_status"></div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input class="form-control-image form-control-optional" id="widgetduedate_image_desc"
                              name="widgetduedate_image_desc" type="file"/>
                        <input type="hidden" name="is_widgetduedate_image_desc_changes" id="is_widgetduedate_image_desc_changes" value="false">
                    </div>
                </div>
                <div>*Optional field</div>
                <!-- end row -->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default waves-effect" id="close_widgetduedate_form" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" id="save_widgetduedate_template">Save</button>
            </div>
        </div>
    </div>
</div>
<!--########################### modal slik notification add/edit ###############################################-->
<div id="add-edit-sliknotification" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:80vw;height:80vh;">
        <div class="modal-content">
            <div class="modal-header label-warning">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title sliknotification_form_title">Add New Tagihan Banner Settings</h4> </div>
            <div class="modal-body" style="height:80vh !important; position: relative;">
                <div class="sticky-container">
                    <div class="canvas">
                      <div class="widget-base">
                          <div class="widget-bot clickable clickable-card-color">
                              <div class="widget-icon-description clickable clickable-inside clickable-icon-desc">
                                  <img src="https://www.julo.co.id/sites/default/files/newsletter/ic-information-circle_0.png" id="slik-icon-content-img" width="12px" height="12px">
                              </div>
                              <div class="widget-description clickable clickable-inside clickable-info-text-color">
                                  Yuk, bayar biar cashback beruntun gak hilang!
                              </div>
                          </div>
                      </div>
                    </div>
                    <div>**Actual in-app display may differ from this preview</div>
                </div>
                <form id="add-edit-sliknotification_form" method="post" enctype="multipart/form-data">
                <input type="hidden" name="default_active_tab" value="sliknotification">
                <input type="hidden" name="sliknotification_id" id="sliknotification_id" value="">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="sliknotification_template_code">Template Code:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input type="text" class="form-control" id="sliknotification_template_code" name="sliknotification_template_code" placeholder="Template Code">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                        <label for="sliknotification_product">Product:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                       <select class="form-control" id="sliknotification_product" name="sliknotification_product">
                        <option value="" selected="selected">Choose One</option>
                        <option value="j1" >J1</option>
                        <option value="jturbo" >JTURBO</option>
                        <option value="mtl" >MTL</option>
                        <option value="stl" >STL</option>
                        <option value="pedemtl" >Pede MTL</option>
                        <option value="pedestl">Pede STL</option>
                        <option value="laku6">LAKU6</option>
                        <option value="bukalapak">Bukalapak Bayarnanti</option>
                      </select>
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="sliknotification_description">Description*:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input type="text" class="form-control form-control-optional" id="sliknotification_description" name="sliknotification_description" placeholder="Description">
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="sliknotification_url">Redirect URL*:</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align">
                        <input type="text" class="form-control form-control-optional" id="sliknotification_url" name="sliknotification_url" placeholder="sliknotification_url">
                    </div>
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-md-4 col-sm-12 txt-align">
                       <label for="description">Widget Colors</label>
                    </div>
                    <div class="col-md-6 col-sm-12 txt-align" style="align-items: center;">
                        <div class="flex-only" style="justify-content: space-around;">
                            <div>Card Color</div>
                            <div>Info Text Color*</div>
                        </div>
                        <div class="flex-only">
                            <input type="color" class="color-picker" id="sliknotification-card-color-input" style="width: 130px;">
                            <input type="text" class="form-control m-r-10 color-picker-text" id="sliknotification-card-color" name="sliknotification-card-color" placeholder="Card Color">
                            <input type="color" class="color-picker" id="sliknotification-info-text-color-input" style="width: 130px;">
                            <input type="text" class="form-control form-control-optional m-r-10 color-picker-text" id="sliknotification-info-text-color" name="sliknotification-info-text-color" placeholder="Info Text Color">
                        </div>
                    </div>
                </div>
                
                <div>*Optional field</div>
                <!-- end row -->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default waves-effect" id="close_sliknotification_form" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" id="save_sliknotification_template">Save</button>
            </div>
        </div>
    </div>
</div>
<!--########################### modal SLIK box to confirm the settings to be deleted or not ###############################################-->
    <div id="confirm_delete_sliknotification" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header label-warning">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title">Do you want to delete this SLIK Notification settings?</h4>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default waves-effect" id="slik_close_confirm_delete" data-dismiss="modal">No</button>
                    <button type="button" class="btn btn-danger waves-effect waves-light" id="btnDeletesliknotificationConfirmed">Yes</button>
                </div>
            </div>
        </div>
    </div>
    
{% endblock %}
{% block custom_link %}
<link href="{% static 'theme/plugins/bower_components/multiselect/css/multi-select.css' %}"  rel="stylesheet" type="text/css" />
<link href="{% static 'theme/plugins/bower_components/toast-master/css/jquery.toast.css' %}" rel="stylesheet">
<link href="{% static 'theme/plugins/bower_components/sweetalert/sweetalert.css' %}" rel="stylesheet" type="text/css">
{% endblock %}
{% block script_additional %}
<script src="{% static 'theme/plugins/bower_components/toast-master/js/jquery.toast.js' %}"></script>
<script type="text/javascript" src="{% static 'theme/plugins/bower_components/multiselect/js/jquery.multi-select.js' %}"></script>
<script src="{% static 'default/js/jquery.json-editor.min.js' %}" ></script>
<!-- Sweet-Alert  -->
<script src="{% static 'theme/plugins/bower_components/sweetalert/sweetalert.min.js' %}"></script>
<script src="{% static 'theme/plugins/bower_components/sweetalert/jquery.sweet-alert.custom.js' %}"></script>
{% endblock %}
<script>

{#</script>#}
{#komen script#}
{% block script_bottom_inside %}

    jQuery.fn.addHidden = function (name, value) {
        return this.each(function () {
            var input = $("<input>").attr("type", "hidden").attr("name", name).val(value);
            $(this).append($(input));
        });
    };
    function filter_function_list(value, selector) {
        $(selector + " option").prop("hidden", false);
        $(selector + " option").attr("selected", null);
        if ($('#robocall_product').val() == "nexmo_j1" || $('#robocall_product').val() == "nexmo_dana" || $('#robocall_product').val() == "nexmo_turbo") {
            $(".robocall-function-list option").not("[data-product=nexmo_j1]").prop("hidden", true);
            $("#test_robocall_template").show();
        } else if($('#robocall_product').val() == "nexmo_grab") {
            $(".robocall-function-list option").not("[data-product=nexmo_grab]").prop("hidden", true);
            $("#test_robocall_template").hide();
        } else {
            $(".robocall-function-list option[data-product=nexmo_j1]").attr("hidden", true);
            $(".robocall-function-list option[data-product=nexmo_grab]").attr("hidden", true);
            $("#test_robocall_template").show();
        }
        if (value == "") {
            value = $(selector + " option").not("[hidden]").eq(0).val();
        }
        $(selector + ' option[value="'+value+'"]').attr("selected", "selected");
    }
    $(document).ready(function () {

        function clean_array(array) {
            return array.filter(function (el) {
                return el != null && el != "";
            })
        }

        function delete_specific_value_array(array, removeItem) {
            return jQuery.grep(array, function (value) {
                return value != removeItem;
            });
        }

        function validate(active_tab) {
            validate_status = true
            if ($('#deleted_message_id_'+active_tab).val().length > 0 ){
                return true
            }
            if ($('#form-' + active_tab + ' textarea').size() == 0) {
                alert('tidak ada data untuk di simpan')
                return false
            }
            $('#form-' + active_tab + ' textarea').each(function () {
                if ($(this).val() == '') {
                    $(this).parent().addClass('has-error')
                    validate_status = false
                }
            })
            return validate_status
        }

        function validate_function(active_tab) {
            validate_status = true
            if ($('#deleted_message_id_'+active_tab).val().length > 0 ){
                return true
            }
            if ($('#form-' + active_tab + ' textarea').size() == 0) {
                alert('tidak ada data untuk di simpan')
                return false
            }
            $('#form-' + active_tab + ' textarea').each(function () {
                if ($(this).val() == '') {
                    $(this).parent().addClass('has-error')
                    validate_status = false
                }
            })
            $('#form-' + active_tab + ' input[type="text"]').each(function () {
                if ($(this).val() == '') {
                    $(this).parent().addClass('has-error')
                    validate_status = false
                }
            })
            $('#form-' + active_tab + ' select').each(function () {
                if ($(this).val() == '') {
                    $(this).parent().addClass('has-error')
                    validate_status = false
                }
            })
            return validate_status
        }

        function check_empty(active_tab) {
            if ($('#form-' + active_tab + ' textarea').size() == 0) {
                $('#form-' + active_tab).append(
                    '<div class="alert alert-info empty-info">\n' +
                    '                                <strong>Info!</strong> Tidak ada Data.\n' +
                    '                            </div>'
                )
            } else {
                $('#form-' + active_tab + ' .empty-info').remove()
            }
        }

        next_new_id = 0
        item_template = '<div class="row new-message-{active_tab}" id="list-new-{new_id}">\n' +
            '                            <div class="col-md-5">\n' +
            '                                <div class="form-group">\n' +
            '                                    <input type="text" class="form-control input-sm no-border" name="status-new-{new_id}" placeholder="Status" value="Status">\n' +
            '                                    <textarea class="form-control" name="message-new-{new_id}"\n' +
            '                                              placeholder="message" required></textarea>\n' +
            '                                </div>\n' +
            '                            </div>\n' +
            '                            <div class="col-md-5">\n' +
            '                                <div class="form-group">\n' +
            '                                    <label for="description">Description</label>\n' +
            '                                    <textarea class="form-control" name="description-new-{new_id}"\n' +
            '                                              placeholder="description" required></textarea>\n' +
            '                                </div>\n' +
            '                            </div>\n' +
            '                            <div class="col-md-2">\n' +
            '                                <br/>\n' +
            '                                <button type="button" class="btn btn-danger btnDeleteNew" system-id="new-{new_id}">-\n' +
            '                                </button>\n' +
            '                            </div>\n' +
            '                        </div>'

            function_template = '<div class="row new-message-{active_tab}" id="list-new-{new_id}">\n' +
            '                            <div class="col-md-3">\n' +
            '                                <div class="form-group">\n' +
            '                                    <label for="description">Function</label>\n' +
            '                                    <input type="text" maxlength="250" class="form-control" name="function-new-{new_id}"\n' +
            '                                              placeholder="message" required>\n' +
            '                                </div>\n' +
            '                            </div>\n';
            function_template+= '        <div class="col-md-3">\n' +
            '                                <div class="form-group">\n' +
            '                                    <label for="description">Platform</label>\n' +
            '                                    <select class="form-control" name="platform-function-new-{new_id}">\n' +
            '                                    <option value="" selected="selected">Choose One</option>\n';
            {% for key, value in communicationPlatforms %}
                {% if key == item.communication_platform %}
                     function_template+= '       <option value="{{ key }}" selected>{{ value }}</option>\n';
                {% else %}
                     function_template+= '       <option value="{{ key }}">{{ value }}</option>\n';
                {% endif %}
            {% endfor %}

            function_template+='                 </select>\n'+
            '                                </div>\n' +
            '                              </div>\n';
            function_template+='<div class="col-md-3">\n' +
            '                                <div class="form-group">\n' +
            '                                    <label for="description">Description</label>\n' +
            '                                    <textarea class="form-control" name="description-function-new-{new_id}"\n' +
            '                                              placeholder="description" required></textarea>\n' +
            '                                </div>\n' +
            '                            </div>\n' +
            '                            <div class="col-md-2">\n' +
            '                                <br/>\n' +
            '                                <button type="button" class="btn btn-danger btnDeleteNew" system-id="new-{new_id}">-\n' +
            '                                </button>\n' +
            '                            </div>\n' +
            '                        </div>';
        function delete_content(streamlined_communication_id) {
            active_tab = $('#activeTab').val()
            $('#list-' + streamlined_communication_id).remove()
            return active_tab
        }

        $('.submit_trigger').on('change', function (e) {
            status_code = $('#status_code').val()
            dpd = $('#status_dpd').val()
            dpd_lower = $('#status_dpd_lower').val()
            dpd_upper = $('#status_dpd_upper').val()
            until_paid = $('#until_paid').val()
            ptp = $('#status_ptp').val()
            extra_condition = $('#extra_condition').val()
            if (status_code.length > 0 || dpd.length > 0 || ptp.length > 0 || dpd_upper.length > 0 || dpd_lower.length > 0 || until_paid.length > 0 || extra_condition.length > 0) {
                $('#form-status').submit()
            }
        })
        var update_msg_ids = '';
        var params_id = 0;
        var robocall_call_time = '';
        var robocall_call_function = '';
        var call_hr_count = 0;
        var email_parameters_list;
        var partners_selection_list;
        var partners_selection_action = null
        var sms_parameters_list;
        var robocall_parameters_list;
        var is_new_page_partner = 0;
        var is_new_page_email = 0;
        var is_new_page_sms = 0;
        var is_new_page_robocall = 0;
        var is_new_page_pn = 0;
        var is_new_page_info_card = 0;
        var is_new_page_parameterlist = 0;
        $('.btnTab').click(function (e) {
            active_tab = $(this).attr('tab').toLowerCase();
            $('#activeTab').val(active_tab);
            $('#default_active_tab').val(active_tab);
            $('#default_active_tab_filter').val(active_tab);
            if (active_tab == 'info_card' || active_tab == 'robocall'){
                $('#extra_condition_div').show()
            }else{
                $('#extra_condition_div').hide()
            }
            if (active_tab === 'email' || active_tab === 'pn') {
                $('#email_pn_category_div').show()
            } else {
                $('#email_pn_category_div').hide()
            }
            update_msg_ids = ''
        })
        if ('{{ default_active_tab }}'){
            if ('{{ default_active_tab }}' == 'info_card' || '{{ default_active_tab }}' == 'robocall'){
                $('#extra_condition_div').show()
            }else{
                $('#extra_condition_div').hide()
            }

            if ('{{ default_active_tab }}' === 'email' || '{{ default_active_tab }}' === 'pn'){
                $('#email_pn_category_div').show()
            }else{
                $('#email_pn_category_div').hide()
            }
        }
        $('#form-ian,#form-wa,#form-functionlist').on('click', '.btnDeleteNew', function (e) {
            streamlined_communication_id = $(this).attr('system-id')
            active_tab = delete_content(streamlined_communication_id)
            new_ids = clean_array($('#new_message_id_' + active_tab).val().split(','))
            after_deleted_ids = delete_specific_value_array(new_ids, streamlined_communication_id)
            $('#new_message_id_' + active_tab).val(after_deleted_ids)
            check_empty(active_tab)
        })
        $('#form-ian,#form-wa,#form-functionlist').on('click', '.btnDelete', function (e) {
            streamlined_communication_id = $(this).attr('system-id')
            active_tab = delete_content(streamlined_communication_id)
            edited_ids = clean_array($('#updated_message_id_' + active_tab).val().split(','))
            after_deleted_edited_ids = delete_specific_value_array(edited_ids, streamlined_communication_id)
            current_delete_ids = clean_array($('#deleted_message_id_' + active_tab).val().split(','))
            current_delete_ids.push(streamlined_communication_id)
            $('#updated_message_id_' + active_tab).val(after_deleted_edited_ids)
            $('#deleted_message_id_' + active_tab).val(current_delete_ids)
            check_empty(active_tab)
        })
        $('.btnDeleteMsg').click(function (e) {
            streamlined_communication_id = $(this).attr('system-id')
            active_tab = $('#activeTab').val()
            $('#delete_msg_id_' + active_tab).val(streamlined_communication_id)
            $('#confirm_delete_msg').modal('show');
        })
        $('#btn_sms_preview').click(function (e) {
            $('#add-edit-sms').modal('hide');
            $('#modalTestSMS').modal('show');
        })
        $('#btnDeleteMsgConfirmed').click(function (e) {
           active_tab = $('#activeTab').val()
           $('#form-' + active_tab).addHidden('active_tab', active_tab).submit()
        })
        $('#platform').change(function (e) {
            if($('#platform').val() == '') {
                $('.platform_type_all').show();
            } else {
                var platform_type = $('#platform').val();
                $('.platform_type_all').hide();
                $('.platform_type_'+platform_type).show();
            }
        })
        $('.btnEditEmail').click(function (e) {
            streamlined_communication_id = $(this).attr('system-id');
            is_new_page_email= 1;
            is_new_page_partner= 1;
            $('#email_parameters').multiSelect('deselect_all');
            $('.partners_selection').multiSelect('deselect_all');
            var str = $.trim($('#email_parameter-'+streamlined_communication_id).text()).replace('{','').replace('}','').split(",")
            new_str = [];
            for(i = 0; i < str.length; i++) {
                new_str[i]= str[i].trim();
            }
            var selected_partners_email = $('#selected_partners_email-'+streamlined_communication_id)
            var partner_str = $.trim(selected_partners_email.text()).replace('{','').replace('}','').replaceAll(' ', '').split(",")
            new_partner_str = [];
            if (partner_str.length > 0 && partner_str[0] != '') {
            for(i = 0; i < partner_str.length; i++) {
                new_partner_str[i] = $('#partner_ele_em' + partner_str[i]).val()
            }
            }
            $('#email_parameters').multiSelect('select', new_str);
            if(new_partner_str != undefined){
                $('#partners_selection_email').multiSelect('select', new_partner_str);
            }
            $('#email_content').val($('#email_message-'+streamlined_communication_id).val());
            $('#email_subject').val($('#email_subject-'+streamlined_communication_id).val());
            $('#email_pre_header').val($('#email_pre_header-'+streamlined_communication_id).val());
            $('#email_template_code').val($('#email_template_code-'+streamlined_communication_id).val());

            email_category = $.trim($('#email_type-' + streamlined_communication_id).attr('em_category'))
            document.getElementById('email_category').value = email_category
            if (email_category === 'backup') {
                $('#email_moengage_template_code').val($('#moengage_template_code-' + streamlined_communication_id).val());
                $('.email_moengage_template_code_div').show();
            } else {
                $('#email_moengage_template_code').val('');
                $('.email_moengage_template_code_div').hide();
            }

            $('#email_description').val($('#email_description-'+streamlined_communication_id).val());
            var existing_status_julo_gold = $('#email_julo_gold_status-'+streamlined_communication_id).val()
            $(`#email_julo_gold_status_${existing_status_julo_gold}`).prop('checked', true)


            $('#email_msg_id').val(streamlined_communication_id);
            $('.email_form_title').text('Edit Existing Auto Email');
            product = $.trim($('#email_type-'+streamlined_communication_id).attr('em_product'))
            $('#email_product option[value="'+product+'"]').attr("selected", "selected");
            type = $.trim($('#email_type-'+streamlined_communication_id).attr('em_type'))
            $('#email_type option[value="'+type+'"]').attr("selected", "selected");
            time = $.trim($('#email_time_sent-'+streamlined_communication_id).text()).split(":")
            $('#email_hour option[value="'+time[0]+'"]').attr("selected", "selected");
            $('#email_minute option[value="'+time[1]+'"]').attr("selected", "selected");
            if ($('#email_product').val() == 'j1' || $('#email_product').val() == 'jturbo'){
                $('.partners_selection_div').show();
            }
            else{
                $('.partners_selection_div').hide();
            }
            $('#add-edit-email').modal('show');
        })

        $('#email_category').on('change', function () {
            if (this.value === 'backup') {
                $('.email_moengage_template_code_div').show();
            } else {
                $('.email_moengage_template_code_div').hide();
            }
        });

        $('.product_selector').on('change', function() {
            if (['j1', 'jturbo', 'nexmo_j1', 'partners-only'].includes(this.value)){
                if (['j1', 'jturbo'].includes(this.value)) {
                    $('.partner_selection_div_label').html('Exclude Partner(s)')
                }
                else if(this.value == 'partners-only'){
                    $('.partner_selection_div_label').html('Include Partner(s)')
                }
                $('.partners_selection_div').show();
            }
            else{
                $('.partners_selection_div').hide();
            }
            });

        $('.select-all-partner').click(function (e) {
            val = $('.select-all-partner').val()
            if (val == 'select'){
                $('.partners_selection').multiSelect('select_all');
                $('.select-all-partner').val('deselect')
                $('.select-all-partner').html('deselect all')
            }
            else if(val == 'deselect'){
                $('.partners_selection').multiSelect('deselect_all');
                $('.select-all-partner').val('select')
                $('.select-all-partner').html('select all')
            }
        })
        $('.btnEditSMS').click(function (e) {
            streamlined_communication_id = $(this).attr('system-id');
            is_new_page_sms= 1;
            $('#sms_parameters').multiSelect('deselect_all');
            $('.partners_selection').multiSelect('deselect_all');
            var str = $.trim($('#sms_parameter-'+streamlined_communication_id).text()).replace('{','').replace('}','').split(",")
            new_str = [];
            for(i = 0; i < str.length; i++) {
                new_str[i]= str[i].trim();
            }
            var selected_partners_sms = $('#selected_partners_sms-'+streamlined_communication_id)
            var partner_str = $.trim(selected_partners_sms.text()).replace('{','').replace('}','').replaceAll(' ', '').split(",")
            new_partner_str = [];
            if (partner_str.length > 0 && partner_str[0] != '') {
            for(i = 0; i < partner_str.length; i++) {
                new_partner_str[i] = $('#partner_ele_sms' + partner_str[i]).val()
            }
            }
            $('#sms_parameters').multiSelect('select', new_str);
            if(new_partner_str != undefined){
                $('#partners_selection_sms').multiSelect('select', new_partner_str);
            }
            $('#sms_content').val($('#sms_message-'+streamlined_communication_id).val());
            $('#sms_template_code').val($('#sms_template_code-'+streamlined_communication_id).val());
            $('#sms_description').val($('#sms_description-'+streamlined_communication_id).val());
            var existing_status_julo_gold = $('#sms_julo_gold_status-'+streamlined_communication_id).val()
            $(`#sms_julo_gold_status_${existing_status_julo_gold}`).prop('checked', true)

            $('#sms_msg_id').val(streamlined_communication_id);
            $('.sms_form_title').text('Edit Existing Auto SMS');
            product = $.trim($('#sms_type-'+streamlined_communication_id).attr('sm_product'))
            $('#sms_product option[value="'+product+'"]').attr("selected", "selected");
            type = $.trim($('#sms_type-'+streamlined_communication_id).attr('sm_type'))
            $('#sms_type option[value="'+type+'"]').attr("selected", "selected");
            time = $.trim($('#sms_time_sent-'+streamlined_communication_id).text()).split(":")
            $('#sms_hour option[value="'+time[0]+'"]').attr("selected", "selected");
            $('#sms_minute option[value="'+time[1]+'"]').attr("selected", "selected");
            $('#add-edit-sms').modal('show');
            if (['j1', 'jturbo'].includes($('#sms_product').val())){
                $('.partners_selection_div').show();
            }
            else{
                $('.partners_selection_div').hide();
            }
        })

        $('#pn_category').on('change', function () {
            if (this.value === 'backup') {
                $('.pn_moengage_template_code_div').show();
            } else {
                $('.pn_moengage_template_code_div').hide();
            }
        });

        $('.btnEditPN').click(function (e) {
            streamlined_communication_id = $(this).attr('system-id');
            is_new_page_pn= 1;
            $('#pn_parameters').multiSelect('deselect_all');
            var str = $.trim($('#pn_parameter-'+streamlined_communication_id).text()).replace('{','').replace('}','').split(",")
            new_str = [];
            for(i = 0; i < str.length; i++) {
                new_str[i]= str[i].trim();
            }
            console.log(new_str)
            $('#pn_parameters').multiSelect('select', new_str);
            $('#pn_subject').val($('#pn_subject-'+streamlined_communication_id).val());
            $('#pn_content').val($('#pn_message-'+streamlined_communication_id).val());
            $('#pn_template_code').val($('#pn_template_code-'+streamlined_communication_id).val());

            pn_category = $.trim($('#pn_type-' + streamlined_communication_id).attr('pn_category'))
            document.getElementById('pn_category').value = pn_category
            if (pn_category === 'backup') {
                $('#pn_moengage_template_code').val($('#moengage_template_code-' + streamlined_communication_id).val());
                $('.pn_moengage_template_code_div').show();
            } else {
                $('#pn_moengage_template_code').val('');
                $('.pn_moengage_template_code_div').hide();
            }

            $('#pn_description').val($('#pn_description-'+streamlined_communication_id).val());
            $('#pn_heading').val($('#pn_heading-'+streamlined_communication_id).val());
            $('#pn_msg_id').val(streamlined_communication_id);
            if ($('#pn_image-'+streamlined_communication_id).val()!='None'){
                $('#btn_image_link_pn_image').attr('src', $('#pn_image-' + streamlined_communication_id).val());
                $('#btn_image_link_pn_image').attr('data-is-added', false);
                $('#pn_image_preview_div').show()
                $('#pn_image').val("");
            }
            else {
                $('#pn_image').val("");
                $('#pn_image_preview_div').hide();
            }

            $('.pn_form_title').text('Edit Existing Auto PN');

            pn_category = $.trim($('#pn_type-' + streamlined_communication_id).attr('pn_category'))
            document.getElementById('email_category').value = pn_category
            if (pn_category === 'backup') {
                $('#pn_moengage_template_code').val($('#moengage_template_code-' + streamlined_communication_id).val());
                $('.pn_moengage_template_code_div').show();
            } else {
                $('#pn_moengage_template_code').val('');
                $('.pn_moengage_template_code_div').hide();
            }

            product = $.trim($('#pn_type-'+streamlined_communication_id).attr('pn_product'))
            $('#pn_product option[value="'+product+'"]').attr("selected", "selected");
            type = $.trim($('#pn_type-'+streamlined_communication_id).attr('pn_type'))
            $('#pn_type option[value="'+type+'"]').attr("selected", "selected");
            time = $.trim($('#pn_time_sent-'+streamlined_communication_id).text()).split(":")
            $('#pn_hour option[value="'+time[0]+'"]').attr("selected", "selected");
            $('#pn_minute option[value="'+time[1]+'"]').attr("selected", "selected");
            $('#add-edit-pn').modal('show');
        })
        $('.btnEditWidgetduedate').click(function (e) {
            streamlined_communication_id = $(this).attr('system-id');
            is_new_page_widgetduedate= 1;

            // update form
            $('#widgetduedate_template_code').val($('#widget-template-code-'+streamlined_communication_id).val());
            $('#widgetduedate_product').val($('#widgetduedate_product-'+streamlined_communication_id).attr('widget-product')).trigger('change');
            $('#widgetduedate_description').val($('#widget-desc-'+streamlined_communication_id).val());

            const widgetCardColor= $('#widget-card-color-'+streamlined_communication_id).text().replace(/\s/g, '')
            const widgetInfoColor= $('#widget-info-color-'+streamlined_communication_id).text().replace(/\s/g, '')
            const widgetCardTextColor= $('#widget-card-text-color-'+streamlined_communication_id).text().replace(/\s/g, '')
            const widgetInfoTextColor= $('#widget-info-text-color-'+streamlined_communication_id).text().replace(/\s/g, '')

            $('#widgetduedate-card-color').val(widgetCardColor);
            $('#widgetduedate-info-color').val(widgetInfoColor);
            $('#widgetduedate-card-text-color').val(widgetCardTextColor);
            $('#widgetduedate-info-text-color').val(widgetInfoTextColor);
            // colorpicker
            $('#widgetduedate-card-color-input').val(widgetCardColor);
            $('#widgetduedate-info-color-input').val(widgetInfoColor);
            $('#widgetduedate-card-text-color-input').val(widgetCardTextColor);
            $('#widgetduedate-info-text-color-input').val(widgetInfoTextColor);
            // image
            $('#widget-icon-content-img').attr('src', $('#widget-icon-content-img-url-'+streamlined_communication_id).val());
            $('#widget-icon-desc-img').attr('src', $('#widget-icon-desc-img-url-'+streamlined_communication_id).val());
            $('#widgetduedate_image_status').val('loaded')
            $('#widgetduedate_image_desc_status').val('loaded')

            // update preview
            changeBackgroundColor('clickable-card-color', widgetCardColor, 'card')
            changeBackgroundColor('clickable-info-color', widgetInfoColor, 'card')
            changeBackgroundColor('clickable-card-text-color', widgetCardTextColor, 'text')
            changeBackgroundColor('clickable-info-text-color', widgetInfoTextColor, 'text')
            $('.clickable-info-text-color').text($('#widget-desc-'+streamlined_communication_id).val())

            $('#widgetduedate_id').val(streamlined_communication_id);
            $('.widgetduedate_form_title').text('Edit Existing Widget Due Date');
            $('#add-edit-widgetduedate').modal('show');
        })
        $('.btnEditSlikNotification').click(function (e) {
            streamlined_communication_id = $(this).attr('system-id');
            is_new_page_sliknotification= 1;

            // update form
            $('#sliknotification_template_code').val($('#slik-template-code-'+streamlined_communication_id).val());
            $('#sliknotification_product').val($('#sliknotification_product-'+streamlined_communication_id).attr('slik-product')).trigger('change');
            $('#sliknotification_description').val($('#slik-desc-'+streamlined_communication_id).val());
            $('#sliknotification_url').val($('#slik-url-'+streamlined_communication_id).val());

            const slikCardColor= $('#slik-card-color-'+streamlined_communication_id).text().replace(/\s/g, '')
            const slikInfoTextColor= $('#slik-info-text-color-'+streamlined_communication_id).text().replace(/\s/g, '')

            $('#sliknotification-card-color').val(slikCardColor);
            $('#sliknotification-info-text-color').val(slikInfoTextColor);
            // colorpicker
            $('#sliknotification-card-color-input').val(slikCardColor);
            $('#sliknotification-info-text-color-input').val(slikInfoTextColor);
            // image
            $('#slik-icon-content-img').attr('src', $('#slik-icon-content-img-url-'+streamlined_communication_id).val());
            $('#sliknotification_image_status').val('loaded')

            // update preview
            changeBackgroundColor('clickable-card-color', slikCardColor, 'card')
            changeBackgroundColor('clickable-info-text-color', slikInfoTextColor, 'text')
            $('.clickable-info-text-color').text($('#slik-desc-'+streamlined_communication_id).val())

            $('#sliknotification_id').val(streamlined_communication_id);
            $('.sliknotification_form_title').text('Edit Existing Tagihan Banner Settings');
            $('#add-edit-sliknotification').modal('show');
        })
        $('.btnEditRobocall').click(function (e) {
            call_hr_count = 0;
            is_new_page_robocall = 1;
            streamlined_communication_id = $(this).attr('system-id');
            $('#robocall_parameters').multiSelect('deselect_all');
            var str = $.trim($('#robocall_parameter-'+streamlined_communication_id).text()).replace('{','').replace('}','').split(",")
            new_str = [];
            for(i = 0; i < str.length; i++) {
                new_str[i]= str[i].trim();
            }
            var selected_partners_robocall = $('#selected_partners_robocall-'+streamlined_communication_id)
            var partner_str = $.trim(selected_partners_robocall.text()).replace('{','').replace('}','').replaceAll(' ', '').split(",")
            new_partner_str = [];
            if (partner_str.length > 0 && partner_str[0] != '') {
            for(i = 0; i < partner_str.length; i++) {
                new_partner_str[i] = $('#partner_ele_robocall' + partner_str[i]).val()
            }
            }
            $("select#voice_message").val("").trigger("change");
            if(new_partner_str != undefined){
                $('#partners_selection_robocall').multiSelect('select', new_partner_str);
            }
            $('#robocall_parameters').multiSelect('select', new_str);
            $('#robocall_content').val($('#robocall_message-'+streamlined_communication_id).val());
            $('#robocall_time_out_duration').val($('#robocall_time_out_duration-'+streamlined_communication_id).val());
            $('#robocall_template_code').val($('#robocall_template_code-'+streamlined_communication_id).val());
            product = $.trim($('#robocall_type-'+streamlined_communication_id).attr('rb_product'))
            // $('#robocall_product option[value="'+product+'"]').attr("selected", "selected");
            $('#robocall_product').val(product).change();
            type = $.trim($('#robocall_type-'+streamlined_communication_id).attr('rb_type'))
            $('#robocall_type option[value="'+type+'"]').attr("selected", "selected");
            $('#robocall_attempts').val($('#robocall_attempts-'+streamlined_communication_id).val());
            $('#robocall_description').val($('#robocall_description-'+streamlined_communication_id).val());
            $('#robocall_msg_id').val(streamlined_communication_id);
            $('.robocall_form_title').text('Edit Existing Auto Robocall');
            $('#robocall_exclude_risky').prop('checked', $('#robocall_exclude_risky-'+streamlined_communication_id).is(":checked"));
            $('#robocall_segment').val($.trim($('#robocall_segment-'+streamlined_communication_id).val()));
            var existing_status_julo_gold = $('#robocall_julo_gold_status-'+streamlined_communication_id).val()
            $(`#robocall_julo_gold_status_${existing_status_julo_gold}`).prop('checked', true)
            var select_options_hr = ''
            var select_options_min = ''
            {% for i in hrOption %}
            select_options_hr+= '<option value="{{ i }}">{{ i}}</option>'
            {% endfor %}
            {% for i in minOption %}
            select_options_min+= '<option value="{{ i }}">{{ i}}</option>'
            {% endfor %}
            params_ids = 0
            call_hrs = $('#robocall_call_hr-'+streamlined_communication_id).attr('call_hrs')
            function_names = $('#robocall_function-'+streamlined_communication_id).attr('fun_name')
            call_hr = call_hrs.split(",")
            function_name = function_names.split(",")
            function_template = '';
            {% for item in listRobocallFunction %}
                function_template+= '<option value="{{ item.function_name }}" data-product="{{ item.product|default:"-" }}">{{ item.function_name }}</option>\n';
            {% endfor %}
            $("div").remove(".add_more_params");
            for (i = 0; i < call_hr.length; i++)
            {
                time = call_hr[i].split(":")
                params_template = '<div id="row_'+params_ids+'" class="add_more_params">' +
                         '<div>' +
                         '<div class="col-md-12 col-sm-12 txt-align">'+
                         '<label for="description">Function to Execute</label>' +
                         '<select class="form-control robocall-function-list" id="robocall_function_'+params_ids+'">' + function_template +
                         '</select>' +
                         '</div>' +
                         '</div>' +
                         '<div>' +
                         '<div class="col-md-5 col-sm-12 txt-align">' +
                         '<label for="description">Hour</label>' +
                         '<select class="form-control" id="robocall_hour_'+params_ids+'">' + select_options_hr +
                         '</select>' +
                         '</div>' +
                         '<div class="col-md-5 col-sm-12 txt-align">' +
                         '<label for="description">Minute</label>' +
                         '<select class="form-control" id="robocall_minute_'+params_ids+'">' + select_options_min +
                         '</select>' +
                         '</div>' +
                         '<div class="col-md-1 col-sm-12 txt-align">' +
                         '<label for="description">&nbsp;</label>' +
                         '<button type="button" class="btn btn-danger remove_parameters"' +
                         'id="remove_param_'+params_ids+'" ind="'+params_ids+'">-' +
                         '</button>' +
                         '</div>' +
                         '</div></div>';
                $('.more_params:last').after(params_template);
                $('#robocall_hour_'+params_ids+' option[value="'+time[0]+'"]').attr("selected", "selected");
                // $('#robocall_function_'+params_ids+' option[value="'+function_name[i]+'"]').attr("selected", "selected");
                filter_function_list(function_name[i], '#robocall_function_'+params_ids);
                if (time.length > 1)
                    $('#robocall_minute_'+params_ids+' option[value="'+time[1]+'"]').attr("selected", "selected");
                params_ids++;
            }
            params_id = params_ids
            $('#add-edit-robocall').modal('show');
            if ($('#robocall_product').val() == 'nexmo_j1'){
                $('.partners_selection_div').show();
            }
            else{
                $('.partners_selection_div').hide();
            }
        })
        $('.btnEditParameterlist').click(function (e) {
            streamlined_communication_id = $(this).attr('system-id');
            is_new_page_parameterlist= 1;
            $('#parameterlist_parameter').val($('#parameterlist_parameter-'+streamlined_communication_id).val());
            $('#parameterlist_example').val($('#parameterlist_example-'+streamlined_communication_id).val());
            $('#parameterlist_description').val($('#parameterlist_description-'+streamlined_communication_id).val());
            $('#parameterlist_msg_id').val(streamlined_communication_id);
            $('.parameterlist_form_title').text('Edit Existing Auto Parameter List');
            platform = $.trim($('#parameterlist_platform-'+streamlined_communication_id).val())
            $('#parameterlist_platform option[value="'+platform+'"]').attr("selected", "selected");
            $('#add-edit-parameterlist').modal('show');

        })

        $('.onoffswitch-checkbox').click(function (e) {
            streamlined_communication_id = $(this).attr('system-id')
            if ($('#msg_active_and_automated-'+streamlined_communication_id).prop('checked')) {
               $('#msg_active_and_automated-'+streamlined_communication_id).val('True')
            }
            else {
               $('#msg_active_and_automated-'+streamlined_communication_id).val('False')
            }
            update_msg_ids+= streamlined_communication_id + ',';
        })

        $('#btnAdd').click(function (e) {
            active_tab = $('#activeTab').val()
            call_hr_count = 0
            $('.partners_selection_div').hide();
            $('.partners_selection').multiSelect('deselect_all');
            $('.select-all-partner').val('select')
            $('.select-all-partner').html('select all')
            if(active_tab == 'email') {
                $('#email_msg_id').val('');
                $('.email_form_title').text('Add New Auto Email');
                $('#email_content').val('');
                $('#email_subject').val('');
                $('#email_pre_header').val('');
                $('#email_template_code').val('');
                $('#email_description').val('');
                $('input[name="email_julo_gold"]:checked').val();
                $('#email_parameters').multiSelect('deselect_all');
                $('.partners_selection').multiSelect('deselect_all');
                $('#add-edit-email').modal('show');
                $('#email_julo_gold_status_exclude').prop('checked', true);
            } else if(active_tab == 'sms') {
                $('#sms_msg_id').val('');
                $('.sms_form_title').text('Add New Auto SMS');
                $('#sms_content').val('');
                $('#sms_template_code').val('');
                $('#sms_description').val('');
                $('input[name="sms_julo_gold_status"]:checked').val();
                $('#sms_parameters').multiSelect('deselect_all');
                $('#add-edit-sms').modal('show');
                $('#sms_julo_gold_status_exclude').prop('checked', true);
            } else if(active_tab == 'robocall') {
                $("select#voice_message").val("").trigger("change");
                $('#robocall_msg_id').val('');
                $('#robocall_content').val('');
                $('#robocall_time_out_duration').val('');
                $('#robocall_template_code').val('');
                $('#robocall_attempts').val('');
                $('#robocall_description').val('');
                $('#robocall_exclude_risky').prop('checked', false);
                $('#robocall_parameters').multiSelect('deselect_all');
                $('.robocall_form_title').text('Add New Auto Robocall');
                $('input[name="robocall_julo_gold_status"]:checked').val();
                $('#robocall_julo_gold_status_exclude').prop('checked', true);
                params_id = 0;
                $("div").remove(".add_more_params");
                $('#add-edit-robocall').modal('show');
            } else if(active_tab == 'pn') {
                $('#pn_msg_id').val('');
                $('.pn_form_title').text('Add New Auto PN');
                $('#pn_content').val('');
                $('#pn_template_code').val('');
                $('#pn_description').val('');
                $('#pn_image').val('');
                $('#pn_image_preview_div').hide();
                $('#pn_parameters').multiSelect('deselect_all');
                $('#add-edit-pn').modal('show');
            } else if(active_tab == 'parameterlist') {
                $('#parameterlist_msg_id').val('');
                $('.parameterlist_form_title').text('Add New Auto parameterlist');
                $('#parameterlist_parameter').val('');
                $('#parameterlist_platform').val('');
                $('#parameterlist_example').val('');
                $('#parameterlist_description').val('');
                $('#add-edit-parameterlist').modal('show');
            }else if(active_tab == 'info_card') {
                $('.info_card_form_title').text('Add New Info Card');
                $("#info-card-form").trigger("reset");
                clear_info_card()
                $('#info-card-form').attr('action', "{%url 'streamlined:create_new_info_card' %}")
                $('#add-edit-info-card').modal('show');
            } else if(active_tab == 'widgetduedate') {
                $('#add-edit-widgetduedate').modal('show');
                $('#widgetduedate_id').val('');
                // Reset form
                $('#add-edit-widgetduedate_form .form-control').each(function () {
                    $(this).val('')
                })
                $('#add-edit-widgetduedate_form .color-picker').each(function () {
                    $(this).val('#000000')
                })
                $('.clickable-info-text-color').text('Bayar lebih cepat akan makin untung loh!')
                $('.widget-top').css('background', '#ffffff')
                $('.widget-bot').css('background', '#00ACF0')
                $('.widget-base').css('color', '#404040')
                $('.widget-description').css('color', '#ffffff')
                // Reset image
                $('#widgetduedate_image').val('');
                $('#widgetduedate_image_preview').attr('src', '');
                $('#widgetduedate_image_preview_div').hide();
                $('#is_widgetduedate_image_changes').val('false');
                $('#widget-icon-content-img').attr('src', 'https://www.julo.co.id/sites/default/files/users/user20/crm-asset/Promo%20-%20promo%20anti%20telat.png');
                $('#widget-icon-desc-img').attr('src', 'https://www.julo.co.id/sites/default/files/users/user20/crm-asset/ic-sand-Clock.png');
                
            } else if(active_tab == 'sliknotification') {
                $('#add-edit-sliknotification').modal('show');
                $('#sliknotification_id').val('');
                // Reset form
                $('#add-edit-sliknotification_form .form-control').each(function () {
                    $(this).val('')
                })
                $('#add-edit-sliknotification_form .color-picker').each(function () {
                    $(this).val('#000000')
                })
                $('.clickable-info-text-color').text('Bayar lebih cepat akan makin untung loh!')
                $('.widget-top').css('background', '#ffffff')
                $('.widget-bot').css('background', '#00ACF0')
                $('.widget-base').css('color', '#404040')
                $('.widget-description').css('color', '#ffffff')
                // Reset image
                $('#sliknotification_image').val('');
                $('#sliknotification_image_preview').attr('src', '');
                $('#sliknotification_image_preview_div').hide();
                $('#is_sliknotification_image_changes').val('false');
                $('#slik-icon-content-img').attr('src', 'https://www.julo.co.id/sites/default/files/newsletter/ic-information-circle_0.png');
            }  else {
                if (active_tab==='functionlist'){
                    $('#form-' + active_tab).append(
                        function_template.replace(/{new_id}/g, next_new_id)
                        .replace(/{active_tab}/g, active_tab)
                    )
                }
                else{
                    $('#form-' + active_tab).append(
                        item_template.replace(/{new_id}/g, next_new_id)
                        .replace(/{active_tab}/g, active_tab)
                    )
                }
                current_ids = clean_array($('#new_message_id_' + active_tab).val().split(','))
                current_ids.push('new-' + next_new_id)
                $('#new_message_id_' + active_tab).val(current_ids)
                next_new_id++
                check_empty(active_tab)
            }
        })
        $('.previewshow').click(function (e) {
            itm_id = $(this).attr('system-id');
            var base_url = '{{ base_url }}'
            var change = '{'+ '{ base_url }' + '}'
            var content = $('#email_message-'+itm_id).val()
            $('#preview_div').html(content.split(change).join(base_url))
            $('#content-preview').modal('show');
        });
        $('#btnView').click(function (e) {
            var base_url = '{{ base_url }}'
            var change = '{'+ '{ base_url }' + '}'
            var content = $('#email_content').val()
            $('#preview_div').html(content.split(change).join(base_url))
            $('#content-preview').modal('show');
        });

        $('#btnSave').click(function (e) {
            active_tab = $('#activeTab').val()
            if(active_tab == 'sms' || active_tab == 'robocall' || active_tab == 'pn' || active_tab == 'email' || active_tab == 'widgetduedate' || active_tab == 'sliknotification'  ) {
                $('#update_msg_id_automated_' + active_tab).val(update_msg_ids)
                if (!update_msg_ids) {
                    ToastDanger('Failure', 'Please select a button to activate/deactivate');
                } else {
                    $('#btnSave').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                    $('#form-' + active_tab).addHidden('active_tab', active_tab).submit()
                }
            } else if(active_tab == 'parameterlist') {
                validate_status = validate_function(active_tab)
                if (validate_status) {
                    $('#btnSave').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                    $('#form-' + active_tab).addHidden('active_tab', active_tab).submit()
                }
            } else if(active_tab == 'functionlist') {
                validate_status = validate(active_tab)
                if (validate_status) {
                    $('#btnSave').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                    $('#form-' + active_tab).addHidden('active_tab', active_tab).submit()
                }
            }else if(active_tab == 'info_card') {
                $('#btnSave').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                submit_change_card_order()
            }
            else {
                validate_status = validate(active_tab)
                if (validate_status) {
                    $('#btnSave').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                    $('#form-' + active_tab).addHidden('active_tab', active_tab).submit()
                }
            }
        })
        $('.check-for-update').on('change', function (e) {
            active_tab = $('#activeTab').val()
            stream_lined_id = $(this).attr('system-id')
            current_ids = clean_array($('#updated_message_id_' + active_tab).val().split(','))
            current_ids.push(stream_lined_id)
            $('#updated_message_id_' + active_tab).val(current_ids.filter(function (itm, i, a) {
                return i == a.indexOf(itm);
            }).join(','))
        })
        var selected_call_parameter = '';
        $('#add_call_parameter').on('click', function (e) {
            $('#confirm_call_parameter').modal('hide');
            active_tab = $('#activeTab').val()
            if(active_tab == 'email')
                var box = $("#email_content");
            if(active_tab == 'sms')
                var box = $("#sms_content");
            if(active_tab == 'robocall')
                var box = $("#robocall_content");
            if(active_tab == 'pn')
                var box = $("#pn_content");
            if(active_tab == 'info_card')
                var box = $("#info_card_content");
            box.val(box.val() + selected_call_parameter);
            selected_call_parameter = '';
        })
        $("#save_email_template").on('click', function (e) {
            email_parameters_list = $('#email_parameters option:selected')
                .toArray().map(item => item.value);
            partners_selection_list = $('.partners_selection option:selected')
                .toArray().map(item => item.value);
            if ($('#email_product').val() == 'j1' || $('#email_product').val() == 'jturbo'){
                partners_selection_action = 'exclude'
            }
            else{
                partners_selection_action = 'include'
            }
            var email_julo_gold_status = $('input[name="email_julo_gold"]:checked').val();
            var errors = validateEmailForm();
            if (errors == "") {
                active_tab = $('#activeTab').val()
                $('#save_email_template').text('Waiting ...').addClass('disabled').attr("disabled", true)
                $.ajax({
                    url :  "{%url 'streamlined:update_email_details' %}/", // the endpoint
                    type : "POST", // http method
                    data : {
                        csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val(),
                        email_category: $('#email_category').val(),
                        email_type: $('#email_type').val(),
                        email_product: $('#email_product').val(),
                        email_hour: $('#email_hour').val(),
                        email_minute: $('#email_minute').val(),
                        email_subject: $('#email_subject').val(),
                        email_template_code: $('#email_template_code').val(),
                        email_moengage_template_code: $('#email_moengage_template_code').val(),
                        email_content: $('#email_content').val(),
                        email_description: $('#email_description').val(),
                        email_julo_gold_status: email_julo_gold_status,
                        email_parameters: email_parameters_list.join(),
                        partners_selection: partners_selection_list.join(),
                        partners_selection_action: partners_selection_action,
                        dpd: $('#status_dpd').val(),
                        dpd_upper: $('#status_dpd_upper').val(),
                        dpd_lower: $('#status_dpd_lower').val(),
                        until_paid: $('#until_paid').val(),
                        ptp: $('#status_ptp').val(),
                        application_status: $('#status_code').val(),
                        email_msg_id: $('#email_msg_id').val(),
                        pre_header: $('#email_pre_header').val()

                    }, // data sent with the post request
                    // handle a successful response
                    success : function(json) {
                        if(json.data.status == "Success") {
                            ToastSuccess(json.data.status, json.data.msg);
                            $('#save_email_template').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                            $('#add-edit-email_form').addHidden('active_tab', active_tab).submit();
                        } else {
                            ToastDanger(json.data.status, json.data.msg);
                            $('#save_email_template').text('Save').removeClass('disabled').attr("disabled", false);
                        }
                    },
                    // handle a non-successful response
                    error : function(xhr,errmsg,err) {
                        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                        ToastDanger('Error', 'some error occured!');
                        $('#save_email_template').text('Save').removeClass('disabled').attr("disabled", false);
                    }
                });
            } else {
                ToastDanger('Failure', 'Please fill all details');
                e.preventDefault();
                return false;
            }
        });
        $("#save_sms_template").on('click', function (e) {
            sms_parameters_list = $('#sms_parameters option:selected')
                .toArray().map(item => item.value);
            partners_selection_list = $('.partners_selection option:selected')
                .toArray().map(item => item.value);
            if (['j1', 'jturbo'].includes($('#sms_product').val())){
                partners_selection_action = 'exclude'
            }
            else{
                partners_selection_action = 'include'
            }
            var errors = validateSMSForm();
            if (errors == "") {
                active_tab = $('#activeTab').val()
                $('#save_sms_template').text('Waiting ...').addClass('disabled').attr("disabled", true)
                $.ajax({
                    url :  "{%url 'streamlined:update_sms_details' %}/", // the endpoint
                    type : "POST", // http method
                    data : {
                        csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val(),
                        sms_type: $('#sms_type').val(),
                        sms_product: $('#sms_product').val(),
                        sms_hour: $('#sms_hour').val(),
                        sms_minute: $('#sms_minute').val(),
                        sms_template_code: $('#sms_template_code').val(),
                        sms_content: $('#sms_content').val(),
                        sms_description: $('#sms_description').val(),
                        sms_julo_gold_status: $('input[name="sms_julo_gold_status"]:checked').val(),
                        sms_parameters: sms_parameters_list.join(),
                        partners_selection: partners_selection_list.join(),
                        partners_selection_action: partners_selection_action,
                        dpd: $('#status_dpd').val(),
                        dpd_upper: $('#status_dpd_upper').val(),
                        dpd_lower: $('#status_dpd_lower').val(),
                        until_paid: $('#until_paid').val(),
                        ptp: $('#status_ptp').val(),
                        application_status: $('#status_code').val(),
                        sms_msg_id: $('#sms_msg_id').val(),
                        dpd_from: $('#status_dpd_lower').val(),
                        dpd_until: $('#status_dpd_upper').val(),
                    }, // data sent with the post request
                    // handle a successful response
                    success : function(json) {
                        if(json.data.status == "Success") {
                            ToastSuccess(json.data.status, json.data.msg);
                            $('#save_sms_template').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                            $('#add-edit-sms_form').addHidden('active_tab', active_tab).submit();
                        } else {
                            ToastDanger(json.data.status, json.data.msg);
                            $('#save_sms_template').text('Save').removeClass('disabled').attr("disabled", false);
                        }
                    },
                    // handle a non-successful response
                    error : function(xhr,errmsg,err) {
                        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                        ToastDanger('Error', 'some error occured!');
                        $('#save_sms_template').text('Save').removeClass('disabled').attr("disabled", false);
                    }
                });
            } else {
                ToastDanger('Failure', 'Please fill all details');
                e.preventDefault();
                return false;
            }
        });
        $("#save_robocall_template").on('click', function (e) {
            robocall_parameters_list = $('#robocall_parameters option:selected')
                .toArray().map(item => item.value);
            partners_selection_list = $('.partners_selection option:selected')
                .toArray().map(item => item.value);
            if ($('#robocall_product').val() == 'nexmo_j1' || $('#robocall_product').val() == 'nexmo_turbo'){
                partners_selection_action = 'exclude'
            }
            else{
                partners_selection_action = 'include'
            }
            var errors = validateRobocallForm();
            if (errors == "") {
                active_tab = $('#activeTab').val()
                robocall_call_time = robocall_call_time.slice(0, -1);
                robocall_call_function = robocall_call_function.slice(0, -1);
                call_hr_count = robocall_call_time.split(",");
                if ($('#robocall_attempts').val() == call_hr_count.length)
                {
                    $('#save_robocall_template').text('Waiting ...').addClass('disabled').attr("disabled", true)
                    $.ajax({
                        url :  "{%url 'streamlined:update_robocall_details' %}/", // the endpoint
                        type : "POST", // http method
                        data : {
                            csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val(),
                            robocall_type: $('#robocall_type').val(),
                            robocall_product: $('#robocall_product').val(),
                            robocall_attempts: $('#robocall_attempts').val(),
                            robocall_time_out_duration: $('#robocall_time_out_duration').val(),
                            robocall_template_code: $('#robocall_template_code').val(),
                            robocall_content: $('#robocall_content').val(),
                            robocall_description: $('#robocall_description').val(),
                            robocall_call_time: robocall_call_time,
                            robocall_call_function: robocall_call_function,
                            robocall_parameters: robocall_parameters_list.join(),
                            partners_selection: partners_selection_list.join(),
                            partners_selection_action: partners_selection_action,
                            robocall_exclude_risky: $('#robocall_exclude_risky').is(":checked"),
                            dpd: $('#status_dpd').val(),
                            dpd_upper: $('#status_dpd_upper').val(),
                            dpd_lower: $('#status_dpd_lower').val(),
                            until_paid: $('#until_paid').val(),
                            ptp: $('#status_ptp').val(),
                            application_status: $('#status_code').val(),
                            robocall_msg_id: $('#robocall_msg_id').val(),
                            robocall_segment: $('#robocall_segment').val(),
                            robocall_extra_condition: $('#extra_condition').val(),
                            robocall_julo_gold_status: $('input[name="robocall_julo_gold_status"]:checked').val(),

                        }, // data sent with the post request
                        // handle a successful response
                        success : function(json) {
                            if(json.data.status == "Success") {
                                ToastSuccess(json.data.status, json.data.msg);
                                $('#save_robocall_template').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                                $('#add-edit-robocall_form').addHidden('active_tab', active_tab).submit();
                            } else {
                                ToastDanger(json.data.status, json.data.msg);
                                $('#save_robocall_template').text('Save').removeClass('disabled').attr("disabled", false);
                            }
                        },
                        // handle a non-successful response
                        error : function(xhr,errmsg,err) {
                            console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                            ToastDanger('Error', 'some error occured!');
                            $('#save_robocall_template').text('Save').removeClass('disabled').attr("disabled", false);
                        }
                    });
                } else {
                    ToastDanger('Failure', 'No. of attempts chosen and call hour selected should be same');
                    e.preventDefault();
                    return false;
                }

            } else {
                ToastDanger('Failure', 'Please fill all details');
                e.preventDefault();
                return false;
            }
        });
        $("#save_pn_template").on('click', function (e) {
            pn_parameters_list = $('#pn_parameters option:selected')
                .toArray().map(item => item.value);
            var errors = validatePNForm();
            console.log(errors)

            var form = $('#add-edit-pn_form')[0];

           // Create an FormData object
            var data = new FormData(form);

           // If you want to add an extra field for the FormData
            data.append("csrfmiddlewaretoken", $("input[name=csrfmiddlewaretoken]").val());
            data.append("pn_category", $('#pn_category').val());
            data.append("pn_type", $('#pn_type').val());
            data.append("pn_product", $('#pn_product').val());
            data.append("pn_hour", $('#pn_hour').val());
            data.append("pn_minute", $('#pn_minute').val());
            data.append("pn_template_code",  $('#pn_template_code').val());
            data.append("pn_moengage_template_code", $('#pn_moengage_template_code').val());
            data.append("pn_subject",$('#pn_subject').val())
            data.append("pn_content", $('#pn_content').val())
            data.append("pn_heading", $('#pn_heading').val())
            data.append("pn_description", $('#pn_description').val())
            data.append("pn_parameters", pn_parameters_list.join())
            data.append("dpd", $('#status_dpd').val())
            data.append("dpd_upper", $('#status_dpd_upper').val())
            data.append("dpd_lower", $('#status_dpd_lower').val())
            data.append("until_paid", $('#until_paid').val())
            data.append("ptp", $('#status_ptp').val())
            data.append("application_status", $('#status_code').val())
            data.append("pn_msg_id", $('#pn_msg_id').val())
            data.append("pn_image_status", $('#pn_image_status').val())



            if (errors == "") {
                active_tab = $('#activeTab').val()
                $('#save_pn_template').text('Waiting ...').addClass('disabled').attr("disabled", true)
                $.ajax({
                    url :  "{%url 'streamlined:update_pn_details' %}/", // the endpoint
                    type : "POST", // http method,
                    enctype: 'multipart/form-data',
                    data: data,
                    processData: false,
                    contentType: false,
                    cache: false,
                    // handle a successful response
                    success : function(json) {
                        if(json.data.status == "Success") {
                            ToastSuccess(json.data.status, json.data.msg);
                            $('#save_pn_template').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                            $('#add-edit-pn_form').addHidden('active_tab', active_tab).submit();
                        } else {
                            ToastDanger(json.data.status, json.data.msg);
                            $('#save_pn_template').text('Save').removeClass('disabled').attr("disabled", false);
                        }
                    },
                    // handle a non-successful response
                    error : function(xhr,errmsg,err) {
                        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                        ToastDanger('Error', 'some error occured!');
                        $('#save_pn_template').text('Save').removeClass('disabled').attr("disabled", false);
                    }
                });
            } else {
                ToastDanger('Failure', 'Please fill all details');
                e.preventDefault();
                return false;
            }
        });
        function ToastSuccess(header_msg, body_message) {
            $.toast({
                heading: header_msg,
                text: body_message,
                position: 'top-right',
                loaderBg:'#ff6849',
                icon: 'success',
                hideAfter: 1500,
                stack: 6
            });
        }
        function ToastDanger (header_msg, body_message) {
            $.toast({
                heading: header_msg,
                text: body_message,
                position: 'top-right',
                loaderBg:'#ff6849',
                icon: 'error',
                hideAfter: 2800
            });
        }
        $("#save_parameterlist_template").on('click', function (e) {
            var errors = validateParameterListForm();
            console.log(errors)
            if (errors == "") {
                active_tab = $('#activeTab').val()
                $('#save_parameterlist_template').text('Waiting ...').addClass('disabled').attr("disabled", true)
                $.ajax({
                    url :  "{%url 'streamlined:update_parameterlist_details' %}/", // the endpoint
                    type : "POST", // http method
                    data : {
                        csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val(),
                        parameterlist_parameter: $('#parameterlist_parameter').val(),
                        parameterlist_platform: $('#parameterlist_platform').val(),
                        parameterlist_example: $('#parameterlist_example').val(),
                        parameterlist_description: $('#parameterlist_description').val(),
                        dpd: $('#status_dpd').val(),
                        dpd_upper: $('#status_dpd_upper').val(),
                        dpd_lower: $('#status_dpd_lower').val(),
                        until_paid: $('#until_paid').val(),
                        ptp: $('#status_ptp').val(),
                        application_status: $('#status_code').val(),
                        parameterlist_msg_id: $('#parameterlist_msg_id').val()

                    }, // data sent with the post request
                    // handle a successful response
                    success : function(json) {
                        if(json.data.status == "Success") {
                            ToastSuccess(json.data.status, json.data.msg);
                            $('#save_parameterlist_template').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                            $('#add-edit-parameterlist_form').addHidden('active_tab', active_tab).submit();
                        } else {
                            ToastDanger(json.data.status, json.data.msg);
                            $('#save_parameterlist_template').text('Save').removeClass('disabled').attr("disabled", false);
                        }
                    },
                    // handle a non-successful response
                    error : function(xhr,errmsg,err) {
                        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                        ToastDanger('Error', 'some error occured!');
                        $('#save_parameterlist_template').text('Save').removeClass('disabled').attr("disabled", false);
                    }
                });
            } else {
                ToastDanger('Failure', 'Please fill all details');
                e.preventDefault();
                return false;
            }
        });
        $("#save_widgetduedate_template").on('click', function (e) {
            const errors = validateWidgetDueDateForm();
            if (!errors.length) {
                const form = $('#add-edit-widgetduedate_form')[0];
                const data = new FormData(form)
    
                data.append('csrfmiddlewaretoken', $("input[name=csrfmiddlewaretoken]").val())
                data.append('widgetduedate_id', $("#widgetduedate_id").val())
                data.append('template_code', $('#widgetduedate_template_code').val())
                data.append('product_type', $('#widgetduedate_product').val())
                data.append('info_text', $('#widgetduedate_description').val())
                data.append('card_colour', $('#widgetduedate-card-color').val())
                data.append('info_colour', $('#widgetduedate-info-color').val())
                data.append('card_text_colour', $('#widgetduedate-card-text-color').val())
                data.append('info_text_colour', $('#widgetduedate-info-text-color').val())

                data.append("dpd", $('#status_dpd').val())
                data.append("dpd_upper", $('#status_dpd_upper').val())
                data.append("dpd_lower", $('#status_dpd_lower').val())
                data.append("until_paid", $('#until_paid').val())
                data.append("ptp", $('#status_ptp').val())
                data.append("application_status", $('#status_code').val())

                active_tab = $('#activeTab').val()
                $('#save_widgetduedate_template').text('Waiting ...').addClass('disabled').attr("disabled", true)
                $.ajax({
                    url :  "{%url 'streamlined:create_update_widget_due_date' %}/", // the endpoint
                    type : "POST", // http method
                    enctype: 'multipart/form-data',
                    processData: false,
                    contentType: false,
                    data : data,

                    // handle a successful response
                    success : function(json) {
                        if(json.data.status == "Success") {
                            ToastSuccess(json.data.status, json.data.msg);
                            $('#save_widgetduedate_template').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                            $('#add-edit-widgetduedate_form').addHidden('active_tab', active_tab).submit();
                        } else {
                            ToastDanger(json.data.status, json.data.msg);
                            $('#save_widgetduedate_template').text('Save').removeClass('disabled').attr("disabled", false);
                        }
                    },
                    // handle a non-successful response
                    error : function(xhr,errmsg,err) {
                        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                        ToastDanger('Error', 'some error occured!');
                        $('#save_widgetduedate_template').text('Save').removeClass('disabled').attr("disabled", false);
                    }
                });
            } else {
                ToastDanger('Failure', 'Please fill all details');
                e.preventDefault();
                console.log(errors)
                return false;
            }
        });
        $("#save_sliknotification_template").on('click', function (e) {
            const errors = validateSlikNotificationForm();
            if (!errors.length) {
                const form = $('#add-edit-sliknotification_form')[0];
                const data = new FormData(form)
    
                data.append('csrfmiddlewaretoken', $("input[name=csrfmiddlewaretoken]").val())
                data.append('sliknotification_id', $("#sliknotification_id").val())
                data.append('template_code', $('#sliknotification_template_code').val())
                data.append('product_type', $('#sliknotification_product').val())
                data.append('info_text', $('#sliknotification_description').val())
                data.append('card_colour', $('#sliknotification-card-color').val())
                data.append('info_text_colour', $('#sliknotification-info-text-color').val())
                data.append('info_imcard_image', 'https://www.julo.co.id/sites/default/files/newsletter/ic-information-circle_0.png')
                data.append('redirect_url', $('#sliknotification_url').val())

                data.append("dpd", $('#status_dpd').val())
                data.append("dpd_upper", $('#status_dpd_upper').val())
                data.append("dpd_lower", $('#status_dpd_lower').val())
                data.append("until_paid", $('#until_paid').val())
                data.append("ptp", $('#status_ptp').val())
                data.append("application_status", $('#status_code').val())

                active_tab = $('#activeTab').val()
                $('#save_sliknotification_template').text('Waiting ...').addClass('disabled').attr("disabled", true)
                $.ajax({
                    url :  "{%url 'streamlined:create_update_slik_notification' %}/", // the endpoint
                    type : "POST", // http method
                    enctype: 'multipart/form-data',
                    processData: false,
                    contentType: false,
                    data : data,

                    // handle a successful response
                    success : function(json) {
                        if(json.data.status == "Success") {
                            ToastSuccess(json.data.status, json.data.msg);
                            $('#save_sliknotification_template').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                            $('#add-edit-sliknotification_form').addHidden('active_tab', active_tab).submit();
                        } else {
                            ToastDanger(json.data.status, json.data.msg);
                            $('#save_sliknotification_template').text('Save').removeClass('disabled').attr("disabled", false);
                        }
                    },
                    // handle a non-successful response
                    error : function(xhr,errmsg,err) {
                        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                        ToastDanger('Error', 'some error occured!');
                        $('#save_sliknotification_template').text('Save').removeClass('disabled').attr("disabled", false);
                    }
                });
            } else {
                ToastDanger('Failure', 'Please fill all details');
                e.preventDefault();
                console.log(errors)
                return false;
            }
        });
        function ToastSuccess(header_msg, body_message) {
            $.toast({
                heading: header_msg,
                text: body_message,
                position: 'top-right',
                loaderBg:'#ff6849',
                icon: 'success',
                hideAfter: 1500,
                stack: 6
            });
        }
        function ToastDanger (header_msg, body_message) {
            $.toast({
                heading: header_msg,
                text: body_message,
                position: 'top-right',
                loaderBg:'#ff6849',
                icon: 'error',
                hideAfter: 2800
            });
        }

        function validateEmailForm() {
            var errorFields = new Array();
            if(!$('#email_type').val()) {
                 errorFields.push('email_type');
                 $("#email_type").addClass("error-msg");
            } else {
                $("#email_type").removeClass("error-msg");
            }
            if(!$('#email_subject').val()) {
                 errorFields.push('email_subject');
                 $("#email_subject").addClass("error-msg");
            } else {
                $("#email_subject").removeClass("error-msg");
            }
            if(!$('#email_pre_header').val()) {
                 errorFields.push('email_pre_header');
                 $("#email_pre_header").addClass("error-msg");
            } else {
                $("#email_pre_header").removeClass("error-msg");
            }
            if(!$('#email_template_code').val()) {
                 errorFields.push('email_template_code');
                 $("#email_template_code").addClass("error-msg");
            } else {
                var isValid = false;
                var regex = /^[A-Za-z0-9-+_]*$/;
                isValid = regex.test($("#email_template_code").val());
                if(!isValid) {
                    $("#email_template_code").addClass("error-msg");
                    ToastDanger('Failure', 'Special characters other than +,-,_ are not allowed');
                } else {
                    $("#email_template_code").removeClass("error-msg");
                }
            }
            if(!$('#email_content').val()) {
                 errorFields.push('email_content');
                 $("#email_content").addClass("error-msg");
            } else {
                $("#email_content").removeClass("error-msg");
            }
            if(!$('#email_description').val()) {
                 errorFields.push('email_description');
                 $("#email_description").addClass("error-msg");
            } else {
                $("#email_description").removeClass("error-msg");
            }

            if ($('#email_category').val() === 'backup') {
                let moengage_template_code = $('#email_moengage_template_code').val()
                if (!moengage_template_code) {
                    errorFields.push('email_moengage_template_code');
                    $('#email_moengage_template_code').addClass('error-msg');
                } else {
                    $("#email_moengage_template_code").removeClass("error-msg");
                }

                if (moengage_template_code.length < 1) {
                    errorFields.push('email_moengage_template_code')
                    $('#email_moengage_template_code').addClass('error-msg');
                } else {
                    $("#email_moengage_template_code").removeClass("error-msg");
                }
            }

            return errorFields;
        } //end function validateForm

        function validateSMSForm() {
            var errorFields = new Array();
            //Check required fields have something in them
            /*if(!$('#sms_product').val()) {
                 errorFields.push('sms_product');
                 $("#sms_product").addClass("error-msg");
            } else {
                $("#sms_product").removeClass("error-msg");
            }*/
            if(!$('#sms_type').val()) {
                 errorFields.push('sms_type');
                 $("#sms_type").addClass("error-msg");
            } else {
                $("#sms_type").removeClass("error-msg");
            }
            /*if(!$('#sms_hour').val()) {
                 errorFields.push('sms_hour');
                 $("#sms_hour").addClass("error-msg");
            } else {
                $("#sms_hour").removeClass("error-msg");
            }
            if(!$('#sms_minute').val()) {
                 errorFields.push('sms_minute');
                 $("#sms_minute").addClass("error-msg");
            } else {
                $("#sms_minute").removeClass("error-msg");
            }*/
            if(!$('#sms_template_code').val()) {
                 errorFields.push('sms_template_code');
                 $("#sms_template_code").addClass("error-msg");
            } else {
                var isValid = false;
                var regex = /^[A-Za-z0-9-+_]*$/;
                isValid = regex.test($("#sms_template_code").val());
                if(!isValid) {
                    $("#sms_template_code").addClass("error-msg");
                    ToastDanger('Failure', 'Special characters other than +,-,_ are not allowed');
                } else {
                    $("#sms_template_code").removeClass("error-msg");
                }
            }
            if(!$('#sms_content').val()) {
                 errorFields.push('sms_content');
                 $("#sms_content").addClass("error-msg");
            } else {
                $("#sms_content").removeClass("error-msg");
            }
            if(!$('#sms_description').val()) {
                 errorFields.push('sms_description');
                 $("#sms_description").addClass("error-msg");
            } else {
                $("#sms_description").removeClass("error-msg");
            }
            /*if(sms_parameters_list.length == 0) {
                $("#ms-sms_parameters").addClass("error-msg");
                errorFields.push('sms_parameters');
            } else {
                $("#ms-sms_parameters").removeClass("error-msg");
            }*/
            return errorFields;
        } //end function validateForm

        function validateRobocallForm() {
            var errorFields = new Array();
            //Check required fields have something in them
            if(!$('#robocall_product').val()) {
                 errorFields.push('robocall_product');
                 $("#robocall_product").addClass("error-msg");
            } else {
                $("#robocall_product").removeClass("error-msg");
            }
            if(!$('#robocall_type').val()) {
                 errorFields.push('robocall_type');
                 $("#robocall_type").addClass("error-msg");
            } else {
                $("#robocall_type").removeClass("error-msg");
            }
            if(!$('#robocall_attempts').val()) {
                 errorFields.push('robocall_attempts');
                 $("#robocall_attempts").addClass("error-msg");
            } else {
                $("#robocall_attempts").removeClass("error-msg");
            }
            if(!$('#robocall_time_out_duration').val()) {
                 errorFields.push('robocall_time_out_duration');
                 $("#robocall_time_out_duration").addClass("error-msg");
            } else {
                $("#robocall_time_out_duration").removeClass("error-msg");
            }
            if(!$('#robocall_template_code').val()) {
                 errorFields.push('robocall_template_code');
                 $("#robocall_template_code").addClass("error-msg");
            } else {
                var isValid = false;
                var regex = /^[A-Za-z0-9-+_]*$/;
                isValid = regex.test($("#robocall_template_code").val());
                if(!isValid) {
                    $("#robocall_template_code").addClass("error-msg");
                    ToastDanger('Failure', 'Special characters other than +,-,_ are not allowed');
                } else {
                    $("#robocall_template_code").removeClass("error-msg");
                }
            }
            if(!$('#robocall_content').val()) {
                 errorFields.push('robocall_content');
                 $("#robocall_content").addClass("error-msg");
            } else {
                $("#robocall_content").removeClass("error-msg");
            }
            if(!$('#robocall_description').val()) {
                 errorFields.push('robocall_description');
                 $("#robocall_description").addClass("error-msg");
            } else {
                $("#robocall_description").removeClass("error-msg");
            }
            if(!$('#robocall_segment').val()) {
                 errorFields.push('robocall_segment');
                 $("#robocall_segment").addClass("error-msg");
            } else {
                $("#robocall_segment").removeClass("error-msg");
            }
            robocall_call_time = ''
            robocall_call_function = ''
            for(i = 0; i < params_id; i++) {
                if($('#robocall_hour_'+i).length > 0 && $('#robocall_hour_'+i).val()) {
                    if($('#robocall_minute_'+i).val())
                        robocall_call_time+= $('#robocall_hour_'+i).val() + ":" + $('#robocall_minute_'+i).val() + ",";
                    else
                        robocall_call_time+= $('#robocall_hour_'+i).val() + ",";
                    $('#robocall_hour_'+i).removeClass("error-msg");
                } else {
                    $('#robocall_hour_'+i).addClass("error-msg");
                }
                if($('#robocall_function_'+i).length > 0 && $('#robocall_function_'+i).val()) {
                    robocall_call_function+= $('#robocall_function_'+i).val() + ",";
                    $('#robocall_function_'+i).removeClass("error-msg");
                } else {
                    $('#robocall_function_'+i).addClass("error-msg");
                }
            }
            if(!robocall_call_time) {
               errorFields.push('robocall_call_time');
            }
            if(!robocall_call_function) {
               errorFields.push('robocall_call_function');
            }
            if(robocall_parameters_list.length == 0) {
                $("#ms-robocall_parameters").addClass("error-msg");
                errorFields.push('robocall_parameters');
            } else {
                $("#ms-robocall_parameters").removeClass("error-msg");
            }
            return errorFields;
        } //end function validateForm

        function validatePNForm() {
            var errorFields = new Array();
            //Check required fields have something in them
            /*if(!$('#sms_product').val()) {
                 errorFields.push('sms_product');
                 $("#sms_product").addClass("error-msg");
            } else {
                $("#sms_product").removeClass("error-msg");
            }*/
            if(!$('#pn_type').val()) {
                 errorFields.push('pn_type');
                 $("#pn_type").addClass("error-msg");
            } else {
                $("#pn_type").removeClass("error-msg");
            }
            if(!$('#pn_template_code').val()) {
                 errorFields.push('pn_template_code');
                 $("#pn_template_code").addClass("error-msg");
            } else {
                var isValid = false;
                var regex = /^[A-Za-z0-9-+_]*$/;
                isValid = regex.test($("#pn_template_code").val());
                if(!isValid) {
                    $("#pn_template_code").addClass("error-msg");
                    ToastDanger('Failure', 'Special characters other than +,-,_ are not allowed');
                } else {
                    $("#pn_template_code").removeClass("error-msg");
                }
            }
            if(!$('#pn_content').val()) {
                 errorFields.push('pn_content');
                 $("#pn_content").addClass("error-msg");
            } else {
                $("#pn_content").removeClass("error-msg");
            }
            if(!$('#pn_heading').val()) {
                 errorFields.push('pn_heading');
                 $("#pn_heading").addClass("error-msg");
            } else {
                $("#pn_heading").removeClass("error-msg");
            }
            if(!$('#pn_description').val()) {
                 errorFields.push('pn_description');
                 $("#pn_description").addClass("error-msg");
            } else {
                $("#pn_description").removeClass("error-msg");
            }
            if ($('#pn_category').val() === 'backup') {
                let moengage_template_code = $('#pn_moengage_template_code').val()
                if (!moengage_template_code) {
                    errorFields.push('pn_moengage_template_code');
                    $('#pn_moengage_template_code').addClass('error-msg');
                } else {
                    $("#pn_moengage_template_code").removeClass("error-msg");
                }

                if (moengage_template_code.length < 1) {
                    errorFields.push('pn_moengage_template_code')
                    $('#pn_moengage_template_code').addClass('error-msg');
                } else {
                    $("#pn_moengage_template_code").removeClass("error-msg");
                }
            }
            return errorFields;
        } //end function validateForm

        function validateParameterListForm() {
            var errorFields = new Array();
            //Check required fields have something in them
            if(!$('#parameterlist_parameter').val()) {
                 errorFields.push('parameterlist_parameter');
                 $("#parameterlist_parameter").addClass("error-msg");
            } else {
                $("#parameterlist_parameter").removeClass("error-msg");
            }
            if(!$('#parameterlist_platform').val()) {
                 errorFields.push('parameterlist_platform');
                 $("#parameterlist_platform").addClass("error-msg");
            } else {
                $("#parameterlist_platform").removeClass("error-msg");
            }
            if(!$('#parameterlist_example').val()) {
                 errorFields.push('parameterlist_example');
                 $("#parameterlist_example").addClass("error-msg");
            } else {
                $("#parameterlist_example").removeClass("error-msg");
            }
            if(!$('#parameterlist_description').val()) {
                 errorFields.push('parameterlist_description');
                 $("#parameterlist_description").addClass("error-msg");
            } else {
                $("#parameterlist_description").removeClass("error-msg");
            }
            return errorFields;
        } //end function validateForm

        function validateWidgetDueDateForm() {
            const errorFields = new Array();
            //Check required fields have something in them
            $('#add-edit-widgetduedate_form .form-control:not(.form-control-optional)').each(function (i, ele) {
                if (!$(ele).val()) {
                    // empty value
                    errorFields.push($(ele).attr('id'));
                    $(ele).addClass("error-msg");
                } else if ($(ele).hasClass('color-picker-text') && !/^#[0-9A-F]{6}$/i.test($(ele).val())) {
                    // invalid color code
                    errorFields.push($(ele).attr('id'));
                    $(ele).addClass("error-msg");
                } else {
                    $(ele).removeClass("error-msg");
                }
            })
            // Check optional field if there is value
            $('#add-edit-widgetduedate_form .form-control-optional').each(function (i, ele) {
                if ($(ele).val() && $(ele).hasClass('color-picker-text') && !/^#[0-9A-F]{6}$/i.test($(ele).val())) {
                    // skip validation
                    errorFields.push($(ele).attr('id'));
                    $(ele).addClass("error-msg");
                } else {
                    $(ele).removeClass("error-msg");
                }
            })
            
            if (!$('#widgetduedate_image').val() && !$('#widgetduedate_image_status').val()) {
                errorFields.push('widgetduedate_image');
                $('#widgetduedate_image').addClass("error-msg");
            } else {
                $('#widgetduedate_image').removeClass("error-msg");
            }

            return errorFields;
        } //end function validateForm

        function validateSlikNotificationForm() {
            const errorFields = new Array();
            //Check required fields have something in them
            $('#add-edit-sliknotification_form .form-control:not(.form-control-optional)').each(function (i, ele) {
                if (!$(ele).val()) {
                    // empty value
                    errorFields.push($(ele).attr('id'));
                    $(ele).addClass("error-msg");
                } else if ($(ele).hasClass('color-picker-text') && !/^#[0-9A-F]{6}$/i.test($(ele).val())) {
                    // invalid color code
                    errorFields.push($(ele).attr('id'));
                    $(ele).addClass("error-msg");
                } else {
                    $(ele).removeClass("error-msg");
                }
            })
            // Check optional field if there is value
            $('#add-edit-sliknotification_form .form-control-optional').each(function (i, ele) {
                if ($(ele).val() && $(ele).hasClass('color-picker-text') && !/^#[0-9A-F]{6}$/i.test($(ele).val())) {
                    // skip validation
                    errorFields.push($(ele).attr('id'));
                    $(ele).addClass("error-msg");
                } else {
                    $(ele).removeClass("error-msg");
                }
            })

            return errorFields;
        } //end function validateForm


        $('#add_parameters').click(function() {
            var select_options_hr = ''
            var select_options_min = ''
            {% for i in hrOption %}
            select_options_hr+= '<option value="{{ i }}">{{ i}}</option>'
            {% endfor %}
            {% for i in minOption %}
            select_options_min+= '<option value="{{ i }}">{{ i}}</option>'
            {% endfor %}
            function_template = '';
            {% for item in listRobocallFunction %}
                function_template+= '<option value="{{ item.function_name }}" data-product="{{ item.product|default:"-" }}">{{ item.function_name }}</option>\n';
            {% endfor %}
            params_template = '<div id="row_'+params_id+'" class="add_more_params">' +
                         '<div>' +
                         '<div class="col-md-12 col-sm-12 txt-align">'+
                         '<label for="description">Function to Execute</label>' +
                         '<select class="form-control robocall-function-list" id="robocall_function_'+params_id+'">' + function_template +
                         '</select>' +
                         '</div>' +
                         '</div>' +
                         '<div>' +
                         '<div class="col-md-5 col-sm-12 txt-align">' +
                         '<label for="description">Hour</label>' +
                         '<select class="form-control" id="robocall_hour_'+params_id+'">' + select_options_hr +
                         '</select>' +
                         '</div>' +
                         '<div class="col-md-5 col-sm-12 txt-align">' +
                         '<label for="description">Minute</label>' +
                         '<select class="form-control" id="robocall_minute_'+params_id+'">' + select_options_min +
                         '</select>' +
                         '</div>' +
                         '<div class="col-md-1 col-sm-12 txt-align">' +
                         '<label for="description">&nbsp;</label>' +
                         '<button type="button" class="btn btn-danger remove_parameters"' +
                         'id="remove_param_'+params_id+'" ind="'+params_id+'">-' +
                         '</button>' +
                         '</div>' +
                         '</div></div>';
            $('.more_params:last').after(params_template);
            filter_function_list("", '#robocall_function_'+params_id);
            params_id++;
        });
        $('.params_div').on('click','.remove_parameters',function() {
            remove_param_id = $(this).attr('ind');
 	        $('#row_'+remove_param_id).remove();
        });
        $("#btnTestSMS").on('click', function (e) {
            if ($('#sms_content').val().length == 0){
                ToastDanger('Error', 'Mohon isi konten pesan sebelum test');
            }
            $('#btnTestSMS').text('Waiting ...').addClass('disabled').attr("disabled", true)
            $.ajax({
                url :  "{%url 'streamlined:mocking_sms_text_value' %}/", // the endpoint
                type : "POST", // http method
                data : {
                    csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val(),
                    message: $('#sms_content').val(),
                    customer_id: $('#test_sms_customer_id').val(),

                }, // data sent with the post request
                // handle a successful response
                success : function(json) {
                    $('#btnTestSMS').text('Test').removeClass('disabled').attr("disabled", false);
                    if(json.status == "success") {
                        $('#sms_preview').val(json.processed_message)
                        $('#test_sms_length').val(
                            json.message_length + " / 160"
                        )
                    }
                },
                // handle a non-successful response
                error : function(xhr,errmsg,err) {
                    console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                    ToastDanger('Error', 'some error occured!');
                    $('#btnTestSMS').text('Test').removeClass('disabled').attr("disabled", false);
                }
            });
        });
        $('#btnCloseTestSMS').click(function (e){
            $('#add-edit-sms').modal('show')
        })

        $('#email_parameters').multiSelect({
            afterSelect: function(values){
                selected_call_parameter = "{{" + values + "}\}"
                if(is_new_page_email == 0) {
                    $('#confirm_call_parameter').modal('show');
                }
                is_new_page_email = 0
            }
        });
        $('.partners_selection').multiSelect({
            afterSelect: function(values){
                selected_call_parameter = "{{" + values + "}\}"
                is_new_page_partner = 0
            }
        });
        $('#sms_parameters').multiSelect({
            afterSelect: function(values){
                selected_call_parameter = "{{" + values + "}\}"
                if(is_new_page_sms == 0) {
                    $('#confirm_call_parameter').modal('show');
                }
                is_new_page_sms = 0
            }
        });
        $('#robocall_parameters').multiSelect({
            afterSelect: function(values){
                selected_call_parameter = "{{" + values + "}\}"
                if(is_new_page_robocall == 0) {
                    $('#confirm_call_parameter').modal('show');
                }
                is_new_page_robocall = 0
            }
        });
        $('#pn_parameters').multiSelect({
            afterSelect: function(values){
                selected_call_parameter = "{{" + values + "}\}"
                if(is_new_page_pn == 0) {
                    $('#confirm_call_parameter').modal('show');
                }
                is_new_page_pn = 0
            }
        });
        $('#info_card_parameters').multiSelect({
            afterSelect: function(values){
                selected_call_parameter = "{{" + values + "}\}"
                if(is_new_page_info_card == 0) {
                    $('#confirm_call_parameter').modal('show');
                }
                is_new_page_info_card = 0
            }
        });

        $('select#voice_message').on('change', function() {
            audio_url = $(this).val();
            wrapper_elm = $(".voice_message_wrapper");
            $("audio").attr('src', audio_url);
            $("#voice_content").html('');

            if (audio_url == "") {
                wrapper_elm.addClass('hide');
            } else {
                wrapper_elm.removeClass('hide');
            }
        });
        {#  end of multiselect#}

        $('button#generate_voice_content').on('click', function() {
            audio_url = $("select#voice_message").val();
            $("#voice_content").html('{"action": "stream", "streamUrl": ["'+audio_url+'"]}');
        });

        $('#add-edit-robocall').on('hidden.bs.modal', function () {
            $("select#voice_message").val("").trigger("change");
        });

        var invalidJson = false;
        $('#test_robocall_template').click(function (e) {
            if ($('#robocall_product').val() == 'nexmo_j1' || $('#robocall_product').val() == 'nexmo_dana') {
                $('#robocall_test_payment_id').text('Account Payment ID:');
                $("#robocall_test_payment").attr("placeholder", "Account Payment ID");
            } else {
                $('#robocall_test_payment_id').text('Payment ID:');
                $("#robocall_test_payment").attr("placeholder", "Account Payment");
            };
            var editor = new JsonEditor('#json-display', getJson());
            editor.load(getJson());
            $("#json-display").removeClass("error-msg");
            $("#robocall_test_payment").val('');
            $("#robocall_test_phone").val('62');
            $("#payment_error").html("");
            $("#test_phone_error").html("");
            $("#json-display_error").html("");
            $("#robocall_test_payment").removeClass("error-msg");
            $("#robocall_test_phone").removeClass("error-msg");
            $('#robocall_test_playground').modal('show');
        });
        function getJson() {
            try {
                invalidJson = false;
                return JSON.parse($('#robocall_content').val());
            } catch (ex) {
                //ToastDanger('Failure', 'Wrong JSON Format: ' + ex);
                invalidJson = true;
            }
        }
        function IsJsonString(str) {
            try {
                JSON.parse(str);
                invalidJson = false;
            } catch (e) {
                invalidJson = true;
            }
            return invalidJson;
        }
        $('#save_test_robocall_data').click(function (e) {
            var errors = checkTestRobocallForm(2);
            if (errors == "" && invalidJson == false) {
                var myJsObj = JSON.parse($('#json-display').text());
                var str = JSON.stringify(myJsObj, undefined, 4);
                $('#robocall_content').html(''); //clear input value
                $('#robocall_content').empty(); //clear html inside of the id
                $('#robocall_content').html(str);
                $('#robocall_content').val(str) //set input value
                $('#robocall_test_playground').modal('hide');
            }  else {
                if (!errors) {
                    ToastDanger('Failure', 'Please fill all details');
                }
                if(invalidJson == true) {
                    ToastDanger('Failure', 'Wrong JSON Format: ');
                }
                e.preventDefault();
                return false;
            }
        });
        $('#call_test_robocall').click(function (e) {
            var errors = checkTestRobocallForm(2);
            if (errors == "" && invalidJson == false) {
                var is_account_payment = false;
                if ($('#robocall_product').val() == 'nexmo_j1' || $('#robocall_product').val() == 'nexmo_dana') {
                    is_account_payment = true;
                };
                var myJsObj = JSON.parse($('#json-display').text());
                var str = JSON.stringify(myJsObj, undefined, 4);
                test_content = str;
                swal({
                    title: "Please wait",
                    text: "The call is being triggered",
                    imageUrl: "/static/images/julo/phone.jpg"
                });
                $.ajax({
                    url :  "{%url 'streamlined:nexmo_robocall_test' %}/", // the endpoint
                    type : "POST", // http method
                    data : {
                        csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val(),
                        payment: parseInt($('#robocall_test_payment').val()),
                        phone: parseInt($('#robocall_test_phone').val()),
                        test_content: test_content,
                        is_account_payment: is_account_payment
                    }, // data sent with the post request
                    // handle a successful response
                    success : function(json) {
                        swal.close();
                        if(json.data.status == "Success") {

                        } else {
                           ToastDanger(json.data.status, json.data.msg);
                        }
                    },
                    // handle a non-successful response
                    error : function(xhr,errmsg,err) {
                        swal.close();
                        console.log(xhr.status + ": " + xhr.responseText);
                        ToastDanger('Error', 'some error occured!');
                    }
                });
            }  else {
                if (!errors) {
                    ToastDanger('Failure', 'Please fill all details');
                }
                if(invalidJson == true) {
                    ToastDanger('Failure', 'Wrong JSON Format: ');
                }
                e.preventDefault();
                return false;
            }
        });
        function checkTestRobocallForm(type) {
            var errorFields = new Array();
            //Check required fields have something in them
            if ($('#robocall_product').val() != 'nexmo_j1' || $('#robocall_product').val() != 'nexmo_dana') {
                if(!$('#robocall_test_payment').val() || $('#robocall_test_payment').val().length < 10) {
                    errorFields.push('robocall_test_payment');
                    if(!$('#robocall_test_payment').val()) {
                        $("#payment_error").html("<font color=red><br>Payment ID should not be empty</font>")
                    }
                    if(!$('#robocall_test_payment').val().length < 10) {
                        $("#payment_error").html("<font color=red><br>Payment ID should not be less than 10 digits</font>")
                    }
                    $("#robocall_test_payment").addClass("error-msg");
                } else {
                    $("#robocall_test_payment").removeClass("error-msg");
                    $("#payment_error").html("");
                }
            };
            if(!$('#robocall_test_phone').val()) {
                 errorFields.push('robocall_test_phone');
                 $("#robocall_test_phone").addClass("error-msg");
                 $("#test_phone_error").html("<font color=red><br>Phone no. should not be empty</font>")
            } else {
                $("#robocall_test_phone").removeClass("error-msg");
                $("#test_phone_error").html("");
            }
            var firstTwo = /^62/;
            if(!($('#robocall_test_phone').val().match(firstTwo)) || $('#robocall_test_phone').val().length < 10)  {
                 errorFields.push('robocall_test_phone');
                 if(!($('#robocall_test_phone').val().match(firstTwo))) {
                    $("#test_phone_error").html("<font color=red><br>Phone no. should start with 62</font>")
                 }
                 if(!($('#robocall_test_phone').val().length < 10)) {
                    $("#test_phone_error").html("<font color=red><br>Phone no. should not less than 10 digits</font>")
                 }
                 $("#robocall_test_phone").addClass("error-msg");
            } else {
                $("#robocall_test_phone").removeClass("error-msg");
                $("#test_phone_error").html("");
            }
            IsJsonString($("#json-display").text())
            if(invalidJson == true) {
                $("#json-display").addClass("error-msg");
                $("#json-display_error").html("<font color=red>Invalid JSON data</font>")
            } else {
                $("#json-display").removeClass("error-msg");
                $("#json-display_error").html("");
            }
            if (type == 1) {
                if(errorFields == '' && invalidJson == false) {
                    $('#save_test_robocall_data').removeClass('btn-default').attr("disabled", false);
                    $('#save_test_robocall_data').addClass('btn-success');
                    $('#call_test_robocall').removeClass('btn-default').attr("disabled", false);
                    $('#call_test_robocall').addClass('btn-primary');
                } else {
                    $('#save_test_robocall_data').removeClass('btn-success').attr("disabled", true);
                    $('#save_test_robocall_data').addClass('btn-default');
                    $('#call_test_robocall').removeClass('btn-primary').attr("disabled", true);
                    $('#call_test_robocall').addClass('btn-default');
                }
            } else {
                return errorFields;
            }
        }
        $(".allownumeric").on("keypress keyup blur change",function (event) {
           $(this).val($(this).val().replace(/[^\d].+/, ""));
           if ((event.which < 48 || event.which > 57)) {
                event.preventDefault();
           } else {
                checkTestRobocallForm(1);
           }
        });
        $('.btnPreviewInfoCard').click(function (e) {
            itm_id = $(this).attr('system-id');
            $.ajax({
                url :  "{%url 'streamlined:get_info_card_property' %}/", // the endpoint
                type : "GET", // http method
                data : {
                    streamlined_communication_id: itm_id,
                },
                success : function(json) {
                    if(json.data.status == "Success") {
                        info_card = json.data.info_card_property
                        template = ''
                        if (info_card.card_type == '1'){
                            $('#preview-type-9-content').hide();
                            $('#preview-type-9-title').hide();
                            $('#button-type-9-background').hide();
                            $('#preview-type-1-title').html(info_card.title).css('color', info_card.title_color)
                            $('#preview-type-1-content').html(info_card.content).css('color', info_card.text_color)
                            $('#background-type-1').css(
                                {
                                    "background-image":"url(" + info_card.card_background_image_url + ")",
                                    "background-repeat": "no-repeat",
                                    "background-size": "100% 100%",
                                    "min-height": "410px",
                                    "padding-right":"5%",
                                }
                            );
                            $('#maskot-img').css(
                                {
                                    "background-image":"url(" + info_card.card_optional_image_url + ")",
                                    "background-repeat": "no-repeat",
                                    "background-size": "contain",
                                    "min-height": "200px",
                                    "background-position": "center"
                                }
                            );
                            if (info_card.buttons.length > 0){
                                button_r = info_card.buttons[0]
                                $('#preview-type-1-button-text').text(button_r.button_text).css(
                                    'color',button_r.text_color
                                )
                                $('#button-type-1-background').css(
                                {
                                    "background-image":"url(" + button_r.background_image_url + ")",
                                    'background-repeat':' no-repeat',
                                    'background-size':'100% 100%',
                                    'margin-top':'10%',
                                    'line-height':' 55px',
                                    'text-align':'center',
                                });
                            }
                            $('#background-type-1').show()
                            $('#background-type-2').hide()
                            $('#background-type-3').hide()
                        }
                        else if(info_card.card_type == '2'){
                            $('#preview-type-9-content').hide();
                            $('#preview-type-9-title').hide();
                            $('#button-type-9-background').hide();
                            button = ''
                            $('#preview-type-2-title').html(info_card.title).css('color', info_card.title_color)
                            $('#preview-type-2-content').html(info_card.content).css('color', info_card.text_color)
                            $('#background-type-2').css(
                                {
                                    "background-image":"url(" + info_card.card_background_image_url + ")",
                                    "background-repeat": "no-repeat",
                                    "background-size": "100% 100%",
                                    "min-height": "410px",
                                }
                            );
                            if (info_card.buttons.length > 0){
                                button_m = info_card.buttons[0]
                                $('#preview-type-2-button-text').text(button_m.button_text).css(
                                    'color',button_m.text_color
                                )
                                $('#button-type-2-background').css(
                                {
                                    "background-image":"url(" + button_m.background_image_url + ")",
                                    'background-repeat':' no-repeat',
                                    'background-size':'100% 100%',
                                    'text-align':'center',
                                    'margin-bottom':'30px',
                                    'display': 'flex',
                                    'align-content': 'center',
                                    'align-items': 'center',
                                    'justify-content': 'center',
                                    'margin-bottom':'30px',
                                });
                                $('#table-preview-2').css({'margin-top':'0px', 'margin-left':'10px'})
                            }else{
                                $('#table-preview-2').css({'margin-top': '60px', 'margin-left': '10px'})
                                $('#preview-type-2-button-text').text('')
                                $('#button-type-2-background').css(
                                {
                                    "background-image":"",
                                    'background-repeat':' no-repeat',
                                    'background-size':'100% 100%',
                                    'text-align':'center',
                                    'margin-bottom':'30px',
                                });
                            }

                            $('#background-type-1').hide()
                            $('#background-type-2').show()
                            $('#background-type-3').hide()
                        }
                        else if($.inArray(info_card.card_type.toLowerCase(), ['3a', '3b']) > -1){
                            $('#preview-type-9-content').hide();
                            $('#preview-type-9-title').hide();
                            $('#button-type-9-background').hide();
                            buttons = info_card.buttons
                            $('#preview-type-3-title').html(info_card.title).css('color', info_card.title_color)
                            $('#preview-type-3-content').html(info_card.content).css('color', info_card.text_color)
                            $('#background-type-3').css(
                                {
                                    "background-image":"url(" + info_card.card_background_image_url + ")",
                                    "background-repeat": "no-repeat",
                                    "background-size": "100% 100%",
                                    "padding-right":"5%",
                                    "padding-bottom":"4px",
                                }
                            );
                            $('#icn-img').css(
                                {
                                    "background-image":"url(" + info_card.card_optional_image_url + ")",
                                    "background-repeat": "no-repeat",
                                    "background-size": "90%",
                                    "padding-right": "5%",
                                    "margin-left": "25px",
                                    "min-height": "6vw",
                                }
                            );
                            if (buttons.length > 1){
                                button_l = info_card.buttons[0]
                                button_r = info_card.buttons[1]
                                $('#preview-type-3-button-l-text').text(button_l.button_text).css(
                                    'color',button_l.text_color
                                )
                                $('#button-l-type-3-background').css(
                                {
                                    "background-image":"url(" + button_l.background_image_url + ")",
                                    'background-repeat':'no-repeat',
                                    "-webkit-background-size": "100% auto",
                                    "-moz-background-size": "100% auto",
                                    "-o-background-size": "100% auto",
                                    "background-size": "98% 98%",
                                }).show();
                                $('#preview-type-3-button-r-text').text(button_r.button_text).css(
                                    'color',button_r.text_color
                                )
                                $('#button-r-type-3-background').css(
                                {
                                    "background-image":"url(" + button_r.background_image_url + ")",
                                    'background-repeat':'no-repeat',
                                    "-webkit-background-size": "100% auto",
                                    "-moz-background-size": "100% auto",
                                    "-o-background-size": "100% auto",
                                    "background-size": "98% 98%",
                                }).show();
                                $('#button-m-type-3-background').hide()
                            }
                            else if (buttons.length == 1){
                                button_m = info_card.buttons[0]
                                $('#preview-type-3-button-m-text').text(button_m.button_text).css(
                                    'color',button_m.text_color
                                )
                                $('#button-m-type-3-background').css(
                                {
                                    "background-image":"url(" + button_m.background_image_url + ")",
                                'background-repeat':' no-repeat',
                                'background-size':' 100% 100%',
                                'margin-top':'10%',
                                'text-align':'center',
                                }).show();
                                $('#button-r-type-3-background').hide()
                                $('#button-l-type-3-background').hide()
                            }

                            $('#background-type-1').hide()
                            $('#background-type-2').hide()
                            $('#background-type-3').show()
                        }
                        else if(info_card.card_type == '9'){
                            $('#preview-type-9-content').show();
                            $('#preview-type-9-title').html(info_card.title).css('color', info_card.title_color)
                            $('#preview-type-9-title').show();
                            if ($('#youtube_iframe').length != 0){
                                $('#youtube_iframe')[0].remove()
                            }
                            $( "#preview-type-9-content" ).append( "<iframe src='https://www.youtube.com/embed/"+info_card.youtube_video_id+"?rel=0&showinfo=0' id='youtube_iframe' frameborder='0' allowfullscreen></iframe>" );
                            $('#background-type-9').show()

                            $('#background-type-1').hide()
                            $('#background-type-2').hide()
                            $('#background-type-3').hide()
                        }
                        $('#info-card-preview').modal('show');
                    } else {
                        ToastDanger(json.data.status, json.data.msg);
                    }
                },
                // handle a non-successful response
                error : function(xhr,errmsg,err) {
                    ToastDanger('Error', 'some error occured!');
                }
            });
        });
        $('#info_card_type').on('change', function(){
            selected = $(this).find('option:selected').val();
            if (selected==''){
                $('.type-1').hide()
                $('.type-2').hide()
                $('.type-3').hide()
                $('.type-9').hide()
                return ''
            }
            var y = ['1', '2', '3', '9']
            var removeItem = selected;
            y.splice( $.inArray(removeItem,y) ,1 );
            for (var i=0; i<y.length;i++){
                $('.type-'+y[i]).hide()
            }
            $('.checked_type').hide()
            $('.type-'+selected).show()
            $('.feature_info_card').prop('checked', false).trigger('change');
            $('#feature_checkbox_for_info_card').show()
            $('.exclude-section-type9').hide()
            if (selected!= 9){
            $('.exclude-section-type9').show()
            }
        })
        $('.feature_info_card').on('change', function(){
              checked_value = $(this).val()
              if(this.checked) {
                 $('.'+checked_value).show(200)
              }else{
                $('.'+checked_value).hide(200)
              }
        })
        $('.destination').on('click', function(){
              show_div = $(this).attr('show')
              hide_div = $(this).attr('hide')
              hide1_div = $(this).attr('hide1')
              hide2_div = $(this).attr('hide2')
              label_div = $(this).attr('label')
               $('.'+show_div).show(200)
               $('.'+hide_div).hide(200)
               $('.'+hide1_div).hide(200)
               $('.'+hide2_div).hide(200)
               $('.'+label_div).show(200)
        })

        $('.expiration-destination').on('click', function(){
                  show_div = $(this).attr('show')
                  hide_div = $(this).attr('hide')
                  label_div = $(this).attr('label')
                   $('.'+show_div).show(200)
                   $('.'+hide_div).hide(200)
                   $('.'+label_div).show(200)
            })
        $('.button_text_color').on('change', function(){
            color = $(this).val()
            console.log(color)
            preview_div = $(this).attr('preview')
            $('#'+preview_div).css({"background-color": color})
        });
        function validate_preview(){
            var validation_status = true
            if ($('#info_card_type').val().length == 0){
                ToastDanger("Failed Preview", "Info Card type should be Filled")
                validation_status = false
            }
            if ($('#info_card_product').is(':visible') && $('#info_card_product').val().length == 0){
                ToastDanger("Failed Preview", "Info Card Product should be Filled")
                validation_status = false
            }
            if ($('#info_card_title').is(':visible') && $('#info_card_title').val().length == 0){
                ToastDanger("Failed Preview", "Info Card Title should be Filled")
                validation_status = false
            }
            if ($('#info_card_content').is(':visible') && $('#info_card_content').val().length == 0){
                ToastDanger("Failed Preview", "Info Card Content should be Filled")
                validation_status = false
            }
            return validation_status
        }
        $('#btnPreviewForm').on('click', function(){
            var info_card_type = $('#info_card_type').val()
            var is_validate = validate_preview()
            if (is_validate == false){
                return ''
            }
            template = ''
            background_object = ''
            l_button_background_object = ''
            r_button_background_object = ''
            m_button_background_object = ''
            m_button_background_object = ''
            r_button_css = {}
            m_button_css = {}
            l_button_css = {}
            info_card = {
                    'title_color': $('#title_text_color').val(),
                    'title': $('#info_card_title').val(),
                    'text_color': $('#body_text_color').val(),
                    'content': $('#info_card_content').val(),
                }

            if (info_card_type == '1'){
                $('#preview-type-9-content').hide();
                $('#preview-type-9-title').hide();
                $('#button-type-9-background').hide();
                button = ''
                if ($('#is_have_r_button').is(':checked')){
                    button_r = {
                        'button_text': $('#r_button_text').val(),
                        'text_color': $('#r_button_text_color').val(),
                        'button_color': $('#r_button_color').val(),
                    }

                    r_button_css={'background-repeat':' no-repeat',
                                    'background-size':' 100%',
                                    'margin-top':'10%',
                                    'line-height':' 55px',
                                    'text-align':'center',
                                }
                    r_button_background_object = $('#button-type-1-background')
                    $('#preview-type-1-button-text').text(button_r.button_text).css(
                                    'color',button_r.text_color
                                )
                }
                $('#preview-type-1-title').html(info_card.title).css('color', info_card.title_color)
                $('#preview-type-1-content').html(info_card.content).css('color', info_card.text_color)
                background_object = $('#background-type-1')
                if ($('#info-card-form').attr('action') == '/streamlined_communication/update_info_card' && $('#optional_image').get(0).files.length === 0){
                        image_url = $('#btn_image_link_card_optional_image').attr('href')
                         $('#maskot-img').css(
                                {
                                    "background-image": "url(" + image_url + ")",
                                    "background-repeat": "no-repeat",
                                    "background-size": "contain",
                                    "min-height": "200px",
                                    "background-position": "center"
                                }
                         );
                }else {
                    if ($('#optional_image').get(0).files.length > 0){
                        var maskot_background_reader = new FileReader();
                        maskot_input_background = $('#optional_image')[0]
                        maskot_background_reader.onload = function (e) {
                            $('#maskot-img').css(
                                {
                                    "background-image": "url(" + e.target.result + ")",
                                    "background-repeat": "no-repeat",
                                    "background-size": "contain",
                                    "min-height": "200px",
                                    "background-position": "center"
                                }
                            );
                        }
                        maskot_background_reader.readAsDataURL(maskot_input_background.files[0]);
                    }
                }
            }
            else if(info_card_type == '2'){
                $('#preview-type-9-content').hide();
                $('#preview-type-9-title').hide();
                $('#button-type-9-background').hide();
                button_m = {}
                if ($('#is_have_m_button').is(':checked')){
                    button_m = {
                        'text_color': $('#m_button_text_color').val(),
                        'button_text': $('#m_button_text').val(),
                        'button_color': $('#m_button_color').val(),
                    }
                    $('#preview-type-2-button-text').text(button_m.button_text).css(
                        'color',button_m.text_color
                    )
                    m_button_background_object = $('#button-type-2-background')
                    m_button_css = { 'background-repeat':' no-repeat',
                                    'background-size':'100% 100%',
                                    'text-align':'center',}
                    $('#table-preview-2').css({'margin-top':'0px', 'margin-left':'10px'})
                }else{
                    $('#table-preview-2').css({'margin-top': '60px', 'margin-left': '10px'})
                    $('#preview-type-2-button-text').text('')
                    $('#button-type-2-background').css(
                    {
                        "background-image":"",
                        'background-repeat':' no-repeat',
                        'background-size':'100% 100%',
                        'text-align':'center',
                        'margin-bottom':'30px',
                    });
                }

                $('#preview-type-2-title').html(info_card.title).css('color', info_card.title_color)
                $('#preview-type-2-content').html(info_card.content).css('color', info_card.text_color)
                background_object = $('#background-type-2')
            }
            else if(info_card_type == '3'){
                $('#preview-type-9-content').hide();
                $('#preview-type-9-title').hide();
                $('#button-type-9-background').hide();
                if ($('#is_have_r_button').is(':checked') && !$('#is_have_l_button').is(':checked')){
                    ToastDanger("Failed Preview", "cannot just pick R button")
                    return ''
                }
                buttons_div = ''
                button_m_div = ''
                if ($('#is_have_l_button').is(':checked') && $('#is_have_r_button').is(':checked')){
                    button_l = {
                        'text_color': $('#l_button_text_color').val(),
                        'button_text': $('#l_button_text').val(),
                        'button_color': $('#l_button_color').val(),
                    }
                    button_r = {
                        'text_color': $('#r_button_text_color').val(),
                        'button_text': $('#r_button_text').val(),
                        'button_color': $('#r_button_color').val(),
                    }
                    r_button_background_object = $('#button-r-type-3-background')
                    l_button_background_object = $('#button-l-type-3-background')
                    $('#preview-type-3-button-l-text').text(button_l.button_text).css(
                                    'color',button_l.text_color
                                )
                    $('#preview-type-3-button-r-text').text(button_r.button_text).css(
                                    'color',button_r.text_color
                                )
                    $('#button-r-type-3-background').show()
                    $('#button-l-type-3-background').show()
                    $('#button-m-type-3-background').hide()
                    l_button_css = {
                        'background-repeat':'no-repeat',
                        "-webkit-background-size": "98% 98%",
                        "-moz-background-size": "98% 98%",
                        "-o-background-size": "98% 98%",
                        "background-size": "98% 98%",
                    }
                    r_button_css = {
                        'background-repeat':'no-repeat',
                        "-webkit-background-size": "98% 98%",
                        "-moz-background-size": "98% 98%",
                        "-o-background-size": "98% 98%",
                        "background-size": "98% 98%",
                    }
                }
                else if ($('#is_have_l_button').is(':checked')){
                    button_m = {
                        'text_color': $('#l_button_text_color').val(),
                        'button_text': $('#l_button_text').val(),
                        'button_color': $('#l_button_color').val(),
                    }
                    $('#preview-type-3-button-m-text').text(button_m.button_text).css(
                                    'color',button_m.text_color
                                )
                    l_button_background_object = $('#button-m-type-3-background')
                    l_button_css ={'background-repeat':' no-repeat',
                                  'background-size':' 100% 100%',
                                  'margin-top':'10%',
                                 'line-height':' 55px',
                                  'text-align':'center',}
                    $('#button-r-type-3-background').hide()
                    $('#button-l-type-3-background').hide()
                    $('#button-m-type-3-background').show()
                }
                $('#preview-type-3-title').html(info_card.title).css('color', info_card.title_color)
                $('#preview-type-3-content').html(info_card.content).css('color', info_card.text_color)
                background_object = $('#background-type-3')
                if ($('#info-card-form').attr('action') == '/streamlined_communication/update_info_card' && $('#optional_image').get(0).files.length === 0){
                        icn_img_url = $('#btn_image_link_card_optional_image').attr('href')
                        $('#icn-img').css(
                            {
                                "background-image": "url(" + icn_img_url + ")",
                                "background-repeat": "no-repeat",
                                "background-size": "90%",
                                "padding-right": "5%",
                                "margin-left": "25px",
                                "min-height": "8vw",
                            }
                        );
                }else {
                    if ($('#optional_image').get(0).files.length > 0){
                        var icn_background_reader = new FileReader();
                        icn_input_background = $('#optional_image')[0]
                        icn_background_reader.onload = function (e) {
                            $('#icn-img').css(
                                {
                                    "background-image": "url(" + e.target.result + ")",
                                    "background-repeat": "no-repeat",
                                    "background-size": "90%",
                                    "padding-right": "5%",
                                    "margin-left": "25px",
                                    "min-height": "6vw",
                                }
                            );
                        }
                        icn_background_reader.readAsDataURL(icn_input_background.files[0]);
                    }
                }
            }
            else if(info_card_type == '9'){
                $('#background-type-1').hide();
                $('#background-type-2').hide();
                $('#background-type-3').hide();
                $('#preview-type-9-content').show();
                $('#preview-type-9-title').show();
                $('#button-type-9-background').show();
                $('#preview-type-9-title').html(info_card.title).css('color', info_card.title_color)
                if ($('#youtube_iframe').length != 0){
                    $('#youtube_iframe')[0].remove()
                }
                $( "#preview-type-9-content" ).append( "<iframe src='https://www.youtube.com/embed/"+$('#youtube_video_id').val()+"?rel=0&showinfo=0' id='youtube_iframe' frameborder='0' allowfullscreen></iframe>" );
            }
            if (info_card_type !== '9') {
                if ($('#info-card-form').attr('action') == '/streamlined_communication/update_info_card' && $('#background_card_image').get(0).files.length === 0) {
                    background_url = $('#btn_image_link_card_background').attr('href')
                    if (background_url) {
                        background_object.css({
                            "background-image": "url(" + background_url + ")",
                            "background-repeat": "no-repeat",
                            "background-size": "100% 100%",
                            "padding-right": "5%",
                            "padding-bottom": "4px",
                        });
                    }
                } else {
                    if ($('#background_card_image').get(0).files.length > 0) {
                        var background_reader = new FileReader();
                        input_background = $('#background_card_image')[0]
                        background_reader.onload = function(e) {
                            background_object.css({
                                "background-image": "url(" + e.target.result + ")",
                                "background-repeat": "no-repeat",
                                "background-size": "100% 100%",
                                "padding-right": "5%",
                            });
                        }
                        background_reader.readAsDataURL(input_background.files[0]);
                    }
                }
            }
            if ($('#is_have_r_button').is(':checked')){
                r_button_background_object = $('#button-r-type-3-background')
                r_button_background_object.show()
                if ($('#info-card-form').attr('action') == '/streamlined_communication/update_info_card' && $('#r_button_image').get(0).files.length === 0){
                        background_url = $('#btn_image_link_r_button').attr('href')
                        r_button_css["background-image"] = "url(" + background_url + ")"
                        r_button_background_object.css(r_button_css)
                }else {
                    if ($('#r_button_image').get(0).files.length > 0){
                        var r_button_background_reader = new FileReader();
                        input_r_button_background = $('#r_button_image')[0]
                        r_button_background_reader.onload = function (e) {
                            r_button_css["background-image"] = "url(" + e.target.result + ")"
                            r_button_background_object.css(r_button_css)
                        }
                        r_button_background_reader.readAsDataURL(input_r_button_background.files[0]);
                    }
                }
            }else{
                $('#button-r-type-3-background').hide()
                $('#button-type-1-background').hide()
            }
            if ($('#is_have_m_button').is(':checked')){
                m_button_background_object = $('#button-type-2-background')
                m_button_background_object.show()
                if ($('#info-card-form').attr('action') == '/streamlined_communication/update_info_card' && $('#m_button_image').get(0).files.length === 0){
                        background_url = $('#btn_image_link_m_button').attr('href')
                        m_button_css["background-image"] = "url(" + background_url + ")"
                        m_button_background_object.css(m_button_css)
                }else {
                    if ($('#m_button_image').get(0).files.length > 0){
                        var m_button_background_reader = new FileReader();
                        input_m_button_background = $('#m_button_image')[0]
                        m_button_background_reader.onload = function (e) {
                            m_button_css["background-image"] = "url(" + e.target.result + ")"
                            m_button_background_object.css(m_button_css)
                        }
                        m_button_background_reader.readAsDataURL(input_m_button_background.files[0]);
                    }
                }
            }
            else{
                $('#button-type-2-background').hide()
            }
            if ($('#is_have_l_button').is(':checked')){
                l_button_background_object = $('#button-m-type-3-background')
                l_button_background_object.show()
                if ($('#info-card-form').attr('action') == '/streamlined_communication/update_info_card' && $('#l_button_image').get(0).files.length === 0){
                    background_url = $('#btn_image_link_l_button').attr('href')
                    l_button_css["background-image"] = "url(" + background_url + ")"
                    l_button_background_object.css(l_button_css)
                }else{
                    if ($('#l_button_image').get(0).files.length > 0){
                        var l_button_background_reader = new FileReader();
                        input_l_button_background = $('#l_button_image')[0]
                        l_button_background_reader.onload = function (e) {
                            l_button_css["background-image"] = "url(" + e.target.result + ")"
                            l_button_background_object.css(l_button_css)
                        }
                        l_button_background_reader.readAsDataURL(input_l_button_background.files[0]);
                    }
                }
            }
            else{
                $('#button-l-type-3-background').hide()
                $('#button-m-type-3-background').hide()
            }


            var y = ['1', '2', '3']
            var removeItem = info_card_type;
            y.splice( $.inArray(removeItem,y) ,1 );
            for (var i=0; i<y.length;i++){
                $('#background-type-'+y[i]).hide()
            }
            $('#background-type-'+info_card_type).show()
            $('#info-card-preview').modal('show');
        })

        // Validation Hex Color
        function validateHexColor(regexp, errors_output) {
            if (!(regexp.test($("#title_text_color").val()))) {
                errors_output == ToastDanger("Error at Title Text Color", "Please use correct hex code, example: #ffffff")
                return false;
            } else if (!(regexp.test($("#body_text_color").val()))) {
                errors_output == ToastDanger("Error at Body Text Color", "Please use correct hex code, example: #ffffff")
                return false;
            } else if (!(regexp.test($("#l_button_text_color").val()))) {
                errors_output == ToastDanger("Error at L Button Text Color", "Please use correct hex code, example: #ffffff")
                return false;
            } else if ($("#l_button_color").val() && !(regexp.test($("#l_button_color").val()))) {
                errors_output == ToastDanger("Error at L Button Color", "Please use correct hex code, example: #ffffff")
                return false;
            } else if (!(regexp.test($("#r_button_text_color").val()))) {
                errors_output == ToastDanger("Error at R Button Text Color", "Please use correct hex code, example: #ffffff")
                return false;
            } else if ($("#r_button_color").val() && !(regexp.test($("#r_button_color").val()))) {
                errors_output == ToastDanger("Error at R Button Color", "Please use correct hex code, example: #ffffff")
                return false;
            } else if (!(regexp.test($("#m_button_text_color").val()))) {
                errors_output == ToastDanger("Error at R Button Text Color", "Please use correct hex code, example: #ffffff")
                return false;
            } else if ($("#m_button_color").val() && !(regexp.test($("#m_button_color").val()))) {
                errors_output == ToastDanger("Error at M Button Color", "Please use correct hex code, example: #ffffff")
                return false;
            } else {
                errors_output == ''
                $('#save_info_card_template').text('Waiting ...').addClass('disabled').attr('disabled', 'disabled')
                var form = $('#info-card-form')[0];
                var expiration_option = $('#expiration_option')
                var expiry_period = ""
                if (expiration_option != "No Expiration Time") {
                    if ($("input[name='expiry_period_unit']:checked").val() == "days") {
                        expiry_period = $("input[name='expiry_period_days']").val()
                    }
                    if ($("input[name='expiry_period_unit']:checked").val() == "hours") {
                        expiry_period = $("input[name='expiry_period_hours']").val()
                    }
                }
                // Create an FormData object
                var data = new FormData(form);

                // If you want to add an extra field for the FormData
                data.append("csrfmiddlewaretoken", $("input[name=csrfmiddlewaretoken]").val());
                data.append("dpd", $('#status_dpd').val());
                data.append("dpd_upper", $('#status_dpd_upper').val());
                data.append("dpd_lower", $('#status_dpd_lower').val());
                data.append("until_paid", $('#until_paid').val());
                data.append("ptp", $('#status_ptp').val());
                data.append("status_code", $('#status_code').val());
                data.append("extra_condition", $('#extra_condition').val());
                data.append("is_have_l_button", $('#is_have_l_button').is(':checked'))
                data.append("is_have_r_button", $('#is_have_r_button').is(':checked'))
                data.append("is_have_m_button", $('#is_have_m_button').is(':checked'))
                data.append("is_shown_in_android", $('#is_shown_in_android').is(':checked'))
                data.append("is_shown_in_webview", $('#is_shown_in_webview').is(':checked'))
                data.append("clickable_card", $('#clickable_card').is(':checked'))
                data.append("content_parameters", $('#info_card_parameters').val())
                data.append("expiry_period", expiry_period)
                data.append("youtube_video_id", $('#youtube_video_id').val())
                data.append("bottom_sheet_destination", $('#bottom_sheet_destination').val())
                $.ajax({
                    url: $('#info-card-form').attr('action'), // the endpoint
                    type: "POST", // http method
                    enctype: 'multipart/form-data',
                    data: data,
                    processData: false,
                    contentType: false,
                    cache: false,
                    // handle a successful response
                    success: function(json) {
                        if (json.success) {
                            ToastSuccess(json.status, "Success Save Info Card");
                            location.reload();
                        } else {
                            ToastDanger(json.status, json.errors);
                            $('#save_info_card_template').text('Save').removeClass('disabled').attr('disabled', false)
                        }
                    },
                    // handle a non-successful response
                    error: function(xhr, errmsg, err) {
                        $('#save_info_card_template').text('Save').removeClass('disabled').attr('disabled', false)
                        swal.close();
                        Object.entries(JSON.parse(xhr.responseText)).forEach(([key, value]) => {
                            message = key + value[0]
                            ToastDanger('Error', message);
                        })
                    }
                });
            }
        }
        $('#save_info_card_template').on('click', function (){
            if ($('#info_card_type').val() == '3' && $('#is_have_r_button').is(':checked') && !$('#is_have_l_button').is(':checked')){
                ToastDanger("Failed Save", "cannot just pick R button for type 3")
                return ''
            }
            // errror output for input color

            if ($('#info_card_type').val() == '9' && !$('#youtube_video_id').val()){
                ToastDanger("Failed Save", "youtube_video_id,This field may not be blank.")
                return ''
            }
            var errors_output = '';
            // function for validate hex color when save_info_card_template
            var validColor = validateHexColor(
                /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{6})$/,
                errors_output
            );
        })

        $('.btnDeleteInfoCard').on('click', function(){
            $('#message-confirmation-modal').html("Are you sure want to delete this card ?")
            streamlined_id = $(this).attr('system-id')
            $('#change_status').val('DELETE')
            $('#streamlined_comm_id').val(streamlined_id)
            $('#confirmation-modal').modal('show');
        })
        $('.info_card_is_active, .infoCardOrder').on('change', function(){
            streamlined_id = $(this).attr('system-id')
            if (streamlined_id == undefined){
                streamlined_id = $(this).attr('system_id')
            }

            current_val = $('#updated_info_card_ids').val()
            if (current_val.length == 0){
                $('#updated_info_card_ids').val(streamlined_id)
                return ''
            }
            current_val_array = current_val.split(',')
            if (current_val_array.indexOf(streamlined_id) > -1 != true){
                current_val_array.push(streamlined_id)
            }
            $('#updated_info_card_ids').val(current_val_array.join(','))
            {#$('#changed_value').val($(this).is(':checked'))#}
            {#$('#streamlined_comm_id').val(streamlined_id)#}
            {#$('#change_status').val('IS_ACTIVE')#}
            {#$('#message-confirmation-modal').html("Are you sure want to change this?")#}
            {#$('#confirmation-modal').modal('show');#}
        })

        $('.btnEditInfoCard').click(function (e) {
            itm_id = $(this).attr('system-id');
            clear_info_card()
            $("#info-card-form").trigger("reset");
            $('#info_card_id').val(itm_id)
            $.ajax({
                url :  "{%url 'streamlined:get_info_card_property' %}/", // the endpoint
                type : "GET", // http method
                data : {
                    streamlined_communication_id: itm_id,
                },
                success : function(json) {
                    if (json.data.status == "Success") {
                        info_card = json.data.info_card_property
                        buttons = info_card.buttons
                        $('#info_card_template_code').val(info_card.template_code)

                        $('.expiration-option-input').hide();
                        $('.expiration-option-readonly').removeClass('hide');
                        $('textarea[name="info-card-expiration-option-data"]').val(info_card.expiration_option_data)
                        $('#info_card_type').val(info_card.card_type.substring(0, 1)).trigger('change')
                        $('#info_card_product').val((info_card.product) ? info_card.product:'J1').trigger('change')
                        if (info_card.card_action != null){
                            $('input[name="card_action"][value="'+info_card.card_action+'"]').prop('checked', true).trigger('click')
                            $('#clickable_card').prop('checked', true).trigger('change')
                            if (info_card.card_action=='app_deeplink'){
                                $('#info_card_destination_deep_link').val(info_card.card_destination)
                            }else if(info_card.card_action=='webpage'){
                                $('#info_card_destination_web').val(info_card.card_destination)
                            }else {
                                $('#info_card_destination_redirect').val(info_card.card_destination)
                            }
                        }
                        $('#btn_image_link_card_background').attr('href', info_card.card_background_image_url).show()
                        $('#btn_image_link_card_optional_image').attr('href', info_card.card_optional_image_url).show()
                        for(var i=0; i<buttons.length;i++){
                            button = buttons[i]
                            if (button.button_name=='L.BUTTON'){
                                $('#is_have_l_button').prop('checked', true).trigger('change')
                                $('#l_button_text').val(button.button_text)
                                $('#l_button_text_color').val(button.text_color).trigger('change')
                                $('#l_button_color').val(button.button_color).trigger('change')
                                $('input[name="l_button_action"][value="'+button.button_action+'"]').prop('checked', true).trigger('click')
                                if (button.button_action=='app_deeplink'){
                                    $('#l_button_destination_deep_link').val(button.destination)
                                }else if (button.button_action=='webpage'){
                                    $('#l_button_destination_web').val(button.destination)
                                }else{
                                    $('#l_button_destination_redirect').val(button.destination)
                                }
                                {#$('#btn_delete_image_l_button').show()#}
                                $('#btn_image_link_l_button').attr('href', button.background_image_url).show()
                            }
                            else if (button.button_name=='M.BUTTON'){
                                $('#is_have_m_button').prop('checked', true).trigger('change')
                                $('#m_button_text').val(button.button_text)
                                $('#m_button_text_color').val(button.text_color).trigger('change')
                                $('#m_button_color').val(button.button_color).trigger('change')
                                $('input[name="m_button_action"][value="'+button.button_action+'"]').prop('checked', true).trigger('click')
                                if (button.button_action=='app_deeplink'){
                                    $('#m_button_destination_deep_link').val(button.destination)
                                }else if(button.button_action=='webpage'){
                                    $('#m_button_destination_web').val(button.destination)
                                }else if(button.button_action=='reload'){
                                    $('#m_button_destination_reload').val(button.destination)
                                }else{
                                    $('#m_button_destination_redirect').val(button.destination)
                                }
                                {#$('#btn_delete_image_m_button').show()#}
                                $('#btn_image_link_m_button').attr('href', button.background_image_url).show()
                            }
                            else if (button.button_name=='R.BUTTON'){
                                $('#is_have_r_button').prop('checked', true).trigger('change')
                                $('#r_button_text').val(button.button_text)
                                $('#r_button_text_color').val(button.text_color).trigger('change')
                                $('#r_button_color').val(button.button_color).trigger('change')
                                $('input[name="r_button_action"][value="'+button.button_action+'"]').prop('checked', true).trigger('click')
                                if (button.button_action=='app_deeplink'){
                                    $('#r_button_destination_deep_link').val(button.destination)
                                }else if(button.button_action=='webpage'){
                                    $('#r_button_destination_web').val(button.destination)
                                }else {
                                    $('#r_button_destination_redirect').val(button.destination)
                                }
                                {#$('#btn_delete_image_r_button').show()#}
                                $('#btn_image_link_r_button').attr('href', button.background_image_url).show()
                            }
                        }
                        $("#is_shown_in_android").prop('checked', info_card.is_shown_in_android === true)
                        $("#is_shown_in_webview").prop('checked', info_card.is_shown_in_web === true)
                        $('#info_card_title').val(info_card.title)
                        $('#title_text_color').val(info_card.title_color).trigger('change')
                        $('#info_card_content').val(info_card.content)
                        $('#body_text_color').val(info_card.text_color).trigger('change')
                        $('#info_card_parameters').multiSelect('deselect_all');
                        var str = $.trim($('#infoCardCalledParameter-'+itm_id).text()).replace('{','').replace('}','').split(",")
                        new_str = [];
                        for(i = 0; i < str.length; i++) {
                            new_str[i]= str[i].trim();
                        }
                        $('#info_card_parameters').multiSelect('select', new_str);
                        $('#youtube_video_id').val(info_card.youtube_video_id)
                        $('#bottom_sheet_destination').val(info_card.bottom_sheet_destination)
                        $('.info_card_form_title').text('Edit Info Card');
                        $('#info-card-form').attr('action', "{%url 'streamlined:update_info_card' %}")
                        $('#confirm_call_parameter').modal('hide');
                        $('#add-edit-info-card').modal('show');
                    }
                }
            })
        })
        $('#btn_delete_image_r_button').click(function (){
            $('#btn_image_link_r_button').hide()
        })
        $('#btnConfirmationModel').click(function (){

            url = "{%url 'streamlined:info_card_update_ordering_and_activate' %}/"
            if ($('#change_status').val() == 'DELETE'){
                url = "{%url 'streamlined:delete_info_card' %}/"
            }

            $.ajax({
                url :  url, // the endpoint
                type : "POST", // http method
                data : {
                    csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val(),
                    update_type:$('#change_status').val(),
                    streamlined_communication_id: $('#streamlined_comm_id').val(),
                    changed_value: $('#changed_value').val(),
                    dpd: parseInt($('#status_dpd').val()),
                    ptp: parseInt($('#status_ptp').val()),
                    dpd_upper: parseInt($('#status_dpd_upper').val()),
                    dpd_lower: parseInt($('#status_dpd_lower').val()),
                    until_paid: parseInt($('#until_paid').val()),
                    status_code: $('#status_code').val(),
                    extra_condition: $('#extra_condition').val(),
                }, // data sent with the post request
                // handle a successful response
                success : function(json) {
                    swal.close();
                    if(json.data.status == "Success") {
                        ToastSuccess(json.data.status, json.data.message);
                    } else {
                       ToastDanger(json.data.status, json.data.message);
                    }
                    $('#confirmation-modal').modal('hide');
                    if ($('#change_status').val() == 'DELETE'){
                        location.reload();
                    }
                },
                // handle a non-successful response
                error : function(xhr,errmsg,err) {
                    swal.close();
                    console.log(xhr.status + ": " + xhr.responseText);
                    ToastDanger('Error', 'some error occured!');
                }
            });
        })
        $('#l_button_image').on('change', function (){
            $('#is_button_l_background_changes').val(true)
        })
        $('#m_button_image').on('change', function (){
            $('#is_button_m_background_changes').val(true)
        })
        $('#r_button_image').on('change', function (){
            $('#is_button_r_background_changes').val(true)
        })
        $('#background_card_image').on('change', function (){
            $('#is_background_changes').val(true)
        })
        $('#optional_image').on('change', function (){
            $('#is_optional_image_changes').val(true)
        })
        function clear_info_card(){
            $('.clickable_section').hide()
            $('.l_button_section').hide()
            $('.r_button_section').hide()
            $('.m_button_section').hide()
            $('.expiration-option-readonly').addClass('hide');
            $('.expiration-option-input').show();
            $('.expiration-period-input-section').hide();
            //$('.label-destination').hide()
            //$('.destination-input').hide()
            $('.edit-section').hide()
            $('#feature_checkbox_for_info_card').hide()
        }
        function submit_change_card_order (){
            var form = $('#info-card-order-form')[0];
           // Create an FormData object
            var data = new FormData(form);
           // If you want to add an extra field for the FormData
            data.append("csrfmiddlewaretoken", $("input[name=csrfmiddlewaretoken]").val());
            $.ajax({
                url :  "{%url 'streamlined:info_card_update_ordering_and_activate' %}/", // the endpoint
                type : "POST", // http method
                enctype: 'multipart/form-data',
                data: data,
                processData: false,
                contentType: false,
                cache: false,
                // handle a successful response
                success : function(json) {
                    swal.close();
                    if(json.data.status == "Success") {
                        ToastSuccess(json.data.status, json.data.message);
                    } else {
                       ToastDanger(json.data.status, json.data.message);
                    }
                    $('#form-status').submit()
                },
                // handle a non-successful response
                error : function(xhr,errmsg,err) {
                    swal.close();
                    console.log(xhr.status + ": " + xhr.responseText);
                    ToastDanger('Error', 'some error occured!');
                }
            });
        }

      $("#pn_image_preview_div button").click(function(e) {
            streamlined_id = $('#pn_msg_id').val();
            $('#streamlined_comm_id').val(streamlined_id);
            if ($('#confirmation-pn-image-delete').hasClass('in')) {
                $('#confirmation-pn-image-delete').css("display", "block");
            }
            else {
                $('#confirmation-pn-image-delete').modal('show');
            }
             e.preventDefault();
      });

        function readURL(e) {
            if (this.files && this.files[0]) {
                var reader = new FileReader();
                $(reader).load(function(e) {
                    $('#btn_image_link_pn_image').attr('src', e.target.result);
                    $('#btn_image_link_pn_image').attr('data-is-added', true);
                    e.preventDefault();
                });
                $('#pn_image_preview_div').show()
                $('#pn_image_status').val("");
                reader.readAsDataURL(this.files[0]);
            }
        }

        $("#pn_image").change(readURL);

        function debugBase64(base64URL){
            var win = window.open();
            win.document.write('<iframe src="' + base64URL  + '" frameborder="0" style="border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen></iframe>');
        }

        $(document).ready(function() {
            $('#btn_image_link_pn_image').click(function() {
                is_added = $('#btn_image_link_pn_image').data('isAdded') //data-is-added=True
                if (is_added == true) {
                    if ($(this).attr('src')) {
                      debugBase64($(this).attr('src'))
                    }
                    return
                }
                // For edit
                else {
                    if ($('#btn_image_link_pn_image').attr("src"))  {
                      var image = new Image();
                      image.src = $('#btn_image_link_pn_image').attr("src");
                      var w = window.open("");
                      w.document.write(image.outerHTML);
                    }
                }
            });
        })

        $('#btnPNConfirmationModel').click(function (e) {
            $('#pn_image_status').val("Delete");
            $('#pn_image_preview_div').hide()
            $('#pn_image').val('');
            $('#confirmation-pn-image-delete').hide();
        })

        $('#add-edit-pn').on('hidden.bs.modal', function () {
            if ($("#confirmation-pn-image-delete").css("display") =='none') {
                $('.modal-backdrop').remove();
            }
        })

        $('#close_pn_form').click(function (e) {
            $('#add-edit-pn_form')[0].reset();
        })
        $('#close_widgetduedate_form').click(function (e) {
            $('#add-edit-widgetduedate')[0].reset();
        })

        $("#infoCardPreviewCloseButton").click(function (e) {
            e.preventDefault();
            if ($("#youtube_iframe").attr('src')){
                $("#youtube_iframe").attr("src", '');
            }
        });
        // WIDGET DUE DATE

        $('.clickable').hover(
            function() {
                // mouse enter
                $(this).addClass('highlight')
            },
            function() {
                // mouse leave
                $('.clickable').removeClass('highlight')
            }
        )
        $('.clickable-inside').hover(
            function() {
                // mouse enter
                $('.clickable').removeClass('highlight')
                $(this).addClass('highlight')
            },
            function() {
                // mouse leave
                if ($('.widget-bot').is(':hover')){
                    $('.widget-bot').addClass('highlight')
                }
                if ($('.widget-top').is(':hover')){
                    $('.widget-top').addClass('highlight')
                }
                $(this).removeClass('highlight')
            }
        )

        $('.clickable-card-text-color').click(
            function() {
                // $('#widgetduedate-card-text-color').focus()
                $('#widgetduedate-info-text-color-input').click()
            }
        )
        $('.clickable-info-text-color').click(
            function() {
                // $('#widgetduedate-info-text-color').focus()
                $('#widgetduedate-info-text-color-input').click()
            }
        )
        $('.clickable-info-color').click(
            function() {
                if ($(this).hasClass('highlight')){
                    // $('#widgetduedate-info-color').focus()
                    $('#widgetduedate-info-color-input').click()
                }
            }
        )
        $('.clickable-card-color').click(
            function() {
                if ($(this).hasClass('highlight')){
                    // $('#widgetduedate-card-color').focus()
                    $('#widgetduedate-card-color-input').click()
                }
            }
        )
        // FORM WIDGET DUE DATE

        function pickerIdToClassColorMapper(elementId) {
            const stringArray = elementId.split('-')
            stringArray.shift()
            stringArray.pop()
            return {
                type: stringArray[1],
                className: `clickable-${stringArray.join('-')}-color`,
            }
        }

        function changeBackgroundColor(className, color, type) {
            if (type === 'text') {
                $(`.${className}`).css('color', color);
            } else {
                $(`.${className}`).css('background', color);
            }
        }

        // event listener from color to text
        $('.color-picker').on('input', function() {
            const id = $(this).attr('id').replace('-input', '');
            const color = $(this).val();
            $(`#${id}`).val(color);
            const {type, className} = pickerIdToClassColorMapper(id)
            changeBackgroundColor(className, color, type)
        })

        // event listener from text to color
        $('.color-picker-text').on('input', function() {
            const id = $(this).attr('id');
            const color = $(this).val();
            const {type, className} = pickerIdToClassColorMapper(id)
            changeBackgroundColor(className, color, type)
            if (/^#[0-9A-F]{6}$/i.test(color)) {
                $(`#${id}-input`).val(color);
            }
        })

        // event listener to update description
        $('#widgetduedate_description').on('input', function() {
            $('.clickable-info-text-color').text($(this).val())
        })

        // event listener to update img
        $('#widgetduedate_image').on('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    $('#widgetduedate_image_preview_div').attr('src', e.target.result);
                    $('#widgetduedate_image_preview_div').attr('data-is-added', true);
                    $('#widget-icon-content-img').attr('src', e.target.result);
                    e.preventDefault();
                }
                $('#is_widgetduedate_image_changes').val('true');
                reader.readAsDataURL(file);
            }
        });

        $('#widgetduedate_image_desc').on('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    $('#widgetduedate_image_desc_preview_div').attr('src', e.target.result);
                    $('#widgetduedate_image_desc_preview_div').attr('data-is-added', true);
                    $('#widget-icon-desc-img').attr('src', e.target.result);
                    e.preventDefault();
                }
                $('#is_widgetduedate_image_desc_changes').val('true');
                reader.readAsDataURL(file);
            }
        });

        $('.clickable-icon').on('click', function() {
            $('#widgetduedate_image').click()
        })

        $('.clickable-icon-desc').on('click', function() {
            $('#widgetduedate_image_desc').click()
        })

    });

{% endblock %}
{# </script>#}
