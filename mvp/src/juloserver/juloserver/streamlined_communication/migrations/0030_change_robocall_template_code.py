# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2020-02-16 15:52
from __future__ import unicode_literals
from django.db import migrations, models
import django.contrib.postgres.fields
from juloserver.streamlined_communication.constant import CommunicationPlatform

def update_robocall_template(apps, schema_editor):

    StreamlinedCommunication = apps.get_model("streamlined_communication", "StreamlinedCommunication")
    StreamlinedMessage = apps.get_model("streamlined_communication", "StreamlinedMessage")

    StreamlinedCommunication.objects. \
        filter(communication_platform=CommunicationPlatform.ROBOCALL,
               template_code='voice_reminder_T-3_MTL',
               dpd=-3).update(template_code='nexmo_robocall_mtl_-3')
    StreamlinedCommunication.objects. \
        filter(communication_platform=CommunicationPlatform.ROBOCALL,
               template_code='voice_reminder_T-3_STL',
               dpd=-3).update(template_code='nexmo_robocall_stl_-3')
    StreamlinedCommunication.objects. \
        filter(communication_platform=CommunicationPlatform.ROBOCALL,
               template_code='voice_reminder_T-5_STL',
               dpd=-5).update(template_code='nexmo_robocall_stl_-5')
    StreamlinedCommunication.objects. \
        filter(communication_platform=CommunicationPlatform.ROBOCALL,
               template_code='voice_reminder_T-5_MTL',
               dpd=-5).update(template_code='nexmo_robocall_mtl_-5')

    StreamlinedCommunication.objects. \
        filter(communication_platform=CommunicationPlatform.ROBOCALL,
               template_code='voice_reminder_T-3_PEDEMTL',
               dpd=-3).update(template_code='nexmo_robocall_PEDEMTL_-3')
    StreamlinedCommunication.objects. \
        filter(communication_platform=CommunicationPlatform.ROBOCALL,
               template_code='voice_reminder_T-3_PEDESTL',
               dpd=-3).update(template_code='nexmo_robocall_PEDESTL_-3')
    StreamlinedCommunication.objects. \
        filter(communication_platform=CommunicationPlatform.ROBOCALL,
               template_code='voice_reminder_T-5_PEDESTL',
               dpd=-5).update(template_code='nexmo_robocall_PEDESTL_-5')
    StreamlinedCommunication.objects. \
        filter(communication_platform=CommunicationPlatform.ROBOCALL,
               template_code='voice_reminder_T-5_PEDEMTL',
               dpd=-5).update(template_code='nexmo_robocall_PEDEMTL_-5')


class Migration(migrations.Migration):
    dependencies = [
        ('streamlined_communication', '0029_change_automated_status_stream_lined_communication'),
    ]

    operations = [
        migrations.RunPython(update_robocall_template,
                             migrations.RunPython.noop)
    ]
