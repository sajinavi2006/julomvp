# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2023-12-27 05:34
from __future__ import unicode_literals

from django.db import migrations
from juloserver.julo.models import Image

from juloserver.streamlined_communication.models import NeoInfoCard

def create_image(image_source_id, image_type, image_url):
    image = Image()
    image.image_source = image_source_id
    image.image_type = image_type
    image.url = image_url
    image.save()

def retroload_neo_info_card_j1(_apps, _schema_editor):
    info_card = {
        'statuses': '[105_C_SCORE,133,135_CANNOT_REAPPLY,106_CANNOT_REAPPLY]',
        'product': 'J1',
        'image_url': 'neo-info-card/rejected-infocard-2.jpg',
        'priority': 1,
        'is_active': True,
    }

    neo_info_card = NeoInfoCard.objects.create(**info_card)
    create_image(neo_info_card.id, 'NEO_INFO_CARD_IMAGE', info_card['image_url'])

    current_info_card = NeoInfoCard.objects.filter(
        statuses='[105_C_SCORE,133,135_REAPPLY,135_CANNOT_REAPPLY]',
        image_url='neo-info-card/rejected-infocard.jpg',
    ).first()
    if current_info_card:
        current_info_card.update_safely(priority=2)


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(retroload_neo_info_card_j1, migrations.RunPython.noop),
    ]
