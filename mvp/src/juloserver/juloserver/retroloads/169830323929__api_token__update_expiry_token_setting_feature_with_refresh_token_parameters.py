# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2023-10-26 06:53
from __future__ import unicode_literals

from django.db import migrations

from juloserver.julo.models import FeatureSetting
from juloserver.julo.constants import FeatureNameConst

from juloserver.api_token.constants import (
    REFRESH_TOKEN_EXPIRY,
    REFRESH_TOKEN_MIN_APP_VERSION,
    EXPIRY_SETTING_KEYWORD
)


def update_expiry_token_feature_setting(apps, _schema_editor):
    feature_setting = FeatureSetting.objects.get(
        feature_name=FeatureNameConst.EXPIRY_TOKEN_SETTING,
    )
    feature_setting.parameters.pop('expiry_token_days', None)
    feature_setting.parameters.update(
        {
            EXPIRY_SETTING_KEYWORD: 720,
            REFRESH_TOKEN_EXPIRY: 8760,
            REFRESH_TOKEN_MIN_APP_VERSION: '8.23.0'
        }
    )

    feature_setting.save()


class Migration(migrations.Migration):
    dependencies = [
    ]

    operations = [
        migrations.RunPython(update_expiry_token_feature_setting, migrations.RunPython.noop)
    ]
