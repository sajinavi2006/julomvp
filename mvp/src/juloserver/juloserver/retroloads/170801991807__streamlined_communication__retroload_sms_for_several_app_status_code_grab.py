# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2024-02-15 08:14
from __future__ import unicode_literals

from django.db import migrations
from juloserver.streamlined_communication.models import (
       StreamlinedCommunication,
       StreamlinedMessage)
from juloserver.streamlined_communication.constant import (
       CommunicationPlatform)
from juloserver.julo.models import StatusLookup
from juloserver.julo.statuses import ApplicationStatusCodes
from juloserver.streamlined_communication.constant import Product
from juloserver.grab.constants import GrabSMSTemplateCodes


def create_grab_streamlined_comms(apps, schema_editor):
    # SMS
    status = StatusLookup.objects.filter(status_code=ApplicationStatusCodes.FORM_CREATED).last()
    sms_100 = StreamlinedMessage.objects.create(
        message_content="Hai {{sms_firstname}}, "
                        "Sedikit lagi kamu bisa gunakan limit GrabModal kamu! Yuk, "
                        "lanjutkan registrasi sebelum pendaftarannya kedaluwarsa 24 jam lagi.",
        parameter="{sms_firstname}"
    )

    streamlined_communication_for_sms_100 = StreamlinedCommunication.objects.get_or_create(
        message=sms_100,
        communication_platform=CommunicationPlatform.SMS,
        template_code=GrabSMSTemplateCodes.GRAB_SMS_APP_100_EXPIRE_IN_ONE_DAY,
        description="this SMS is sent to inform ,"
                    "when user is in 100 but their application is going to be expired in 1 day",
        type='Information',
        status_code=status,
        status=ApplicationStatusCodes.FORM_CREATED,
        product=Product.SMS.GRAB
    )
    status = StatusLookup.objects.filter(status_code=ApplicationStatusCodes.LOC_APPROVED).last()
    sms_digisign = StreamlinedMessage.objects.create(
        message_content="Selamat, {{sms_firstname}}! Pinjaman GrabModal kamu disetujui. "
                        "Untuk gunakan limitmu, tanda tangan SKRTP dulu dengan klik "
                        "link https://grab.julo.co.id",
        parameter="{sms_firstname}"
    )

    streamlined_communication_for_sms_digisign = StreamlinedCommunication.objects.get_or_create(
        message=sms_digisign,
        communication_platform=CommunicationPlatform.SMS,
        template_code=GrabSMSTemplateCodes.GRAB_SMS_FOR_PROVIDE_DEGISIGN,
        description="this SMS is sent to inform ,"
                    "when user needs to provide digisign",
        type='Information',
        status_code=status,
        status=ApplicationStatusCodes.LOC_APPROVED,
        product=Product.SMS.GRAB
    )
    status = StatusLookup.objects.filter(status_code=ApplicationStatusCodes.APPLICATION_RESUBMISSION_REQUESTED).last()
    sms_131 = StreamlinedMessage.objects.create(
        message_content="Hi Mitra Grab, lengkapi dokumen GrabModal Narik powered by "
                        "JULO https://grab.julo.co.id/home sblm pengajuan kadaluarsa dlm 48 jam. "
                        "Bth bantuan hub cs@julo.co.id",
        parameter="{sms_firstname}"
    )

    streamlined_communication_for_sms_131 = StreamlinedCommunication.objects.get_or_create(
        message=sms_131,
        communication_platform=CommunicationPlatform.SMS,
        template_code=GrabSMSTemplateCodes.GRAB_SMS_APP_AT_131,
        description="this SMS is sent to inform ,"
                    "when user enter status 131",
        type='Information',
        status_code=status,
        status=ApplicationStatusCodes.APPLICATION_RESUBMISSION_REQUESTED,
        product=Product.SMS.GRAB
    )

    sms_131_for_24_hour = StreamlinedMessage.objects.create(
        message_content="Hi Mitra Grab, lengkapi dokumen GrabModal Narik "
                        "powered by JULO https://grab.julo.co.id/home "
                        "sblm pengajuan kadaluarsa dlm 48 jam. Bth bantuan hub cs@julo.co.id",
        parameter="{sms_firstname}"
    )

    streamlined_communication_for_sms_131_for_24_hour = StreamlinedCommunication.objects.get_or_create(
        message=sms_131_for_24_hour,
        communication_platform=CommunicationPlatform.SMS,
        template_code=GrabSMSTemplateCodes.GRAB_SMS_APP_AT_131_FOR_24_HOUR,
        description="this SMS is sent to inform ,"
                    "when user is in status 131 and they are already in 131 for 24 hour",
        type='Information',
        status_code=status,
        status=ApplicationStatusCodes.APPLICATION_RESUBMISSION_REQUESTED,
        product=Product.SMS.GRAB
    )


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(
            create_grab_streamlined_comms, migrations.RunPython.noop),
    ]
