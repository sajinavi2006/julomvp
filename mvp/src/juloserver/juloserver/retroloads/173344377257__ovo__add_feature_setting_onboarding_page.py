# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2024-12-06 00:09
from __future__ import unicode_literals

from django.conf import settings
from django.db import migrations

from juloserver.julo.constants import FeatureNameConst
from juloserver.julo.models import FeatureSetting, PaymentMethodLookup
from juloserver.julo.payment_methods import PaymentMethodCodes
from django_bulk_update.helper import bulk_update


def create_feature_settings_ovo_onboarding_page(apps, _schema_editor):
    base_url = settings.STATIC_URL + 'images/new_payment_methods/'

    FeatureSetting.objects.create(
        feature_name=FeatureNameConst.OVO_TOKENIZATION_ONBOARDING,
        parameters=[
            {
                'benefit_title': 'Bayar Anti Ribet',
                'benefit_content': 'Tak perlu keluar rumah, pembayaran cukup dari HP kamu saja!',
                'benefit_icon': base_url + 'ovo/benefit_content/bayar+anti+ribet.png',
            },
            {
                'benefit_title': 'Proses Cepat',
                'benefit_content': 'Pembayaran dapat selesai hanya dalam 2 langkah!',
                'benefit_icon': base_url + 'ovo/benefit_content/proses+cepat.png',
            },
            {
                'benefit_title': 'Saldo OVO Langsung Terlihat',
                'benefit_content': 'Tak perlu buka aplikasi OVO untuk lihat saldo OVO kamu!',
                'benefit_icon': base_url + 'ovo/benefit_content/ovo+viewable+balance.png',
            },
        ],
        is_active=True,
        category='repayment',
        description='OVO onboarding page',
    )

    ovo_payment_method_lookups = PaymentMethodLookup.objects.filter(
        code__in=(PaymentMethodCodes.OVO_TOKENIZATION, PaymentMethodCodes.OVO)
    )

    payment_method_lookup_data = []
    for ovo_payment_method_lookup in ovo_payment_method_lookups.iterator():
        ovo_payment_method_lookup.image_logo_url_v2 = base_url + 'ovo/ovo.png'

        payment_method_lookup_data.append(ovo_payment_method_lookup)

    bulk_update(payment_method_lookup_data, update_fields=['image_logo_url_v2'])


class Migration(migrations.Migration):

    dependencies = []

    operations = [
        migrations.RunPython(
            create_feature_settings_ovo_onboarding_page, migrations.RunPython.noop
        ),
    ]
