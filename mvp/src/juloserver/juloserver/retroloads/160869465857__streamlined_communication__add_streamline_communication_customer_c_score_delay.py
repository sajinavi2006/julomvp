# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2020-12-23 03:37
from __future__ import unicode_literals

from django.db import migrations
from juloserver.streamlined_communication.constant import CommunicationPlatform, CardProperty
from juloserver.streamlined_communication.models import (
    StreamlinedCommunication, StreamlinedMessage, InfoCardProperty)


def add_j1_info_card_c_score_delay(app, schema_editor):
    button_2_properties = {'card_type': '2',
                           'title': 'Dalam proses verifikasi ' + '\U000023F3',
                           'title_color': '#ffffff',
                           'text_color': '#ffffff',
                           'card_order_number': 1}
    info_card_property = InfoCardProperty.objects.filter(**button_2_properties).last()
    if not info_card_property:
        info_card_property = InfoCardProperty.objects.create(**button_2_properties)
    data_streamlined_message = {
        'info_card_property': info_card_property,
        'message_content': 'Data pengajuan Anda telah diterima dan sedang diverifikasi. '
                   'Silahkan kembali dalam satu hari kerja untuk memeriksa '
                   'status pengajuan Anda.'
    }

    message = StreamlinedMessage.objects.filter(**data_streamlined_message).last()
    if not message:
        message = StreamlinedMessage.objects.create(**data_streamlined_message)

    stl_communication = StreamlinedCommunication.objects.filter(
        communication_platform=CommunicationPlatform.INFO_CARD,
        status_code_id=105,
        extra_conditions=CardProperty.CUSTOMER_HAVE_LOW_SCORE_OR_C_WITH_DElAY,
        is_active=True,
        description='delay for C score',
        message=message
    ).last()
    if not stl_communication:
        StreamlinedCommunication.objects.create(
            communication_platform=CommunicationPlatform.INFO_CARD,
            status_code_id=105,
            extra_conditions=CardProperty.CUSTOMER_HAVE_LOW_SCORE_OR_C_WITH_DElAY,
            is_active=True,
            description='delay for C score',
            message=message
        )


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(add_j1_info_card_c_score_delay, migrations.RunPython.noop)
    ]
