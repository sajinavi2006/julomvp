# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2025-01-30 02:39
from __future__ import unicode_literals

from django.db import migrations

from juloserver.julo.models import Partner
from juloserver.partnership.constants import PartnershipFlag
from juloserver.partnership.models import PartnershipFlowFlag
from juloserver.application_flow.constants import PartnerNameConstant


def add_leadgen_standard_product_bank_validation_config(apps, schema_editor):
    list_partner_name = {
        PartnerNameConstant.IOH_BIMA_PLUS,
        PartnerNameConstant.IOH_MYIM3,
        PartnerNameConstant.SMARTFREN,
        PartnerNameConstant.SELLURY,
        PartnerNameConstant.CERMATI,
    }
    partners = Partner.objects.filter(name__in=list_partner_name).values_list('id', flat=True)

    if not partners:
        return

    data_to_insert = []
    for partner_id in partners:
        data_to_insert.append(
            PartnershipFlowFlag(
                partner_id=partner_id,
                name=PartnershipFlag.PAYMENT_GATEWAY_SERVICE,
                configs={'payment_gateway_service': False},
            )
        )

    if data_to_insert:
        PartnershipFlowFlag.objects.bulk_create(data_to_insert)


class Migration(migrations.Migration):

    dependencies = []

    operations = [
        migrations.RunPython(
            add_leadgen_standard_product_bank_validation_config, migrations.RunPython.noop
        )
    ]
