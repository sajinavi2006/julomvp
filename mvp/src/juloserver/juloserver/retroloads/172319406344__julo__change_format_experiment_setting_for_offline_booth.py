# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2024-08-09 09:01
from __future__ import unicode_literals

from django.db import migrations
from juloserver.julo.constants import ExperimentConst
from juloserver.julo.models import ExperimentSetting


def execute(apps, schema_editor):

    new_structure = []

    experiment_setting = ExperimentSetting.objects.filter(
        code=ExperimentConst.OFFLINE_ACTIVATION_REFERRAL_CODE
    ).last()
    if experiment_setting:
        criteria = experiment_setting.criteria
        referral_code = criteria.get('referral_code')
        new_structure.append(referral_code)

        criteria.update({'referral_code': new_structure})
        experiment_setting.update_safely(criteria=criteria)


class Migration(migrations.Migration):

    dependencies = []

    operations = [
        migrations.RunPython(execute, migrations.RunPython.noop),
    ]
