# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2022-07-14 09:19
from __future__ import unicode_literals

from django.db import migrations
from django.utils import timezone

from juloserver.julo.models import FeatureSetting
from juloserver.channeling_loan.constants import (
    FeatureNameConst as ChannelingFeatureNameConst,
    BSSChannelingConst,
)


def add_bss_channeling_force_update_feature_setting(apps, schema_editor):
    FeatureSetting.objects.update_or_create(
        feature_name=ChannelingFeatureNameConst.FORCE_UPDATE_BSS_CHANNELING_ELIGIBLE_STATUS,
        is_active=True,
        parameters={
            'max_timestamp': timezone.localtime(timezone.now()).strftime(BSSChannelingConst.DATE_STRING_FORMAT)
        },
        description='Handle force update bss_eligible flag',
        category="bss_channeling"
    )

    FeatureSetting.objects.update_or_create(
        feature_name=ChannelingFeatureNameConst.BSS_CHANNELING_RISK_ACCEPTANCE_CRITERIA,
        is_active=True,
        parameters={
            'JOBTYPE': ["Pegawai swasta", "Pegawai negeri", "Pengusaha"],
            'MINAGE': 21,
            'MAXAGE': 59,
            'MINWORKTIME': 3,
            'MININCOME': 2000000,
            'MINLOAN': 500000,
            'MAXLOAN': 15000000,
            'TENOR': "Monthly",
            'MINTENOR': 1,
            'MAXTENOR': 9,
            'MAXRATIO': 0.3,
        },
        description='Set RAC parameterize, so it can be easy to maintain',
        category="bss_channeling"
    )


class Migration(migrations.Migration):
    dependencies = [
    ]

    operations = [
        migrations.RunPython(
            add_bss_channeling_force_update_feature_setting, migrations.RunPython.noop
        ),
    ]
