# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2023-01-02 03:44
from __future__ import unicode_literals

from django.db import (
    migrations,
    transaction,
)

from juloserver.julo.statuses import LoanStatusCodes
from juloserver.streamlined_communication.constant import (
    CommunicationPlatform,
    CommunicationTypeConst,
    TemplateCode,
)
from juloserver.streamlined_communication.models import (
    StreamlinedCommunication,
    StreamlinedMessage,
)


@transaction.atomic()
def create_streamlined_communication_fraud_ato_device_change(*args):
    message = StreamlinedMessage.objects.create(
        message_content=(
            'Sepertinya akunmu bermasalah dan perlu diverifikasi ulang.' 
            'Hubungi CS untuk memulai prosesnya, ya!'
        ),
    )
    StreamlinedCommunication.objects.create(
        subject='Transaksimu Gagal',
        heading_title=' ',
        description='This PN is sent when Fraud ATO device change triggered in loan_submission',
        template_code=TemplateCode.FRAUD_ATO_DEVICE_CHANGE_BLOCK,
        message=message,
        communication_platform=CommunicationPlatform.PN,
        type=CommunicationTypeConst.INFORMATION,
        status_code_id=LoanStatusCodes.INACTIVE,
        is_active=True,
        is_automated=True,
        show_in_web=False,
        show_in_android=False,
        time_sent=None,
    )


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(
            create_streamlined_communication_fraud_ato_device_change,
            migrations.RunPython.noop
        )
    ]
