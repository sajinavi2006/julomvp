# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2021-11-05 07:32
from __future__ import unicode_literals

from django.db import migrations
from juloserver.julo.models import FeatureSetting
from juloserver.julo.constants import FeatureNameConst


def enhance_params_feature_settings_campaign_190(app, scheme_editor):
    """
    Basically make the parameters look kinda like this:
    {
        "start_date": "2021-12-23",
        "end_date": "2021-12-28",
        "money_change_reason": "promo_cashback_oct_2021",
        "segments": {
            "seg1": {"campaign_code": "Campaign190_segment1","cashback_amount": 100, "min_loan": 100},
            "seg2": {"campaign_code": "Campaign190_segment2", "cashback_amount": 3000, "min_loan": 100},
            "seg3": {...},
            "seg4": {...}
        }
    }
    """
    campaign_190 = FeatureSetting.objects.filter(
        is_active=True,
        feature_name=FeatureNameConst.CAMPAIGN_190_SETTINGS
    ).first()

    if not campaign_190:
        return

    segments = {
        "seg1": {
            "campaign_code": "Campaign190_segment1",
            "cashback_amount": 10000,
            "min_loan": 100000
        },
        "seg2": {
            "campaign_code": "Campaign190_segment2",
            "cashback_amount": 10000,
            "min_loan": 500000
        },
        "seg3": {
            "campaign_code": "Campaign190_segment3",
            "cashback_amount": 10000,
            "min_loan": 750000
        },
        "seg4": {
            "campaign_code": "Campaign190_segment4",
            "cashback_amount": 10000,
            "min_loan": 1000000
        },
    } 
        
    campaign_190.description = "Customize campaign 190 settings with various params"
    campaign_190.parameters = {}
    campaign_190.parameters['start_date'] = "2021-12-23" 
    campaign_190.parameters['end_date'] = "2021-12-28" 
    campaign_190.parameters['money_change_reason'] = "promo_cashback_oct_2021" 
    campaign_190.parameters['segments'] = segments

    campaign_190.save()


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(enhance_params_feature_settings_campaign_190, migrations.RunPython.noop)
    ]
