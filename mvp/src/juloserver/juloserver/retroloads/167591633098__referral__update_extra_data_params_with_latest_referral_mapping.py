# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2023-02-09 04:18
from __future__ import unicode_literals

from django.db import migrations
from juloserver.julo.models import ReferralSystem, RefereeMapping
from juloserver.referral.constants import LATEST_REFERRAL_MAPPING_ID


def update_extra_params_with_latest_referral_mapping(apps, _schema_editor):
    referral_system = ReferralSystem.objects.get(name='PromoReferral')
    referral_mapping = RefereeMapping.objects.last()

    referral_system.extra_params = {
        LATEST_REFERRAL_MAPPING_ID: referral_mapping.id
    }
    referral_system.save()


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(
            update_extra_params_with_latest_referral_mapping, migrations.RunPython.noop)
    ]
