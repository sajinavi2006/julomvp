# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2024-09-24 10:00
from __future__ import unicode_literals

from django.db import migrations

from juloserver.julo.constants import FeatureNameConst
from juloserver.julo.models import FeatureSetting
from juloserver.loan.constants import DDWhitelistLastDigit
from juloserver.payment_point.constants import TransactionMethodCode


def create_delay_disbursement_feature_setting(apps, schema_editor):
    cashback_amount = "25000"
    disbursement_time_threshold = "10"
    start_time = "09:00"
    cutoff_time = "23:59"

    tnc = f"""
    <p><span style="font-size:16px"><span style="font-family:Nunito">JULO berikan cashback Rp{cashback_amount} ribu jika transaksi yang kamu lakukan di JULO diproses lebih dari {disbursement_time_threshold} menit.</span></span></p>

    <p><span style="font-size:16px"><span style="font-family:Nunito">Gak perlu klaim, cashback akan otomatis dikirim ke saldo cashback-mu jika transaksi diproses lebih dari waktu yang ditentukan. Mantap, kan?</span></span></p>

    <p><span style="font-size:16px"><span style="font-family:Nunito"><strong>Syarat &amp; Ketentuan</strong></span></span></p>

    <ol>
        <li><span style="font-size:16px"><span style="font-family:Nunito">Jaminan Transaksi Instan berlaku setiap hari dari jam {start_time}-{cutoff_time} WIB.</span></span></li>
        <li><span style="font-size:16px"><span style="font-family:Nunito">Cashback Rp{cashback_amount} ribu akan diterima paling lambat 1x24 jam jika transaksimu diproses lebih dari {disbursement_time_threshold} menit.</span></span></li>
        <li><span style="font-size:16px"><span style="font-family:Nunito">Waktu tunggu transaksi {disbursement_time_threshold} menit dan nominal cashback Rp{cashback_amount} ribu dapat berubah sewaktu-waktu.</span></span></li>
        <li><span style="font-size:16px"><span style="font-family:Nunito"><strong>Jaminan Transaksi Instan</strong> berlaku untuk seluruh produk di JULO.</span></span></li>
        <li><span style="font-size:16px"><span style="font-family:Nunito"><strong>Jaminan Transaksi Instan tidak berlaku</strong> jika transaksi gagal dari sistem JULO atau dibatalkan oleh pengguna meski diproses lebih dari {disbursement_time_threshold} menit.</span></span></li>
        <li><span style="font-size:16px"><span style="font-family:Nunito">Jika ada pertanyaan lebih lanjut, silakan hubungi CS JULO melalui:</span></span>
        <ul>
            <li><span style="font-size:16px"><span style="font-family:Nunito">Email: <a href="mailto:cs@julo.co.id">cs@julo.co.id</a></span></span></li>
            <li><span style="font-size:16px"><span style="font-family:Nunito">Telepon: <strong>021 5091 9034</strong> atau <strong>021 5091 9035</strong></span></span></li>
        </ul>
        <span style="font-size:16px"><span style="font-family:Nunito">Jam operasional CS JULO 09:00-20:00 WIB</span></span></li>
    </ol>
    """

    parameters = {
        "condition": {
            "cashback": int(cashback_amount),
            "cut_off": cutoff_time,
            "daily_limit": 0,
            "list_transaction_method_code": [TransactionMethodCode.SELF.code],
            "min_loan_amount": 100000,
            "monthly_limit": 0,
            "start_time": start_time,
            "threshold_duration": 60 * int(disbursement_time_threshold),
        },
        "content": {"tnc": tnc},
        "whitelist_last_digit": DDWhitelistLastDigit.NONE.code,
    }

    FeatureSetting.objects.get_or_create(
        feature_name=FeatureNameConst.DELAY_DISBURSEMENT,
        is_active=False,
        description='Feature Setting For Delay Disbursement',
        category='delay_disbursement',
        parameters=parameters,
    )


class Migration(migrations.Migration):
    dependencies = []

    operations = [
        migrations.RunPython(create_delay_disbursement_feature_setting, migrations.RunPython.noop)
    ]
