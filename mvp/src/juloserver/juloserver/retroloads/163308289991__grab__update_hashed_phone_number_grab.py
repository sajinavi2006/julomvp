# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2021-10-01 10:08
from __future__ import unicode_literals

from django.db import migrations
from juloserver.grab.models import GrabCustomerData
from juloserver.grab.utils import GrabUtils


def update_grab_hashed_phone_numbers(apps, schema_editor):
    grab_customers = GrabCustomerData.objects.all()
    for grab_customer in grab_customers:
        phone_number = grab_customer.phone_number
        hashed_phone = GrabUtils.create_user_token(phone_number)
        grab_customer.hashed_phone_number = hashed_phone
        grab_customer.save(update_fields=['hashed_phone_number'])


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(update_grab_hashed_phone_numbers)
    ]
