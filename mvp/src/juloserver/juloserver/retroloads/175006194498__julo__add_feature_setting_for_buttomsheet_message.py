# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2025-06-16 08:19
from __future__ import unicode_literals

from django.db import migrations
from django.conf import settings

from juloserver.julo.models import FeatureSetting
from juloserver.julo.constants import FeatureNameConst
from juloserver.application_form.constants import AdditionalMessagesSubmitApp


def get_base_url_assets():

    env = settings.ENVIRONMENT.lower()
    base_url = 'https://julo-assets.oss-ap-southeast-5.aliyuncs.com'
    if env == 'staging':
        base_url = 'https://julo-assets-staging.oss-ap-southeast-5.aliyuncs.com'
    elif env == 'uat':
        base_url = 'https://julo-assets-uat.oss-ap-southeast-5.aliyuncs.com'

    return base_url


def run(apps, schema_editor):

    is_exist = FeatureSetting.objects.filter(
        feature_name=FeatureNameConst.ADDITIONAL_MESSAGE_SUBMIT_APP
    ).exists()
    if not is_exist:
        path_file = '/common/additional-banner-error-messages.png'
        FeatureSetting.objects.create(
            feature_name=FeatureNameConst.ADDITIONAL_MESSAGE_SUBMIT_APP,
            is_active=True,
            description='Configure url assets for banner',
            category='application',
            parameters={
                AdditionalMessagesSubmitApp.KEY_BANNER_URL: get_base_url_assets() + path_file
            },
        )


class Migration(migrations.Migration):

    dependencies = []

    operations = [migrations.RunPython(run, migrations.RunPython.noop)]
