# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2024-05-08 03:25
from __future__ import unicode_literals

from django.db import migrations

from juloserver.julo.models import FeatureSetting
from juloserver.minisquad.constants import FeatureNameConst


def add_new_strategy_config_for_new_bucket(apps, schema_editor):
    feature_group_mapping_config = FeatureSetting.objects.filter(
        feature_name=FeatureNameConst.AI_RUDDER_TASKS_STRATEGY_CONFIG
    ).last()
    if not feature_group_mapping_config:
        return
    params = feature_group_mapping_config.parameters
    new_params = {
        "BUCKET_RISK_UNVERIFIED": {
            "autoQA": "N",
            "acwTime": "20",
            "end_time": "20:00",
            "ringLimit": "0",
            "rest_times": [["12:00", "12:01"]],
            "slotFactor": "",
            "start_time": "08:00",
            "dialingMode": "0",
            "maxLostRate": "5",
            "qaLimitRate": "100",
            "repeatTimes": "7",
            "callInterval": "0",
            "dialingOrder": [],
            "qaLimitLength": "0",
            "autoSlotFactor": "1",
            "bulkCallInterval": "300",
            "resultStrategies": "on",
            "contactNumberInterval": "300",
            "resultStrategiesConfig": [],
        }
    }
    params.update(new_params)
    feature_group_mapping_config.parameters = params
    feature_group_mapping_config.save()

    feature_agent_group_config = FeatureSetting.objects.filter(
        feature_name=FeatureNameConst.AI_RUDDER_GROUP_NAME_CONFIG
    ).last()
    if not feature_agent_group_config:
        return

    agent_params = feature_agent_group_config.parameters
    agent_params["BUCKET_RISK_UNVERIFIED"] = "Group_Bucket Courtessy Call"
    feature_agent_group_config.parameters = params
    feature_agent_group_config.save()


class Migration(migrations.Migration):

    dependencies = []

    operations = [
        migrations.RunPython(add_new_strategy_config_for_new_bucket, migrations.RunPython.noop),
    ]
