# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2022-05-12 04:43
from __future__ import unicode_literals

from django.db import migrations

from juloserver.cfs.constants import CfsActionId, CfsActionType
from juloserver.cfs.models import CfsAction


NEW_DISPLAY_ORDER_MAP = {
    CfsActionId.REFERRAL: 1,
    CfsActionId.BCA_AUTODEBET: 2,
    CfsActionId.CONNECT_BANK: 3,
    CfsActionId.CONNECT_BPJS: 4,
    CfsActionId.UPLOAD_UTILITIES_BILL: 5,
    CfsActionId.UPLOAD_SALARY_SLIP: 6,
    CfsActionId.UPLOAD_BANK_STATEMENT: 7,
    CfsActionId.VERIFY_PHONE_NUMBER_1: 8,
    CfsActionId.VERIFY_PHONE_NUMBER_2: 9,
    CfsActionId.VERIFY_FAMILY_PHONE_NUMBER: 10,
    CfsActionId.VERIFY_OFFICE_PHONE_NUMBER: 11,
    CfsActionId.VERIFY_ADDRESS: 12,
    CfsActionId.SHARE_TO_SOCIAL_MEDIA: 13
}


def init_cfs_mission_bca_autodebit(apps, schema_editor):
    CfsAction.objects.create(
        id=14,
        action_code='bca_autodebit',
        title='Aktifkan fitur Auto Debit',
        display_order=2,
        is_active=True,
        action_type=CfsActionType.ONETIME,
        default_expiry=90,
        icon='https://julostatics.oss-ap-southeast-5.aliyuncs.com/cfs/icon_auto_debit.png',
        app_link='deeplink',
        first_occurrence_cashback_amount=0,
        repeat_occurrence_cashback_amount=0,
        is_need_agent_verify=False,
        app_version='6.0.0',
        tag_info={
            'name': 'Misi Baru',
            'is_active': True,
            'description': 'Tag info mission bca autodebit',
        }
    )


def update_display_order_mission(apps, schema_editor):
    missions = CfsAction.objects.all()
    for mission in missions:
        new_display_order = NEW_DISPLAY_ORDER_MAP[mission.id]
        mission.update_safely(display_order=new_display_order)


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(init_cfs_mission_bca_autodebit, migrations.RunPython.noop),
        migrations.RunPython(update_display_order_mission, migrations.RunPython.noop),
    ]
