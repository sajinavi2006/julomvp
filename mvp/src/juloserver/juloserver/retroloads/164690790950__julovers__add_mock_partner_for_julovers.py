# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2022-03-10 10:25
from __future__ import unicode_literals

from django.db import migrations
from juloserver.julo.models import Customer, Partner
from juloserver.julo.partners import PartnerConstant
from juloserver.partnership.constants import PartnershipTypeConstant
from juloserver.partnership.models import PartnershipType

from juloserver.partnership.services.services import process_register_partner

from django.contrib.auth.models import User

def add_mock_partner_for_julovers(x,y):
    mock_partner = Partner.objects.get_or_none(
        name=PartnerConstant.JULOVERS,
    )

    if not mock_partner:
        partnership_type, _ = PartnershipType.objects.get_or_create(
            partner_type_name=PartnershipTypeConstant.MOCK,
        )
        email = 'julovers@julofinance.com'
        partner_data = {
            'email': email,
            "username": PartnerConstant.JULOVERS,
            "partnership_type": partnership_type.id,
            "callback_url": "",
            "callback_token": "",
        }
        process_register_partner(partner_data)

        #user and customer:
        user = User.objects.get(username=PartnerConstant.JULOVERS)
        Customer.objects.create(user=user, email=email)


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(add_mock_partner_for_julovers, migrations.RunPython.noop),
    ]
