# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2024-03-18 09:52
from __future__ import unicode_literals

from django.db import migrations, models

from juloserver.julo.models import FeatureSetting, MobileFeatureSetting
from juloserver.julo.constants import FeatureNameConst


def add_opencv_feature_setting(apps, _schema_editor):
    current_setting = MobileFeatureSetting.objects.filter(feature_name='ocr_opencv_setting').last()
    if current_setting:
        FeatureSetting.objects.get_or_create(
            is_active=False,
            feature_name="new_opencv_ktp",
            parameters=current_setting.parameters
        )
    else:
        FeatureSetting.objects.get_or_create(
            is_active=False,
            feature_name="new_opencv_ktp",
            parameters={
                "blur": {
                    "threshold": 0
                },
                "dark": {
                    "lower_bin": 2, "upper_bin": 6, "lower_limit": 90,
                    "upper_limit": 5, "numer_of_bin": 7
                },
                "glare": {
                    "threshold": 250, "percentage_limit": 0.9
                },
                "timeout": 10000, "number_of_tries": 3
            }
        )


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(add_opencv_feature_setting, migrations.RunPython.noop),
    ]
