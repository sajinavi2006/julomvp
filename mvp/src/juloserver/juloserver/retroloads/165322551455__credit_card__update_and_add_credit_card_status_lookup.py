# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2022-05-22 13:18
from __future__ import unicode_literals

from django.db import migrations

from juloserver.julo.models import StatusLookup
from juloserver.credit_card.models import (
    CreditCardApplicationHistory,
    CreditCardApplication
)


def update_status_lookups_credit_card(apps, schema_editor):
    CreditCardApplicationHistory.objects.all()\
        .update(status_old=0, status_new=0)

    CreditCardApplication.objects.all().update(status=0)

    status_lookups = StatusLookup.objects.filter(
        status_code__gte=500, status_code__lte=600).all()
    status_lookups.delete()

    status_lookups = [

        # Credit Card Application Status
        (505, 'Card Out of Stock'),
        (510, 'Card Application Submitted'),
        (520, 'Card Verification Success'),
        (523, 'Resubmit Selfie'),
        (525, 'Card Application Rejected'),
        (530, 'Card on Shipping'),
        (540, 'Card Received by User'),
        (545, 'Card Validated'),
        (580, 'Card Activated'),
        (581, 'Card Blocked'),
        (582, 'Card Unblocked'),
        (583, 'Card Closed'),

    ]

    status_lookup_data = []
    for status_code, status in status_lookups:
        status_lookup_data.append(
            StatusLookup(
                status_code=status_code,
                status=status
            )
        )

    StatusLookup.objects.bulk_create(status_lookup_data, batch_size=25)


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(update_status_lookups_credit_card, migrations.RunPython.noop),
    ]
