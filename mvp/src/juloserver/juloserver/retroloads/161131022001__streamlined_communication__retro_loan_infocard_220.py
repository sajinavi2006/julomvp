# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2021-01-22 10:10
from __future__ import unicode_literals

from django.db import migrations

from juloserver.julo.statuses import LoanStatusCodes
from juloserver.streamlined_communication.constant import CommunicationPlatform, CardProperty
from juloserver.streamlined_communication.models import (
    StreamlinedCommunication, StreamlinedMessage, InfoCardProperty)


def update_stream_line_message(app, schema_editor):
    button_2_properties = {'card_type': '1',
                           'title': 'Yuk, Lakukan Transaksi Lagi!',
                           'title_color': '#ffffff',
                           'text_color': '#ffffff',
                           'card_order_number': 1}

    info_card_property,_ = InfoCardProperty.objects.get_or_create(**button_2_properties)
    data_streamlined_message = {
        'info_card_property': info_card_property,
        'message_content': 'Limit mu masih tersedia! Pinjam tunai dan bayar tagihan dengan JULO kapan pun, di mana pun.'
    }

    message,_ = StreamlinedMessage.objects.get_or_create(**data_streamlined_message)

    StreamlinedCommunication.objects.get_or_create(
        communication_platform=CommunicationPlatform.INFO_CARD,
        status_code_id=LoanStatusCodes.CURRENT,
        extra_conditions=CardProperty.LIMIT_GTE_500,
        message=message,
        is_active=True
    )


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(update_stream_line_message, migrations.RunPython.noop)
    ]

