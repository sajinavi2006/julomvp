# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2023-11-02 18:25
from __future__ import unicode_literals

from django.db import migrations

from juloserver.julo.models import FeatureSetting
from juloserver.julo.constants import FeatureNameConst


def update_sphinx_threshold(apps, schema_editor):
    feature_setting = FeatureSetting.objects.filter(feature_name=FeatureNameConst.SPHINX_THRESHOLD).last()
    if not feature_setting:
        return

    parameters = {
        "affordability_formula": 0.3,
        "high": {
            "bottom_threshold": 0.8,
            "max_limit": 3000000,
            "min_limit": 1000000,
            "max_duration": 3
        },
        "medium": {
            "bottom_threshold": 0.7,
            "max_limit": 2000000,
            "min_limit": 500000,
            "max_duration": 3
        },
        "low": {
            "bottom_threshold": 0.51,
            "max_limit": 1500000,
            "min_limit": 500000,
            "max_duration": 3
        },
        "partial_limit_dv": 1,
    }
    feature_setting.parameters = parameters
    feature_setting.save()


class Migration(migrations.Migration):
    dependencies = [
    ]

    operations = [
        migrations.RunPython(update_sphinx_threshold, migrations.RunPython.noop)
    ]
