# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2020-02-16 15:52
from __future__ import unicode_literals
from django.db import migrations, models
import django.contrib.postgres.fields
from juloserver.streamlined_communication.constant import CommunicationPlatform

from juloserver.streamlined_communication.models import StreamlinedMessage


from juloserver.streamlined_communication.models import StreamlinedCommunicationParameterList


from juloserver.streamlined_communication.models import StreamlinedCommunication


from juloserver.streamlined_communication.models import StreamlinedCommunicationFunctionList


def update_sms_messages(apps, schema_editor):
    
    
    
    

    StreamlinedCommunicationParameterList.objects.create(
        description="First name with title. eg: Ibu/Bapak {firstname} - robocall",
        parameter_name="{{name_with_title}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="values like 1,2,3 - robocall",
        parameter_name="{{cashback_multiplier}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="cashback amount- sms",
        parameter_name="{{payment_cashback_amount}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="Bpk/Ibu",
        parameter_name="{{bpk_ibu}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="Firstname",
        parameter_name="{{firstname}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="Fullname",
        parameter_name="{{fullname}}"
    )

    StreamlinedCommunicationParameterList.objects.create(
        description="due_date of payment",
        parameter_name="{{due_date}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="due_date minus 4 day - robocall",
        parameter_name="{{due_date_with_bonus}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="bank name - robocall",
        parameter_name="{{julo_bank_name}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="URL to pass to Nexmo - robocall",
        parameter_name="{{input_webhook_url}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="pagi/siang - robocall",
        parameter_name="{{greet}}"
    )
    StreamlinedCommunicationParameterList.objects.create(
        description="day before due date like 5,3 - robocall",
        parameter_name="{{days_before_due_date}}"
    )

    StreamlinedCommunicationFunctionList.objects.create(
        description="Robocall first attempt",
        function_name="send_voice_payment_reminder",
        communication_platform=CommunicationPlatform.ROBOCALL,
    )
    StreamlinedCommunicationFunctionList.objects.create(
        description="Robocall second attempt",
        function_name="retry_send_voice_payment_reminder1",
        communication_platform=CommunicationPlatform.ROBOCALL,
    )
    StreamlinedCommunicationFunctionList.objects.create(
        description="Robocall third attempt",
        function_name="retry_send_voice_payment_reminder2",
        communication_platform=CommunicationPlatform.ROBOCALL,
    )

    robocall_mtl_tminus3 = \
        StreamlinedMessage.objects.create(
            message_content='[{"action": "talk","voiceName": "Damayanti","text": "Selamat {{greet}}'
            '{{ name_with_title }}, angsuran JULO Anda {{ due_amount }} rupiah akan jatuh tempo '
            'dalam {{ days_before_due_date }} hari."},{"action": "talk","voiceName": "Damayanti",'
            '"text": "Bayar sekarang dan dapatkan kesbek sebesar {{ cashback_multiplier }} kali.'
            '{{ promo_message }}"},{"action": "talk","voiceName": "Damayanti","text":"Tekan 1'
            ' untuk konfirmasi. Terima kasih"},{"action": "input","maxDigits": 1,'
            '"eventUrl": ["{{input_webhook_url}}"]}]',
            parameter="{greet,name_with_title,due_amount,days_before_due_date,"
                      "cashback_multiplier,promo_message,input_webhook_url}"
        )
    streamlined_communication_for_robocall_mtl_tminus3 = StreamlinedCommunication.objects.get_or_create(
        message=robocall_mtl_tminus3,
        status="Robocall customer when dpd -3",
        communication_platform=CommunicationPlatform.ROBOCALL,
        template_code='voice_reminder_T-3_MTL',
        dpd=-3,
        product='nexmo_mtl', type='Payment Reminder',
        attempts=3, is_automated=True,
        call_hours="{8:0,10:0,12:0}",
        function_name="{send_voice_payment_reminder,retry_send_voice_payment_reminder1,"
                      "retry_send_voice_payment_reminder2}",
        description="this Robocall is send on  dpd=-3 for mtl"
    )

    robocall_mtl_tminus5 = \
        StreamlinedMessage.objects.create(
            message_content='[{"action": "talk","voiceName": "Damayanti","text": "Selamat {{greet}}'
            '{{ name_with_title }}, angsuran JULO Anda {{ due_amount }} rupiah akan jatuh tempo'
            'dalam {{ days_before_due_date }} hari."},{"action": "talk","voiceName": "Damayanti",'
            '"text": "Bayar sekarang dan dapatkan kesbek sebesar {{ cashback_multiplier }} kali.'
            '{{ promo_message }}"},{"action": "talk","voiceName": "Damayanti","text":"Tekan 1 '
            'untuk konfirmasi. Terima kasih"},{"action": "input","maxDigits": 1,'
            '"eventUrl": ["{{input_webhook_url}}"]}]',
            parameter="{greet,name_with_title,due_amount,days_before_due_date,"
                      "cashback_multiplier,promo_message,input_webhook_url}"
        )
    streamlined_communication_for_robocall_mtl_tminus5 = StreamlinedCommunication.objects.get_or_create(
        message=robocall_mtl_tminus5,
        status="Robocall customer when dpd -5",
        communication_platform=CommunicationPlatform.ROBOCALL,
        template_code='voice_reminder_T-5_MTL',
        dpd=-5,
        product='nexmo_mtl', type='Payment Reminder',
        attempts=3, is_automated=True,
        call_hours="{8:0,10:0,12:0}",
        function_name="{send_voice_payment_reminder,retry_send_voice_payment_reminder1,"
                      "retry_send_voice_payment_reminder2}",
        description="this Robocall is send on  dpd=-5 for mtl"
    )

    robocall_stl_tminus5 = \
        StreamlinedMessage.objects.create(
            message_content='[{"action": "talk","voiceName": "Damayanti","text":'
            '"Selamat {{greet}} {{ name_with_title }}, pelunasan JULO Anda'
            '{{ due_amount }} rupiah akan jatuh tempo dalam {{ days_before_due_date }} hari."},'
            '{"action": "talk","voiceName": "Damayanti","text": "Tekan 1 untuk konfirmasi. '
            '{{ promo_message }}"},{"action": "talk","voiceName": "Damayanti","text":"Terima kasih"},'
            '{"action": "input","maxDigits": 1,"eventUrl": ["{{input_webhook_url}}"]}]',
            parameter="{greet,name_with_title,due_amount,days_before_due_date,"
                      "promo_message,input_webhook_url}"
        )
    streamlined_communication_for_robocall_stl_tminus5 = StreamlinedCommunication.objects.get_or_create(
        message=robocall_stl_tminus5,
        status="Robocall customer when dpd -5",
        communication_platform=CommunicationPlatform.ROBOCALL,
        template_code='voice_reminder_T-5_STL',
        dpd=-5,
        product='nexmo_stl', type='Payment Reminder',
        attempts=3, is_automated=True,
        call_hours="{8:0,10:0,12:0}",
        function_name="{send_voice_payment_reminder,retry_send_voice_payment_reminder1,"
                      "retry_send_voice_payment_reminder2}",
        description="this Robocall is send on  dpd=-5 for stl"
    )
    robocall_stl_tminus3 = \
        StreamlinedMessage.objects.create(
            message_content='[{"action": "talk","voiceName": "Damayanti","text": "Selamat {{greet}}'
            '{{ name_with_title }}, pelunasan JULO Anda {{ due_amount }} rupiah akan jatuh tempo dalam '
            '{{ days_before_due_date }} hari."},{"action": "talk","voiceName": "Damayanti","text":'
            '"Mohon bayar sebelum jatuh tempo. Tekan 1 untuk konfirmasi. '
            '{{ promo_message }}"},{"action": "talk","voiceName": "Damayanti","text":"Terima kasih"},'
            '{"action": "input","maxDigits": 1,"eventUrl": ["{{input_webhook_url}}"]}]',
            parameter="{greet,name_with_title,due_amount,days_before_due_date,"
                      "promo_message,input_webhook_url}"
        )
    streamlined_communication_for_robocall_stl_tminus3 = StreamlinedCommunication.objects.get_or_create(
        message=robocall_stl_tminus3,
        status="Robocall customer when dpd -3",
        communication_platform=CommunicationPlatform.ROBOCALL,
        template_code='voice_reminder_T-3_STL',
        dpd=-3,
        product='nexmo_stl', type='Payment Reminder',
        attempts=3, is_automated=True,
        call_hours="{8:0,10:0,12:0}",
        function_name="{send_voice_payment_reminder,retry_send_voice_payment_reminder1,"
                      "retry_send_voice_payment_reminder2}",
        description="this Robocall is send on  dpd=-3 for stl"
    )


class Migration(migrations.Migration):
    dependencies = [
    ]

    operations = [
        migrations.RunPython(update_sms_messages,
                             migrations.RunPython.noop)
    ]
