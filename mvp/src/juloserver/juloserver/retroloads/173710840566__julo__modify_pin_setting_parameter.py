# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2025-01-17 10:06
from __future__ import unicode_literals

from django.db import migrations
from juloserver.julo.constants import FeatureNameConst
from juloserver.julo.models import FeatureSetting


def execute(apps, schema_editor):
    max_block_number = 3
    max_retry_count = 3
    max_wait_time_mins = 15

    setting = FeatureSetting.objects.filter(feature_name=FeatureNameConst.PIN_SETTING).last()
    if setting:
        new_parameters = setting.parameters

        if new_parameters['max_retry_count'] != max_retry_count:
            new_parameters['max_retry_count'] = max_retry_count

        if new_parameters['max_block_number'] != max_block_number:
            new_parameters['max_block_number'] = max_block_number

        if new_parameters['max_wait_time_mins'] != max_wait_time_mins:
            new_parameters['max_wait_time_mins'] = max_wait_time_mins

        new_parameters['response_message']['permanent_locked'] = (
            'Akunmu terblokir karena salah masukkan '
            'PIN {count_attempt_made}x. '
            'Untuk buka blokir, silakan hubungi CS JULO.'
        )
        new_parameters['response_message']['temporary_locked'] = (
            'Kamu salah masukkan PIN {count_attempt_made}x, ' 'silakan coba lagi dalam {eta} menit.'
        )
        new_parameters['response_message']['wrong_cred'] = (
                'Kamu salah masukkan PIN {count_attempt_made}x, '
                'kesempatanmu tersisa {count_attempt_left}x '
                'lagi sebelum terblokir {eta} menit'
        )

        setting.update_safely(
            parameters=new_parameters,
        )


class Migration(migrations.Migration):

    dependencies = []

    operations = [migrations.RunPython(execute, migrations.RunPython.noop)]
