# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2018-04-06 13:53
from __future__ import unicode_literals

from django.db import migrations, models
from juloserver.portal.object.product_profile.services import generate_product_lookup
from django.conf import settings

from juloserver.julo.models import SphpTemplate


from juloserver.julo.models import ProductLine


def load_pede_line_sphp(apps, schema_editor):
    
    


    product_lines = ProductLine.objects.filter(product_line_type__in=["PEDE1", "PEDE2"])
    template_map = {
        "PEDE1": "/juloserver/apiv2/templates/sphp_mtl.txt",
        "PEDE2": "/juloserver/apiv2/templates/sphp_stl.txt"
    }
    for line_type in product_lines:
        tempale_path = settings.BASE_DIR + template_map[line_type.product_line_type]
        source = open(tempale_path, 'r').read()
        SphpTemplate.objects.create(
            sphp_template=source,
            product_name=line_type.product_line_type
        )


class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(load_pede_line_sphp, migrations.RunPython.noop),
    ]
