# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2022-09-13 04:09
from __future__ import unicode_literals

from django.db import migrations
from juloserver.julo.models import FeatureSetting
from juloserver.julo.constants import FeatureNameConst


def add_maximum_age_on_ef_pre_approval_feature_settings(apps, schema_editor):
    pre_approval_feature_setting = FeatureSetting.objects.filter(
        feature_name=FeatureNameConst.EF_PRE_APPROVAL,
        is_active=True
    ).first()
    if pre_approval_feature_setting:
        pre_approval_feature_setting.parameters['maximum_age'] = 59
        pre_approval_feature_setting.save()
    else:
        created_data = {
            'feature_name': FeatureNameConst.EF_PRE_APPROVAL,
            'is_active': True,
            'parameters': {
                "email_content": "<a href='https:://julo-ef-pilotapp.co.id?token={{token}}'>Link</a>akan expired di tanggal {{expired_at}} dan jika expired akan dikirim dalam {{limit_token_creation}} lagi.",
                "email_salutation": "Yth {{fullname}},",
                "email_subject": "{{email}} - Pengajuan Kredit Limit JULO telah disetujui, balas YA untuk melanjutkan",
                "minimum_age": 21,
                "maximum_age": 59,
                "minimum_income": 2000000,
                "minimum_job_term": 90
            },
            'category': 'partner',
            'description': 'Employee Financing - Pre Approval'
        }
        FeatureSetting.objects.create(**created_data)
        

class Migration(migrations.Migration):

    dependencies = [
    ]

    operations = [
        migrations.RunPython(add_maximum_age_on_ef_pre_approval_feature_settings, migrations.RunPython.noop),
    ]
