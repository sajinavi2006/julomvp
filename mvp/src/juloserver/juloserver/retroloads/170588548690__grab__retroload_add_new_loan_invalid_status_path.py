# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2024-01-22 01:04
from __future__ import unicode_literals

from django.db import migrations

from juloserver.julo.constants import WorkflowConst
from juloserver.julo.statuses import LoanStatusCodes
from juloserver.julo.models import Workflow, WorkflowStatusPath


def add_new_status_path_for_follow_the_money(apps, schema_editor):
    workflow = Workflow.objects.get(name=WorkflowConst.LEGACY)
    if workflow:
        next_status = LoanStatusCodes.LOAN_INVALIDATED
        previous_statuses = [
            LoanStatusCodes.CURRENT,
            LoanStatusCodes.LOAN_1DPD,
            LoanStatusCodes.LOAN_5DPD,
            LoanStatusCodes.LOAN_30DPD,
            LoanStatusCodes.LOAN_60DPD,
            LoanStatusCodes.LOAN_90DPD,
            LoanStatusCodes.LOAN_120DPD,
            LoanStatusCodes.LOAN_150DPD,
            LoanStatusCodes.LOAN_180DPD,
            LoanStatusCodes.LOAN_4DPD,
            LoanStatusCodes.LOAN_8DPD,
            LoanStatusCodes.HALT,
        ]
        for stat in previous_statuses:
            WorkflowStatusPath.objects.get_or_create(
                status_previous=stat,
                status_next=next_status,
                type="happy",
                workflow=workflow
            )


class Migration(migrations.Migration):
    dependencies = [
    ]

    operations = [
        migrations.RunPython(add_new_status_path_for_follow_the_money)
    ]
